# Local random quantum circuits are approximate polynomial-designs

Fernando G.S.L. Brand ˜ao∗ Department of Computer Science, University College London, London, UK

Aram W. Harrow† Center for Theoretical Physics, Massachusetts Institute of Technology, Cambridge, MA, USA

Michał Horodecki‡ Institute for Theoretical Physics and Astrophysics, University of Gda ´nsk, 80-952 Gda ´nsk, Poland

We prove that local random quantum circuits acting on $n$ qubits composed of $O ( t ^ { 1 0 } n ^ { 2 } )$ many nearest neighbor two-qubit gates form an approximate unitary $t$ -design. Previously it was unknown whether random quantum circuits were a $t { \cdot }$ -design for any $t > 3$ .

The proof is based on an interplay of techniques from quantum many-body theory, representation theory, and the theory of Markov chains. In particular we employ a result of Nachtergaele for lower bounding the spectral gap of frustration-free quantum local Hamiltonians; a quasi-orthogonality property of permutation matrices; a result of Oliveira which extends to the unitary group the path-coupling method for bounding the mixing time of random walks; and a result of Bourgain and Gamburd showing that dense subgroups of the special unitary group, composed of elements with algebraic entries, are $\infty$ -copy tensorproduct expanders.

We also consider pseudo-randomness properties of local random quantum circuits of small depth and prove that circuits of depth ${ \bf \bar { \cal O } } ( t ^ { 1 0 } n )$ constitute a quantum $t { \cdot }$ -copy tensorproduct expander. The proof also rests on techniques from quantum many-body theory, in particular on the detectability lemma of Aharonov, Arad, Landau, and Vazirani.

We give applications of the results to cryptography, equilibration of closed quantum dynamics, and the generation of topological order. In particular we show the following pseudo-randomness property of generic quantum circuits: Almost every circuit $U$ of size ${ \hat { \boldsymbol { O } } } ( n ^ { k } )$ on $n$ qubits cannot be distinguished from a Haar uniform unitary by circuits of size $O ( n ^ { ( \dot { k } - 9 ) / 1 1 } )$ that are given oracle access to $U$ .

# I. INTRODUCTION

Random unitary matrices are an important resource in quantum information theory and quantum computing. Examples of the use of random unitaries, drawn from the Haar measure on the unitary group, include the encoding for almost every known protocol for sending information down a quantum channel [2], approximate encryption of quantum information [46], quantum data-hiding [46], information locking [46], and solving certain instances of the hidden subgroup problem over non-abelian groups [73]. Yet random unitary matrices are unreasonable from a computational point of view: To implement a random Haar unitary one needs an exponential number of two-qubit gates and random bits [56]. Thus it is interesting to explore constructions of pseudorandom unitaries, which can be efficiently implementable and can replace random unitaries in some respects.

An approximate unitary $t$ -design is a distribution of unitaries which mimic properties of the Haar measure for polynomials of degree up to $t$ (in the entries of the unitaries) [7, 15, 19, 25, 27– 29, 36, 40, 41, 48, 50, 67, 71, 78]. Approximate designs have a number of interesting applications in quantum information theory replacing the use of truly random unitaries (see e.g. [15, 25, 30, 39, 48, 60, 67]). It has been a conjecture in the theory of quantum pseudo-randomness that polynomial-size random quantum circuits on $n$ qubits form an approximate unitary poly $( n )$ - design [41]. Analogously, polynomial-size reversible circuits are known to form approximately $\mathrm { p o l y } ( n )$ -wise independent permutations [18] (see also [51]). However, up to now, the best result known for quantum circuits was that polynomial random quantum circuits are approximate unitary 3-designs [15], which improved on a series of papers establishing that random circuits are approximate unitary 2-designs [7, 25, 28, 41, 50, 67]. Moreover, efficient constructions of quantum $t$ -designs, using a polynomial number of quantum gates and random bits, were only known for $t = O ( n / \log ( n ) )$ [40]. In this paper we make progress in the problem of unitary $t$ -designs. We prove that local random quantum circuits acting on $n$ qubits composed of polynomially many nearest neighbour two-qubit gates form an approximate unitary $\mathrm { p o l y } ( n )$ -design, settling the conjecture in the affirmative. An important conceptual advance, which we will build on in this paper, was the realization that one can connect the problem of showing that random circuits are $t$ -unitary designs to lower bounding the spectral gap of a many-body quantum Hamiltonian [19].

In the remainder of this section, we will give the definitions and notation used in this paper. Then we will state the main result in Section II and outline a few applications in Section III. The rest of the paper is devoted to the proof, with an overview in Section IV and the details in Section V.

# A. Approximate Unitary Designs and Quantum Tensor-Product Expanders

We start with the definition of tensor-product expanders [45], which are objects similar to approximate unitary designs, but with the approximation to the Haar measure quantified differently. Let $\mu _ { \mathrm { H a a r } }$ be the Haar measure on $\mathbb { U } ( N )$ (the group of $N \times N$ unitary matrices).

Definition 1. Let $\nu$ be a distribution on $\mathbb { U } ( N )$ . Then $\nu$ is a $( N , \lambda , t )$ quantum $t$ -copy tensor-product expander (or TPE for short) if

$$
g ( \nu , t ) : = \left. \int _ { \mathbb { U } ( N ) } U ^ { \otimes t , t } \nu ( \mathrm { d } U ) - \int _ { \mathbb { U } ( N ) } U ^ { \otimes t , t } \mu _ { H a a r } ( \mathrm { d } U ) \right. _ { \infty } \le \lambda ,
$$

with $U ^ { \otimes t , t } : = U ^ { \otimes t } \otimes ( U ^ { * } ) ^ { \otimes t }$ . We say $\nu$ is $a$ $( N , \lambda , \infty )$ -TPE if it is a $( N , \lambda , t )$ -TPE for all $t$

This definition is meant to generalize the spectral characterization of expander graphs, and has the similar advantage that $| \operatorname { s u p p } ( \nu ) |$ can be constant even for constant $\lambda$ and unbounded $N , t$ (c.f. [45]). Another advantage is that the TPE condition can be naturally amplified. For a distribution $\nu ,$ let $\nu ^ { * k }$ be the $k$ -fold convolution of $\nu ,$ i.e.

$$
\nu ^ { * k } = \int \delta _ { U _ { 1 } . . . U _ { k } } \nu ( \mathrm { d } U _ { 1 } ) . . . \nu ( \mathrm { d } U _ { k } ) .
$$

Then it follows immediately from (1) and the fact that $\begin{array} { r } { \int _ { \mathbb { U } ( N ) } U ^ { \otimes t , t } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) } \end{array}$ is a projector that

$$
g ( \nu ^ { * k } , t ) = g ( \nu , t ) ^ { k } .
$$

Definition 1 can also be expressed in terms of quantum operations. Define $\mathrm { a d } _ { U } [ X ] : = U X U ^ { \dagger }$ . For a distribution $\nu$ on $\mathbb { U } ( N )$ let

$$
\Delta _ { \nu , t } ( \rho ) : = \int _ { \operatorname { U } ( N ) } \mathrm { a d } _ { U ^ { \otimes t } } [ \rho ] \nu ( \mathrm { d } U ) = \int _ { \operatorname { U } ( N ) } U ^ { \otimes t } \rho ( U ^ { \dagger } ) ^ { \otimes t } \nu ( \mathrm { d } U ) .
$$

Define, for any $p \geq 1 .$ , the superoperator norms

$$
\| T \| _ { p \to p } : = \operatorname* { s u p } _ { X \neq 0 } { \frac { \| T ( X ) \| _ { p } } { \| X \| _ { p } } } ,
$$

where $\| X \| _ { p } : = ( \operatorname { t r } | X | ^ { p } ) ^ { 1 / p }$ are the Schatten norms. An alternate definition of the TPE condition is then:

$$
g ( \nu , t ) = \| \Delta _ { \nu , t } - \Delta _ { \mu _ { \mathrm { H a a r } , t } } \| _ { 2 \to 2 } .
$$

In many applications, however, it is often more natural to work with measures such as the trace distance. For example, we would like to argue that sampling $U$ from $\nu$ and using it $t$ times results in a state that is $\epsilon$ -close to one that would be obtained by sampling $U$ from the Haar measure. This will lead us to the notion of an approximate unitary design (also called an $\epsilon$ -approximate $t$ -design when we want to emphasize the parameters)

Previous research has used several definitions of $\epsilon$ -approximate $t$ -designs, such as replacing the $\| \cdot \| _ { \infty }$ and $\lambda$ in (1) with $\| \cdot \| _ { 1 }$ and $\epsilon ,$ or replacing the $2  2$ norm in (6) with the diamond norm (defined below). See [61] for a comparison of these, and other, ways of defining approximate unitary designs.

Here we propose a stronger definition of approximate designs, which was suggested to us by Andreas Winter. First, if $\mathcal { N } _ { 1 } , \mathcal { N } _ { 2 }$ are superoperators, then we say that $\mathcal { N } _ { 1 } \preceq \mathcal { N } _ { 2 }$ iff $\mathcal { N } _ { 2 } - \mathcal { N } _ { 1 }$ is completely positive, or equivalently if

$$
( \mathcal { N } _ { 1 } \otimes \mathrm { i d } ) ( \Phi _ { N } ) \preceq ( \mathcal { N } _ { 2 } \otimes \mathrm { i d } ) ( \Phi _ { N } ) ,
$$

where $N$ is the input dimension of $\mathcal { N } _ { 1 , 2 } , \preceq$ here denotes the usual semidefinite ordering, and $\begin{array} { r } { | \Phi _ { N } \rangle = N ^ { - 1 / 2 } \sum _ { i = 1 } ^ { N ^ { - } } | i , i \rangle } \end{array}$ is the standard maximally entangled state on $N \times N$ dimensions.

Definition 2. Let $\nu$ be a distribution on $\mathbb { U } ( N )$ . Then $\nu$ is an $\epsilon$ -approximate unitary $t$ -design if

$$
( 1 - \epsilon ) \Delta _ { \mu _ { H a a r , t } } \preceq \Delta _ { \nu , t } \preceq ( 1 + \epsilon ) \Delta _ { \mu _ { H a a r , t } }
$$

or equivalently

$$
( 1 - \epsilon ) ( \Delta _ { \mu _ { H a r , t } } \otimes \mathrm { i d } ) ( \Phi _ { N } ^ { \otimes t } ) \preceq ( \Delta _ { \nu , t } \otimes \mathrm { i d } ) ( \Phi _ { N } ^ { \otimes t } ) \preceq ( 1 + \epsilon ) ( \Delta _ { \mu _ { H a r , t } } \otimes \mathrm { i d } ) ( \Phi _ { N } ^ { \otimes t } )
$$

For brevity, let $G ( \nu , t )$ denote the smallest $\epsilon$ for which (8) holds.

The advantage of Definition 2 is that for any state on $t$ systems that is acted upon by a random $U ^ { \otimes t }$ and then measured, the probability of any measurement outcome will change by only a small multiplicative factor whether $U$ is drawn from $\nu$ or the Haar measure. To relate our design definition to the distinguishability of quantum operations, we first define the diamond norm [55] of a superoperator $\tau$ as follows

$$
\| T \| _ { \diamond } : = \operatorname* { s u p } _ { d } \| T \otimes \mathrm { i d } _ { d } \| _ { 1 \to 1 } ,
$$

Lemma 3. If $\nu$ is an $\epsilon$ -approximate unitary $t$ -design, then $\| \Delta _ { \mu _ { H a a r , t } } - \Delta _ { \nu , t } \| _ { \diamond } \leq 2 \epsilon$ . Conversely, if $\| \Delta _ { \mu _ { H a a r , t } } - \Delta _ { \nu , t } \| _ { \diamond } \leq \epsilon$ then $\nu$ is an $\epsilon N ^ { 2 t }$ -approximate $t$ -design.

The proof is in Appendix A.

The reason we should expect Lemma 3 to be true is that all norms on finite-dimensional spaces are equivalent, and every definition of an approximate design is based on some norm of $\Delta _ { \nu , t } -$ $\Delta _ { \mu _ { \mathrm { H a a r } } , t }$ . In practice, the norms we are interested in always differ by factors that are polynomial in dimension, which here means $N ^ { O ( t ) }$ . See Lemma 2.2.14 of [61] for many more examples of this phenomenon.

To prove our main result about circuits being unitary designs, we will take the common path of first showing that they are TPEs and then converting this result into a statement about being designs. This conversion again loses a dimensional factor.

Lemma 4. Let $\nu$ be a distribution on $\mathbb { U } ( N )$ . Then

$$
\frac { g ( \nu , t ) } { 2 N ^ { t / 2 } } \leq G ( \nu , t ) \leq N ^ { 2 t } g ( \nu , t ) .
$$

This lemma is proved in Appendix A.

# II. MAIN RESULTS

A. Haar Uniform Gates

We consider the following two models of random quantum circuits, defined as random walks on $\mathbb { U } ( d ^ { n } )$ for an integer $d$ :

• Local random circuit: In each step of the walk an index $i$ is chosen uniformly at random from $[ n - 1 ]$ and a unitary $U _ { i , i + 1 }$ drawn from the Haar measure on $\mathbb { U } ( d ^ { 2 } )$ is applied to the two neighbouring qudits $i$ and $i + 1$ . • Parallel local random circuit: In each step either the unitary $U _ { 1 , 2 } \otimes U _ { 3 , 4 } \otimes \ldots \otimes U _ { n - 1 , n }$ or the unitary $U _ { 2 , 3 } \otimes . . . \otimes U _ { n - 2 , n - 1 }$ is applied (each with probability $1 / 2$ ), with $U _ { j , j + 1 }$ independent unitaries drawn from the Haar measure on $\mathbb { U } ( d ^ { 2 } )$ . (This assumes $n$ is even.)

We note the local random circuit model was considered previously in Refs. [48] and [15], while a related model of parallel local random circuits, using a different set of quantum gates, was considered in Ref. [30].

Denote the distribution over one step of a local random circuit by $\nu _ { \mathrm { L R } , d , n }$ and over one step of a parallel local random circuits by $\nu _ { \mathrm { P L R } , d , n }$ . The distributions over circuits of length $k$ can be written as $\left( \nu _ { \mathrm { L R } , d , n } \right) ^ { \ast k }$ or $\left( \nu _ { \mathrm { P L R } , d , n } \right) ^ { * k } .$ , respectively. The main result of this paper is the following:

# Theorem 5.

$$
\begin{array} { r l } & { g ( \nu _ { \mathrm { L R } , d , n } , t ) \leq 1 - ( 4 2 5 0 0 n \lceil \log _ { d } ( 4 t ) \rceil ^ { 2 } d ^ { 2 } t ^ { 5 } t ^ { 3 . 1 / \log ( d ) } ) ^ { - 1 } . } \\ & { g ( \nu _ { \mathrm { P L R } , d , n } , t ) \leq 1 - ( 5 5 3 0 0 0 \lceil \log _ { d } ( 4 t ) \rceil ^ { 2 } d ^ { 2 } t ^ { 5 } t ^ { 3 . 1 / \log ( d ) } ) ^ { - 1 } . } \end{array}
$$

A direct consequence of this theorem, (3) and Lemma 4 is the following corollary about forming $\epsilon$ -approximate $t$ -designs.

# Corollary 6.

1. Local random circuits of length $4 2 5 0 0 n [ \log _ { d } ( 4 t ) ] ^ { 2 } d ^ { 2 } t ^ { 5 } t ^ { 3 . 1 / \log ( d ) } ( 2 n t \log ( d ) + \log ( 1 / \epsilon ) )$ form ǫ- approximate $t$ -designs.   
2. Parallel local random circuits of length $5 2 3 0 0 0 \lceil \log _ { d } ( 4 t ) \rceil ^ { 2 } d ^ { 2 } t ^ { 5 } t ^ { 3 . 1 / \log ( d ) } ( 2 n t \log ( d ) + \log ( 1 / \epsilon ) )$ form $\epsilon$ -approximate $t$ -designs.

# B. Other Universal Sets of Gates

Consider a set of gates $G : = \{ g _ { i } \} _ { i = 1 } ^ { m }$ with each $g _ { i } \in \mathbb { U } ( d ^ { 2 } )$ . We say $G$ is universal if the group generated by it is dense in $\mathbb { U } ( d ^ { 2 } )$ , i.e. for every $\textstyle g \in \mathbb { U } ( d ^ { 2 } )$ and for every $\varepsilon > 0$ we can find a sequence $( i _ { 1 } , . . . , i _ { L } ) \in [ m ] ^ { L }$ such that $\| g - g _ { i _ { 1 } } . . . g _ { i _ { L } } \| \leq \varepsilon .$ . We say that the set $G$ contains inverses if $g ^ { - \bar { 1 } } \in G$ whenever $g \in G$ .

We can now consider random walks associated to an universal set of gates $G = \{ g _ { i } \} _ { i = 1 } ^ { m }$

• $G$ -local random circuit: In each step of the walk two indices $i , k$ are chosen uniformly at random from $[ n - 1 ]$ and $[ m ]$ , respectively, and the unitary $g _ { k }$ is applied to the two neighboring qudits $i$ and $i + 1$ .   
• $G$ -parallel local random circuit: In each step either the unitary $U _ { 1 , 2 } \otimes U _ { 3 , 4 } \otimes . . . \otimes U _ { n - 1 , n }$ or the unitary $U _ { 2 , 3 } \otimes . . . \otimes U _ { n - 2 , n - 1 }$ is applied (each with probability $1 / 2$ ), with $U _ { j , j + 1 }$ independent unitaries drawn uniformly from $G$ .

Corollary 6 only considered the case of a Haar uniform set of gates in $U ( d ^ { 2 } )$ . A natural question is whether one can prove similar results for other universal set of gates. It turns out that combining Theorem 5 with the result of Ref. [13] one can indeed do so, at least for a large class of gate sets:

Corollary 7. Fix $d \geq 2$ . Let $G = \{ g _ { i } \} _ { i = 1 } ^ { m }$ be a universal set of gates containing inverses, with each $g _ { i } \in S \mathbb { U } ( d ^ { 2 } )$ composed of algebraic entries. Then there exists $C = C ( G ) > 0$ such that

1. $G$ -local random circuits of length $C n [ \log _ { d } ( 4 t ) ] ^ { 2 } t ^ { 5 } t ^ { 3 . 1 / \log ( d ) } ( n t \log ( d ) + \log ( 1 / \epsilon ) ) .$

2. $G$ -parallel local random circuits of length $C \lceil \log _ { d } ( 4 t ) \rceil ^ { 2 } t ^ { 5 } t ^ { 3 . 1 / \log ( d ) } ( n t \log ( d ) + \log ( 1 / \epsilon ) )$ form ǫ- approximate $t$ -designs.

Corollary 7 is proved in Section VI. The main tool behind the proof is the beautiful result of Bourgain and Gamburd [13] establishing that any finite universal set of gates in $S U ( N )$ (for us $N = d ^ { 2 }$ ), containing inverses and with elements composed of algebraic entries, is an infinite tensor-product expander with nonzero gap. We note that the proof in Ref. [13] does not give any estimate of the dependency of the spectral gap on $N$ . That is the reason why Corollary 7 also does not specify the dependency of the size of the circuit on the local dimension $d$ . (And of course, this gap can be arbitrarily small, e.g. if the gates in $G$ are all very close to the identity.)

# C. Optimality of Results

It is worth asking whether these results can be improved. In Theorem 5, we suspect that the dependence on $t$ could be improved, perhaps even to obtain a gap that is independent of $t$ . In other words, we cannot rule out the possibility that random quantum circuits form a $( d ^ { n } , \lambda , \infty )$ - TPE for $\lambda < 1 - 1 / \mathrm { p o l y } ( n )$ . Indeed, taking $\nu$ to be uniform over even a constant number of Haar-random unitaries from $\mathbb { U } ( N )$ yields a $( N , \lambda , t )$ -TPE for (according to [45]) $\lambda$ constant and $t$ as large as $N ^ { 1 / 6 - o ( 1 ) }$ , and (according to [13]) $\lambda < 1$ and $t = \infty$ (but with uncontrolled $N$ -dependence, and over a measure not quite the same as Haar). On the other hand, we can easily see that the $n$ -dependence of part 1 of Theorem 5 cannot be improved, and the bound in part 2 is already independent of $n$ . Even when $t = 1 ,$ we can consider the action of a random circuit on a state whose first qudit is in a pure state and the remaining qubits are maximally mixed. Under one step of local random circuits, this state will change by only $O ( 1 / n )$ .

What about designs? Here, we can prove that neither the $t$ nor $n$ dependence can be improved by more than polynomial factors.

Proposition 8. Let $\nu$ be a distribution with support on circuits of size smaller than $r$ . Suppose that $\nu$ is an ǫ-approximate $t$ -design on n qudits with $\epsilon \leq 1 / 4$ and $t \leq d ^ { n / 2 }$ . Then

$$
r \geq \frac { n t } { 5 d ^ { 4 } \ln ( n t ) } .
$$

We believe that the restriction on $\epsilon$ could be relaxed to $\epsilon < 1 .$ , at the cost of some more algebra. However, once $t \sim d ^ { n }$ , our lower bound must stop improving, since $O ( d ^ { 2 n } )$ two-qudit gates suffice to implement any unitary [74], and in particular to achieve the Haar measure.

# D. Classical analogues

Random classical reversible circuits of size $O ( n ^ { 3 } t ^ { 2 } \log ( n ) \log ( 1 / \epsilon ) )$ are known to generate $t { \cdot }$ - designs [18] (with the caveat that 2-bit reversible gates are not universal, so the base distribution needs to be over random 3-bit gates). Other work [51, 52] implies that the number of random bits in these constructions can be reduced to a nearly-optimal $O ( n t { + } \log ( 1 / \epsilon ) )$ . Implicit in much of this work (e.g. see [49]) was an application similar to our Application I (below): namely, producing permutations that could not be easily distinguished from a uniformly random permutation.

Our techniques may be able to yield an alternate proof of [18], possibly with sharper parameters. However, doing so would run into the difficulty that Lemma 17 appears not to hold in the classical case. To explain this, we introduce some notation. Let $\Pi \vdash [ 2 t ]$ indicate that $\Pi$ is a partition of $[ 2 t ]$ , let $( x , y ) \in \Pi$ indicate that $x , y$ are in the same block of $\Pi ,$ and let $E _ { \Pi } \subset [ N ] ^ { 2 t }$ be the set $\{ ( i _ { 1 } , \dots , i _ { 2 t } ) : ( x , y ) \in \Pi \Rightarrow i _ { x } = i _ { y } \}$ . Then the invariant subspace of $\{ U ^ { \otimes t , t } : U \in S ( N ) \}$ is spanned by the states

$$
| E _ { \Pi } \rangle : = \frac { 1 } { \sqrt { | E _ { \Pi } | } } \sum _ { ( i _ { 1 } , \dots , i _ { 2 t } ) \in E _ { \Pi } } | i _ { 1 } , \dots , i _ { 2 t } \rangle \qquad \forall \Pi \vdash [ 2 t ]
$$

However, here the analogy breaks down, because (33) is known to fail for the states $\{ | E _ { \Pi } \rangle \}$ . We are grateful to Kevin Zatloukal for pointing this out to us.

# III. APPLICATIONS

Below we give four applications of Corollary 6.

Application 0: Large deviations. Matrix elements of Haar-random unitaries obey concentration bounds very similar to (indeed slightly stronger than) those of Gaussian random variables. Specifically, if $U$ is a $d \times d$ Haar-random unitary matrix, then for any unit vectors $| \alpha \rangle , | \beta \rangle$ and for $\gamma > 0$ we have (see e.g. [47])

$$
\operatorname* { P r } _ { U } \left[ | \langle \alpha | U | \beta \rangle | ^ { 2 } \ge \frac { \gamma } { d } \right] \le e ^ { - \gamma } .
$$

(If $U$ were instead a complex Gaussian matrix with the same first and second moments, then the $\leq$ in (14) would be replaced by an $=$ .)

If $U$ is instead an $\epsilon$ -approximate $t$ -design, then we can prove the following analogue of (14).

Lemma 9. If $U$ is a $d \times d$ matrix distributed according to an ǫ-approximate $t$ -design, then, for any unit vectors $| \alpha \rangle , | \beta \rangle$ and any integer $\gamma \geq 1$ , we have

$$
\operatorname* { P r } _ { U } \left[ | \langle \alpha | U | \beta \rangle | ^ { 2 } \geq \frac { \gamma } { d } \right] \leq ( 1 + \epsilon ) e ^ { - \operatorname* { m i n } ( t , \gamma ) } .
$$

Essentially it says that the exponential decay in $\gamma$ occurs up until the point when $\gamma > t ,$ at which point we can only guarantee that bad events happen with probability $\lesssim e ^ { - t }$ . Similar results were proved in [60, Thm 1.2] and [15, Lemma III.1].

Proof. Let $k = \mathrm { m i n } ( t , \gamma )$ . Since $k \ \leq \ t ,$ we can say that $U$ is distributed according to an $\epsilon \cdot$ approximate $k$ -design.

Markov’s inequality

$$
\begin{array} { r l } { \displaystyle \operatorname* { P r } _ { t } [ | ( \alpha | U | \beta ) | ^ { 2 } \geq \frac { \gamma } { d } ] = \operatorname* { P r } _ { U } [ | ( \alpha | U | \beta ) | ^ { 2 k } \geq ( \frac { \gamma } { d } ) ^ { k } ] } & { } \\ & { \qquad \leq \mathbb { E } | ( \alpha | U | \beta ) | ^ { 2 k } ( \frac { d } { \gamma } ) ^ { k } } \\ & { \qquad \leq ( 1 + \epsilon ) \frac { k ! } { d ( d + 1 ) \ldots ( d + k - 1 ) } ( \frac { d } { \gamma } ) ^ { k } } \\ & { \qquad \leq ( 1 + \epsilon ) \frac { k ! } { \gamma ^ { k } } } \\ & { \qquad \leq ( 1 + \epsilon ) ( \frac { k } { e \gamma } ) ^ { k } } \\ & { \qquad \leq ( 1 + \epsilon ) \epsilon \frac { k ! } { e \gamma ^ { k } } } \\ & { \qquad \leq ( 1 + \epsilon ) e ^ { - k } } \end{array}
$$

Stirling

Application I: Fooling small quantum circuits. A first application of Corollary 6 is related to pseudo-randomness properties of efficiently generated states and unitaries. A folklore result in quantum information theory says that the overwhelming majority of quantum states on $n$ qubits cannot be distinguished (with a non-negligible bias) from the maximally mixed state by any measurement which can be implemented by subexponential-sized quantum circuits [17, 37]. Thus, even though such states are very well distinguishable from the maximally mixed state (since they are pure), this is only the case by using unreasonable measurements from a computational point of view. A drawback of this result is that the states themselves require exponential-sized quantum circuits even to be approximated (by applying the circuit to the $| 0 \rangle ^ { \otimes n }$ state). For given an $n$ -qubit state which can be prepared by a circuit of $k$ gates, one can always distinguish it from the maximally mixed state by a measurement implementable by $k + O ( \log ( 1 / \epsilon ) )$ gates: One simply applies the conjugate unitary to the circuit which creates the state (which is also a circuit of $k$ gates) and measures $\log ( 1 / \epsilon )$ qubits to see if they are each in the $| 0 \rangle$ state or not.

An interesting question in this respect posed in [1] is the following: Can such a form of data hiding (of whether one has a particular pure state or the maximally mixed state) against boundedsized quantum circuits be realized efficiently? More concretely, can we find a state which can be created by a circuit of size $s _ { \scriptscriptstyle { i } }$ , yet is indistinguishable from the maximally mixed state by any measurement implementable by circuits of size $r _ { \downarrow }$ , for $r$ sufficiently smaller than $s ?$ Using Corollary 6 we can show that this is indeed the case. In fact, this is a generic property of states that can be created by circuits of size $s$ :

Corollary 10. Let $\left( \nu _ { L R , d , n } \right) ^ { \ast s }$ be the distribution on $\mathbb { U } ( d ^ { n } )$ induced by s steps of the local random quantum circuit model. Then for every $\delta \leq 1 / 2 0$ ,

$$
\operatorname* { P r } _ { U \sim \left( \nu _ { L R , d , n } \right) ^ { * s } } \left( \operatorname* { m a x } _ { M \in s i z e ( r ) } \left. \langle 0 ^ { n } | U ^ { \dagger } M U | 0 ^ { n } \rangle - \frac { \operatorname { t r } ( M ) } { d ^ { n } } \right. \geq \delta \right) \leq \left( \frac { r } { \delta } \right) ^ { 2 r d ^ { 4 } } \cdot 3 \left( \frac { 5 6 0 t } { d ^ { n } \delta ^ { 2 } } \right) ^ { t / 4 } ,
$$

with

$$
t = \left\lfloor \left( { \frac { s } { 1 4 0 0 n ^ { 2 } \log ( d ) } } \right) ^ { 1 / 1 1 } \right\rfloor ,
$$

and where the maximization is realized over all two-outcome POVMs $\{ M , { \mathrm { i d } } - M \}$ which can be implemented by quantum circuits of size $r$ .

In particular, for fixed d and n sufficiently large, all but a $2 ^ { - \Omega ( n ) }$ -fraction of states generated by circuits of size $\mathit { \Pi } _ { n ^ { k } }$ (for $k \geq 1 0 ,$ ) cannot be distinguished from the maximally mixed state with bias larger than $n ^ { - \Omega ( 1 ) }$ by any circuit of size $n ^ { \frac { k - 9 } { 1 1 } } \operatorname { p o l y l o g } ^ { - 1 } ( n )$ .

A direct consequence of Corollary 10 is connected to the problem of quantum circuit minimization. There we are given a quantum circuit consisting of $s$ gates and would like to determine the minimum number of gates which are needed to approximate the original circuit. We define

$$
C _ { \epsilon } ( U ) : = \operatorname* { m i n } \left\{ k \colon { \mathrm { t h e r e ~ e x i s t s ~ } } V { \mathrm { ~ w i t h ~ } } k { \mathrm { ~ g a t e s ~ s . t . ~ } } \| V - U \| _ { \infty } \leq \epsilon \right\} .
$$

Then we can give a lower bound on $C _ { \epsilon } ( U )$ for a generic circuit $U$ using Corollary 10 as follows

Corollary 11. All but a $2 ^ { - \Omega ( n ) }$ -fraction of quantum circuits $U$ of size $n ^ { k }$ (with respect to the measure $\left( \nu _ { L R , d , n } \right) ^ { \ast n ^ { k } }$ induced by $n ^ { k }$ steps of the local random circuit model) satisfy $C _ { \epsilon } ( U ) \geq n ^ { \frac { k - 9 } { 1 1 } } \mathrm { p o l y l o g } ^ { - 1 } ( n )$ with $\epsilon : = 1 - n ^ { - \Omega ( 1 ) }$ .

A final result in this direction is that given a circuit in which Haar random unitaries are used a polynomial number of times, replacing them by random circuits only incurs a small error.

Corollary 12. Let $C _ { U }$ be a quantum circuit of size r on $\leq r$ qudits that makes use of a unitary oracle $U$ on $n \leq r$ qudits. That is, each gate in $C _ { U }$ can either apply an arbitrary two-qudit gate to any pair of qudits, or can apply $U$ to its first $n$ qudits. Then

$$
\left\| \int _ { \mathbb { U } ( d ^ { n } ) } \mathrm { a d } _ { C _ { U } } \nu _ { \mathrm { L R } , d , n } ^ { * s } ( \mathrm { d } U ) - \int _ { \mathbb { U } ( d ^ { n } ) } \mathrm { a d } _ { C _ { U } } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \right\| _ { \diamond } \leq \epsilon ,
$$

for any $\epsilon > 0$ and $s \geq 4 2 5 0 0 n r ^ { 9 . 5 } \log ^ { 2 } ( r ) ( 6 n r d ^ { 2 } \log ( d ) + \log ( 1 / \epsilon ) )$ . In other words, random circuits cannot be distinguished from Haar-random unitaries by significantly shorter circuits.

These corollaries are proved in Appendix VIII.

Application II: Fast quantum equilibration. A second application of Corollary 6 is related to dynamical equilibration of subsystems of a time-evolving quantum system. Understanding how a quantum system equilibrates despite unitary global dynamics is a long-standing problem (see e.g. [33]). Recently several new insights have been achieved using ideas from quantum information theory [14, 23, 24, 32, 59, 62, 70, 80].

Here we outline two applications of our result to the problem of understanding equilibration in closed quantum dynamics. Consider the unitary time evolution of a system, initially in a fixed state, say all spins up $| \uparrow \rangle ^ { \otimes n }$ . The total state at any particular time is pure and hence does not appear to equilibrate in any sense. However a long sequence of investigations, starting with von Neumann in 1929 [66], has elucidated that the state does equilibrate if one imposes constraints on the kind of observations possible [9, 34, 59, 79]. For instance suppose that one only has access to measurements on a few of the particles. Then it turns out that the building up of entanglement in the quantum state leads to local equilibration of every small subset of particles, for almost all times [59]. The limits of equilibration in closed quantum dynamics is an interesting problem. What is the largest class of observables for which equilibration holds? Our result on unitary designs allows us advance this question significantly.

Recall the definition of the previous section of the circuit complexity of a measurement as the minimum size of any circuit of two-qubit gates that implements the measurement. Physical measurements (e.g. measurement of magnetization or heat capacity) of course have low complexity. An interpretation of Corollary 10 is that in generic quantum dynamics given by random circuits (which model the case of generic evolutions under time-dependent Hamiltonians), the system equilibrates with respect to all measurements of low complexity. We note that this strong kind of equilibration has recently shown useful in understanding properties of black holes in the context of the AdS-CFT correspondence [75].

A second application is to strengthen a connection of [62] between the time of equlibration of small subsystems of a closed quantum system and the circuit complexity of the unitary which diagonalizes the Hamiltonian of the system.

Consider a quantum Hamiltonian on $n$ qudits (a Hermitian operator on $( \mathbb { C } ^ { d } ) ^ { \otimes n } ,$ ) which can be writen as

$$
H = U D U ^ { \dagger } ,
$$

with $D = \operatorname { d i a g } ( E _ { 1 } , \dotsc , E _ { d ^ { n } } )$ a diagonal matrix in the computational basis formed by the eigenvalues of $H$ and $U$ a unitary matrix. We divide the system into two subsystems $S$ and $E ,$ where $S$ should be seen as a small subsystem and $E$ as a bath for $S$ . We consider an arbitrary initial state $\rho _ { S E } ( 0 )$ and its time-evolved version $\rho _ { S E } ( t ) = e ^ { - i H t } \rho _ { S E } ( 0 ) e ^ { i H t }$ . We are interested in the question of how quickly the subsystem state $\rho _ { S } ( t ) = \mathrm { t r } _ { E } \left( \rho _ { S E } ( t ) \right)$ reaches equilibrium (if it equilibrates in the first place). The equilibrium state is denoted by $\omega _ { S }$ and is given by the reduced state of $S$ of the time-averaged state

$$
\omega _ { S E } : = \operatorname* { l i m } _ { \tau  \infty } \frac { 1 } { \tau } \int _ { 0 } ^ { \tau } \rho _ { S E } ( t ) d t = \sum _ { k } P _ { k } ( \rho _ { S E } ( 0 ) ) P _ { k } ,
$$

with $P _ { k }$ the eigenprojectors of the Hamiltonian $H$ .

In Refs. [14, 62, 80] the square 2-norm average distance between $\rho _ { S } ( t )$ and $\omega _ { S }$ was computed for a Hamiltonian with $U$ chosen from the Haar measure in $\mathbb { U } ( d ^ { n } )$ :

Lemma 13 (Theorem 3 of [14]).

$$
\int _ { \mathbb { U } ( d ^ { n } ) } \mathrm { t r } \left( ( \rho _ { S } ( t ) - \omega _ { S } ) ^ { 2 } \right) \mu _ { H a a r } ( \mathrm { d } U ) = c \left\{ \frac { 1 } { d _ { S } } \frac { | \eta | ^ { 2 } } { d _ { E S } ^ { 2 } } + \left( \frac { | \xi | ^ { 2 } } { d _ { E S } ^ { 2 } } + \frac { x } { d _ { E S } ^ { 2 } } \right) ^ { 2 } + O \left( \frac { 1 } { d _ { E } } \right) \right\}
$$

where c is an absolute constant, $d _ { E } , d _ { S }$ are the dimensions of heat bath and the system, respectively, $d _ { E S } =$ $d _ { E } d _ { S } = d ^ { n }$ is the dimension of the total system,

$$
\xi = \sum _ { k = 1 } ^ { d ^ { n } } e ^ { i E _ { k } t } , \qquad \eta = \sum _ { k = 1 } ^ { d ^ { n } } e ^ { i 2 E _ { k } t } ,
$$

and $\begin{array} { r } { x = \sum _ { k } d _ { k } ^ { 2 } , } \end{array}$ with $d _ { k } = \dim \left( P _ { k } \right)$ being the dimension of eigenspace $P _ { k }$

It follows from Lemma 13 that for a non-degenerate Hamiltonian the time average of the R.H.S. of Eq. (22) - over times of order of the inverse of the average energy gap - will be small (see Refs. [14, 62, 80]). Thus a Hamiltonian whose basis is chosen according to the Haar measure and whose spectrum have on average large energy gaps (which is expected to be the case typically) will equilibrate rapidly.

In Ref. [62], Masanes, Roncaglia and Acin noted that the average computed in Lemma 13 only involves polynomials in the entries of $U$ of degree 4. Therefore one could consider the average over an $\epsilon$ -approximate unitary 4-design instead of the Haar measure and obtain the same result, up to an additive error of $\epsilon$ . Also in Ref. [62] an interesting connection of fast equilibration and the circuit complexity of $U$ was put forward: It was argued that, assuming that random circuits of length $O ( n ^ { 3 } )$ form an approximate unitary 4-design, then the Hamiltonians of most circuits of such size enjoy fast equilibration of small subsystems. Conversely, a simple argument shows that circuits with complexity less than linear cannot lead to quick equilibration. Therefore there appears to exist a connection between fast local equilibration and the circuit complexity of the unitary diagonalizing the Hamiltonian.

Corollary 6 allows us to strengthen this connection as follows:

Corollary 14. For every $\delta > 0$ , all but a $\delta$ -fraction of quantum circuits $U$ of size $n ^ { k }$ (with respect to the measure $\left( \nu _ { L R , d , n } \right) ^ { * n ^ { k } }$ induced by $n ^ { k }$ steps of the local random circuit model) are such that, with $H =$ $U D U ^ { \dagger }$ ,

$$
\mathrm { t r } \left( ( \rho _ { S } ( T ) - \omega _ { S } ) ^ { 2 } \right) \leq \frac { 1 } { \delta } \left( \int _ { \mathbb { U } ( d ^ { n } ) } \mathrm { t r } \left( ( \rho _ { S } ( T ) - \omega _ { S } ) ^ { 2 } \right) \mu _ { H a a r } ( \mathrm { d } U ) + 2 ^ { - \Omega ( n ) } \right) ,
$$

and

$$
C _ { \epsilon } ( U ) \geq n ^ { \frac { k - 9 } { 1 1 } } \operatorname { p o l y l o g } ^ { - 1 } ( n ) ,
$$

with $\epsilon : = 1 - n ^ { - \Omega ( 1 ) }$ .

Using Corollary 7 we can also obtain an analogous statement for any universal set of gates containing inverses with elements formed by algebraic entries.

In words, our results allows us to confirm the expectation of Ref. [62] that random circuits form an approximate unitary 4-design and also show that most such circuits indeed have large circuit complexity. The latter is useful information because one could worry that most unitaries of size $n ^ { k }$ (according to some chosen distribution on the set of circuits) would have a much shorter circuit decomposition, invalidating the connection of the time of equilibration with the circuit complexity of the diagonalizing unitary of the Hamiltonian. The fact that random circuits are not just approximate 4-designs, but even approximate $\mathrm { p o l y } ( n )$ -designs is what allows us to prove Corollary 11 and show that indeed there is no such considerably shorter decomposition in general.

Although Corollary 14 makes clearer the connection of fast subsystem equilibration and the complexity of diagonalizing the Hamitonian, it is still is not the kind of statement one would hope for. Indeed, to establish the connection in full one would like to show that for most circuits for which $C _ { \epsilon } ( U )$ is large enough (say, in the range $n ^ { k _ { 1 } } < C _ { \epsilon } ( U ) < n ^ { k _ { 2 } }$ for all sufficiently large $k _ { 1 } \ll k _ { 2 } = k _ { 2 } ( k _ { 1 } ) )$ , equilibration is fast. Here we can merely prove that most circuits $U$ of sufficiently large size are such that the corresponding Hamiltonian enjoys fast equilibration of small subsystems and $C _ { \epsilon } ( U )$ is big.

Another version of the claim that we would like to establish concerns the incompressibility of random circuits. A strong version of this conjecture would be that any $\epsilon$ -covering of the set of $t$ -gate random circuits has cardinality $\geq ( 1 / \epsilon ) ^ { \Omega ( t d ^ { 2 } ) }$ . See Proposition 8 and Lemma 27 for some much weaker claims in this direction.

One difficulty in establishing such a conjecture is that the exact Hausdorff dimension of $r$ -gate random circuits will depend on the gauge freedom determined by their overlaps. For example, an element of $S U ( 4 )$ has 15 real degrees of freedom, but three-qubit circuits of the form $U _ { 1 2 } U _ { 2 3 }$ have $1 5 + 1 5 - 3$ degrees of freedom, corresponding to the fact that the transformation $U _ { 1 2 } , U _ { 2 3 } \mapsto$ $U _ { 1 2 } V _ { 2 } , V _ { 2 } ^ { \dagger } U _ { 2 3 }$ leaves $U _ { 1 2 } U _ { 2 3 }$ unchanged for any $V _ { 2 } \in S U ( 2 )$ .

Application III: Generation of Topological Order. Topological order is a concept from condensed matter physics used to describe phases of matter that cannot be described by the Landau local order paradigm [81]. Roughly speaking topological order corresponds to patterns of long-range entanglement in ground states of many-body Hamiltonians. The intrinsic stability of topologically ordered systems against local perturbations also make them attractive candidates for constructing robust quantum memories or even topological quantum computation [54, 65].

In recent years it has emerged that it is fruitful to consider topological order as a property of quantum states, instead of quantum Hamiltonians (see e.g. [16, 21, 44]). There are two approaches to define topologically ordered states. The first is to say that a state has topological quantum order (TQO) if it cannot be approximated by any state that can be generated by applying a local circuit of small depth to a product state. Thus the state contains multiparticle entanglement that cannot be created merely by local interactions. In more detail, an $n$ -qubit state $| \psi \rangle$ defined on a lattice has $( R , \varepsilon )$ topological quantum order if for any parallel local circuit $U$ of depth $R , \| U | 0 \rangle ^ { \otimes n } - | \psi \rangle \| \geq \varepsilon$ [16, 21, 44].

The second approach is to say that a quantum state $| \psi _ { 0 } \rangle$ defined on a lattice exhibits TQO if there is another state $\left| \psi _ { 1 } \right.$ orthogonal to it such that for all local observables $O _ { \mathrm { l o c } } , \langle \psi _ { 0 } | O _ { \mathrm { l o c } } | \psi _ { 0 } \rangle \approx$ $\langle \psi _ { 1 } \vert O _ { \mathrm { l o c } } \vert \psi _ { 1 } \rangle$ and $\langle \psi _ { 1 } \vert O _ { \mathrm { l o c } } \vert \psi _ { 0 } \rangle \approx 0$ [16, 21, 44]. Thus one cannot distinguish the two states, or even any superposition of them, by local measurements. Quantitatively we say two orthogonal states $| \psi _ { 0 } \rangle , | \psi _ { 1 } \rangle$ defined on a finite dimensional lattice have $( l , \varepsilon )$ -TQO if for any observable $O _ { \mathrm { l o c } } ,$ with $\| O _ { \mathrm { l o c } } \| \le 1 ,$ supported on a set of diameter less than $l$ , we have $| \langle \psi _ { 0 } | O _ { \mathrm { l o c a l } } | \psi _ { 0 } \rangle - \langle \psi _ { 1 } | O _ { \mathrm { l o c } } | \psi _ { 1 } \rangle | \leq$ $2 \varepsilon$ and $| \langle \psi _ { 1 } | O _ { \mathrm { l o c } } | \psi _ { 0 } \rangle | ~ \leq ~ \varepsilon$ . As shown in Ref. [16, 44], if a state is $( l , \varepsilon )$ topologically ordered according to the second definition, then it is also $( l / 2 , \varepsilon )$ topologically ordered according to the first definition. We remark in passing that topologically ordered states can also be understood as code states of any quantum error correcting code with large distance, and so the terminology “topological order” does not have to refer to any topological properties of the geometry of the qubits.

In Ref. [16] it was shown that in any fixed dimension $D$ a quantum evolution on $n$ qubits, in the form of a local Hamiltonian or a parallel local circuit, cannot generate topological quantum order in time (or depth in the case of a quantum circuit) less than $O ( n ^ { 1 / D } )$ . The next corollary shows that in one dimension a generic evolution, chosen from the parallel local random circuit model, saturates this bound. Thus almost every local dynamics in 1D generates topological order at the fastest possible rate (according to the second and, hence, also first definition).

Corollary 15. There exists a universal constant $C < 1 0 ^ { 9 }$ such that for any two orthogonal $n$ -qubit states $| \psi _ { 0 } \rangle$ and $\left| \psi _ { 1 } \right.$ most random unitaries $U$ chosen from the measure $\left( \nu _ { P L R , d , n } \right) ^ { * C n } ,$ ∗Cn, induced by Cn steps of the parallel local random circuit model, map $| \psi _ { 0 } \rangle , | \psi _ { 1 } \rangle$ to states with nearly identical marginals. More precisely, with probability larger than $1 - 2 ^ { - n / 8 }$ , for every region $X = \{ l _ { 0 } , . . . , l _ { 0 } + l \}$ of size $l \leq n / 4$ :

$$
\begin{array} { r } { \left\| \operatorname { t r } _ { \setminus X } \Big ( U | \psi _ { 0 } \rangle \langle \psi _ { 0 } | U ^ { \dagger } \Big ) - \tau _ { X } \right\| _ { 1 } , \left\| \operatorname { t r } _ { \setminus X } \Big ( U | \psi _ { 1 } \rangle \langle \psi _ { 1 } | U ^ { \dagger } \Big ) - \tau _ { X } \right\| _ { 1 } \leq 2 ^ { - n / 8 } } \end{array}
$$

and

$$
\begin{array} { r } { \| \operatorname { t r } _ { \mathrm { \backslash } X } ( U | \psi _ { 0 }  \langle \psi _ { 1 } | U ^ { \dagger } ) \| _ { 1 } \leq 2 ^ { - n / 8 } , } \end{array}
$$

with $\tau _ { X }$ the maximally mixed state in $X$ and $\operatorname { t r } _ { \backslash X }$ the partial trace with respect to all sites except the ones in region $X$ . Thus the states $U | \psi _ { 0 } \rangle$ and $U | \psi _ { 1 } \rangle$ exhibit $( n / 4 , 2 ^ { - n / 8 } )$ )-TQO.

The proof is in Section IX. The proof only uses the 2-design property of random circuits, which had already been established in previous work [7, 25, 28, 41, 50, 67], but not previously for lineardepth circuits in one dimension.

Corollary 15 also shows that one dimensional parallel random circuits scramble [48, 57, 72] – making an initial localized bit of information inaccessible to an observer that only looks at sublinear sized regions – in linear time, confirming the expectation of Refs. [48, 72].

# IV. PROOF OVERVIEW OF THE MAIN RESULT

# A. Local random circuits

The proof of part 1 of Theorem 5 consists of four steps, explained below.

1. Relating to Spectral Gap: In the first step, following the work of Brown and Viola [19] and Ref. [15] (see also the earlier work [50]), we rephrase the TPE condition from Definition 1 in terms of the spectral gap of a local quantum Hamiltonian. A local Hamiltonian on n $D$ -dimensional subsystems is a Hermitian matrix $H$ , acting on $( \mathbb { C } ^ { D } ) ^ { \otimes n } ,$ , of the form $\begin{array} { r } { H = \sum _ { k } H _ { k } , } \end{array}$ where each $H _ { k }$ acts non-trivially only on a constant number of systems. The spectral gap of $H$ , denoted by $\Delta ( H ) .$ , is normally given by the absolute value of the difference of its two lowest distinct eigenvalues. In our setting the bottom $t !$ eigenvalues will be 0 and all other eigenvalues will be $> 0$ (assuming that either that $U$ is drawn from the Haar measure or a set meeting the conditions of Corollary 7) $\Delta ( H )$ will equal the $t ! + 1 ^ { \mathrm { s t } }$ eigenvalue.

Consider the following local Hamiltonian acting on $n$ subsystems, each of dimension $D : = d ^ { 2 t }$ :

$$
H _ { n , t } : = \sum _ { i = 1 } ^ { n - 1 } h _ { i , i + 1 }
$$

with local terms $h _ { i , i + 1 } : = I - P _ { i , i + 1 }$ acting on subsystems $i , i + 1$ and $P _ { i , i + 1 }$ defined as

$$
P _ { i , i + 1 } : = \int _ { \mathbb { U } ( d ^ { 2 } ) } ( U _ { i , i + 1 } ) ^ { \otimes t , t } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) .
$$

with $I$ the identity operator and $U ^ { \otimes t , t } : = U ^ { \otimes t } \otimes ( U ^ { * } ) ^ { \otimes t }$ .

In section $\textrm { V A }$ we prove:

Lemma 16.

$$
g ( \nu _ { \mathrm { L R } , n , d } , t ) = 1 - \frac { \Delta ( H _ { n , t } ) } { n } .
$$

Lemma 16 thus shows that in order to bound the rate of convergence of the random walk associated to the random quantum circuit (for its first $t$ moments), it sufficies to lower bound the spectral gap of $H _ { n , t }$ .

2. The Structure of $H _ { n , t }$ : It turns out that $H _ { n , t }$ has a few special properties which make the estimation of its spectral gap feasible.

Lemma 17. For every $n , t > 0$ the following properties of $\begin{array} { r } { H _ { n , t } = \sum _ { i } ( I - P _ { i , i + 1 } ) } \end{array}$ hold:

1. [19] the minimum eigenvalue of $H _ { n , t }$ is zero and the zero eigenspace is given by

$$
\begin{array} { r } { \mathcal { G } _ { n , t } : = s p a n \left\{ | \psi _ { \pi , d } \rangle ^ { \otimes n } : | \psi _ { \pi , d } \rangle : = ( I \otimes V _ { d } ( \pi ) ) | \Phi _ { d } \rangle , \pi \in S _ { t } \right\} , } \end{array}
$$

with |Φdt i := d−t/2 Pdt the maximally entangled state on $( \mathbb { C } ^ { d } ) ^ { \otimes t } \otimes ( \mathbb { C } ^ { d } ) ^ { \otimes t } .$ , $S _ { t }$ the symmetric group of order $t ,$ and $V _ { d } ( \pi )$ the representation of the permutation $\pi \in S _ { t }$ which acts on $( \mathbb { C } ^ { d } ) ^ { \otimes t }$ as

$$
V _ { d } ( \pi ) | l _ { 1 } \rangle \otimes . . . \otimes | l _ { t } \rangle = | l _ { \pi ^ { - 1 } ( 1 ) } \rangle \otimes . . . \otimes | l _ { \pi ^ { - 1 } ( t ) } \rangle ;
$$

2. Let $G _ { n , t }$ be the projector onto $\mathcal { G } _ { n , t }$ . If $t ^ { 2 } \leq d ^ { n } .$ , then

$$
\sum _ { \pi \in S _ { t } } | \langle \psi _ { \sigma , d } | \psi _ { \pi , d } \rangle | ^ { n } \leq 1 + \frac { t ^ { 2 } } { d ^ { n } } , \qquad \forall \sigma \in S _ { t }
$$

and

$$
\left. \sum _ { \pi \in { \cal S } _ { t } } \psi _ { \pi , d } ^ { \otimes n } - { \cal G } _ { n , t } \right. _ { \infty } \leq \frac { t ^ { 2 } } { d ^ { n } } .
$$

Here we use the convention that $\psi : = | \psi \rangle \langle \psi |$ .

In particular, the quasi-orthogonality property of the states $| \psi _ { \pi } \rangle$ given by Eqs. (33) and (34) will be necessary to derive a good lower bound on the spectral gap of $H _ { n , t }$ .

3. Lower Bounding the Spectral Gap: With the properties given by Lemma 17 we are in position to lower bound $\Delta ( H _ { n , t } )$ . To this aim we use a result of Nachtergaele [64], originally proposed to lower bound the spectral gap of frustration-free local Hamiltonians with a ground space spanned by matrix-product states [31, 69]. Using Nachtergaele’s result in combination with Lemma 17 we show in Section V C the following:

Lemma 18. For every integers $n , t$ with $n \geq \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil ,$

$$
\Delta ( H _ { n , t } ) \geq \frac { \Delta ( H _ { \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil , t } ) } { 4 \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil } .
$$

Lemmas 16 and 18 directly show that for every $t ,$ local random quantum circuits of polynomial size are a $\varepsilon$ -approximate unitary $t$ -design for every fixed $t$ . Note, however, that they do not give any information about the dependence of $t$ on the size of the circuit.

4. Bounding Convergence with Path Coupling: The last step in the proof consists in lower bounding $\Delta ( H _ { \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil , t } )$ . We achieve this by using the connection of the random circuit model problem with the spectral gap of $H _ { n , t }$ in the reverse direction: We upper bound the convergence time of the random walk on $\mathbb { U } ( d ^ { n } )$ defined by the local random circuit in order to lower bound the spectral gap of $\Delta ( H _ { \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil , t } )$ . The point is that now any bound on the convergence time is useful. Actually, in light of Lemma 18, it sufficies to prove an exponentially small bound on the convergence time in order to obtain part 1 of Theorem 5, and this is what we accomplish.

We consider the convergence of the random walk in the Wasserstein distance between two probability measures $\nu _ { 1 }$ and $\nu _ { 2 }$ on $\mathbb { U } ( r )$ . The Wasserstein distance is defined in terms of a distance measure $d ( U , V )$ as follows:

$$
W _ { d , 1 } ( \nu _ { 1 } , \nu _ { 2 } ) : = \operatorname* { s u p } \left\{ \int _ { \mathbb { U } ( r ) } f ( U ) \nu _ { 1 } ( \mathrm { d } U ) - \int _ { \mathbb { U } ( r ) } f ( U ) \nu _ { 2 } ( \mathrm { d } U ) \ : \ f : \ \operatorname { U } ( r ) \to \mathbb { R } \ \mathrm { i s } \ 1 \mathrm { - } \mathrm { L i p s } \right\} .
$$

where we say that $f$ is 1-Lipschitz with respect to metric $d$ if for every two unitaries $U , V , | f ( U ) -$ $f ( V ) | \leq d ( U , V )$ . The subscript 1 in $W _ { d , 1 }$ is for consistency with later notation when we will define $W _ { d , p }$ general $p$ . In this paper we will consider two distance measures. The Frobenius distance $d _ { \mathrm { F r o } } ( U , V )$ is $\| U - V \| _ { 2 } : = \mathrm { t r } ( ( U - V ) ^ { \dagger } ( U - V ) ) ^ { 1 / 2 }$ . The Riemannian distance $d _ { \mathrm { R i e } } ( U , V )$ is the length of a geodesic between $U$ and $V$ , where the curve is constrained to remain within the unitary group, i.e.

$$
d _ { \mathrm { R i e } } ( U , V ) = \operatorname* { m i n } \left\{ \int _ { 0 } ^ { 1 } \| \gamma ^ { \prime } ( t ) \| _ { 2 } d t : \gamma ( 0 ) = U , \gamma ( 1 ) = V , \gamma ( t ) \in \mathrm { U } ( r ) \forall t \in [ 0 , 1 ] \right\} .
$$

For brevity we write $W _ { \mathrm { F r o } } : = W _ { d _ { \mathrm { F r o } } , 1 }$ and $W _ { \mathrm { R i e } } : = W _ { d _ { \mathrm { R i e } } , 1 }$ . In section V D we prove

Lemma 19. For every integers $k , n > 0$ ,

$$
W _ { F r o } ( ( \nu _ { \mathrm { L R } , n , d } ) ^ { * ( n - 1 ) k } , \mu _ { H a a r } ) \leq \left( 1 - \frac { 1 } { e ^ { n } ( d ^ { 2 } + 1 ) ^ { n - 2 } } \right) ^ { \frac { k } { n - 1 } } \pi d ^ { n / 2 } .
$$

The proof of Lemma 19 rests on Bubley and Dyer’s path coupling method [20] for bounding the mixing time of Markov chains. In particular, we use a version of path coupling for Markov chains

on the unitary group recently obtained by Oliveira [68] 1.

Finally, it remains to show how Lemma 19 implies a lower bound on the spectral gap of $\Delta ( H _ { \lceil 2 \log ( d ) ^ { - 1 } \log ( t ) \rceil , t } )$ . This is the content of the following Lemma, proved in section ${ \mathrm { V E } } ,$

Lemma 20. For every $t , d \geq 1$ and every measure $\nu$ on $\mathbb { U } ( d ^ { n } )$ ,

$$
g ( \nu , t ) \leq 2 t W _ { F r o } ( \nu , \mu _ { H a a r } )
$$

Part 1 of Theorem 5 now follows from the previous lemmas.

Proof. (Part 1 of Theorem 5) Lemmas 16, 19 and 20, along with (3) give that for every $m , t , k ,$

$$
1 - \frac { \Delta ( H _ { m , t } ) } { m } \leq ( 2 t \pi d ^ { m / 2 } ) ^ { \frac { 1 } { k ( m - 1 ) } } \left( 1 - \frac { 1 } { e ^ { m } ( d ^ { 2 } + 1 ) ^ { m - 2 } } \right) ^ { \frac { 1 } { ( m - 1 ) ^ { 2 } } } .
$$

Taking the $k  \infty$ limit we find,

$$
\Delta ( H _ { m , t } ) \geq m ^ { - 1 } e ^ { - m } ( d ^ { 2 } + 1 ) ^ { - m } .
$$

Then by Lemma 18 and the previous equation, with $m = \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil ,$ we get that for every $n ,$

$$
\Delta ( H _ { n , t } ) \ \geq \ { \frac { t ^ { - { \frac { 2 . 5 } { \log ( d ) } } - 2 . 5 { \frac { \log ( d ^ { 2 } + 1 ) } { \log ( d ) } } } } { 1 2 5 0 0 \lceil \log _ { d } ( 4 t ) \rceil ^ { 2 } e ( d ^ { 2 } + 1 ) } }
$$

Since $2 . 5 ( 1 + \log ( 1 + d ^ { - 2 } ) ) \leq 3 . 1$ and $1 2 5 e ( 1 + d ^ { - 2 } ) \leq 4 2 5 0 0$ for $d \geq 2 _ { \ast }$ , our result now follows from Lemma 16. ⊓⊔

# B. Parallel local random circuits

To analyze parallel local random circuits and prove part 2 of Theorem 5, we use part 1 of Theorem 5 and a recent tool for analysing quantum many-body Hamiltonians: the detectability lemma of Aharonov et al [3].

Define

$$
M _ { n , t } : = { \frac { 1 } { 2 } } P _ { 1 , 2 } P _ { 3 , 4 } \cdot \cdot \cdot P _ { n - 1 , n } + { \frac { 1 } { 2 } } P _ { 2 , 3 } \cdot \cdot \cdot P _ { n - 2 , n - 1 } ,
$$

(with $P _ { i , i + 1 }$ defined in (29)) and let $\lambda _ { t ! + 1 } ( M _ { n , t } )$ denote its $t ! + 1$ ’st largest eigenvalue. (We focus on this eigenvalue since the top $t !$ eigenvalues are always 1.) In analogy with Lemma 16 it holds that

$$
\left\| \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \nu _ { \mathrm { P L R } , d , n } ( \mathrm { d } U ) - \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \mu _ { \mathrm { a l l } } ( \mathrm { d } U ) \right\| _ { \infty } = \lambda _ { t ! + 1 } ( M _ { n , t } )
$$

Let $P _ { \mathrm { o d d } } : = P _ { 1 , 2 } P _ { 3 , 4 } \cdot \cdot \cdot P _ { n - 1 , n } , P _ { \mathrm { e v e n } } : = P _ { 2 , 3 } \cdot \cdot \cdot P _ { n - 2 , n - 1 }$ and $P _ { \mathrm { a l l } }$ be the projector onto the intersection of $P _ { \mathrm { o d d } }$ and $P _ { \mathrm { e v e n } }$ . We use the notation $P _ { \mathrm { a l l } }$ because $\begin{array} { r } { P _ { \mathrm { a l l } } = \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \mu _ { \mathrm { a l l } } ( \mathrm { d } U ) . } \end{array}$ . Then

Lemma 21.

$$
\lambda _ { t 1 + 1 } ( M _ { n , t } ) \leq \frac { 1 } { 2 } + \frac { 1 } { 2 } \| P _ { o d d } P _ { e v e n } - P _ { a l l } \| _ { \infty } .
$$

Proof. We make use of the following result of [26] (Proposition 2.4): Given two projectors $Q$ and $R , \| Q + R \| \leq 1 + \| Q R \|$ . Let $P _ { \mathrm { a l l } }$ be the projector onto the intersection of $P _ { \mathrm { o d d } }$ and $P _ { \mathrm { e v e n } }$ . Applying the previous inequality with $Q = P _ { \mathrm { o d d } } - P _ { \mathrm { a l l } }$ and $R = P _ { \mathrm { e v e n } } - P _ { \mathrm { a l l } } ,$

$$
\begin{array} { r } { \| P _ { \mathrm { o d d } } + P _ { \mathrm { e v e n } } - 2 P _ { \mathrm { a l l } } \| _ { \infty } \leq 1 + \| P _ { \mathrm { o d d } } P _ { \mathrm { e v e n } } - P _ { \mathrm { a l l } } \| _ { \infty } , } \end{array}
$$

and so

$$
\lambda _ { t ! + 1 } ( M _ { n , t } ) = \| M _ { n , t } - P _ { \mathrm { a l l } } \| _ { \infty } \leq \frac { 1 } { 2 } + \frac { 1 } { 2 } \| P _ { \mathrm { o d d } } P _ { \mathrm { e v e n } } - P _ { \mathrm { a l l } } \| _ { \infty } .
$$

Now using the detectability lemma [3] we can show:

Lemma 22.

$$
\lambda _ { t \downarrow + 1 } \left( M _ { n , t } \right) \leq \frac { 1 } { 2 } + \frac { 1 } { 2 } \left( 1 + \frac { \Delta ( H _ { n , t } ) } { 2 } \right) ^ { - 1 / 3 } .
$$

Proof. Since $H _ { n , t }$ is a frustration-free Hamiltonian with projective local terms we can apply the detectability lemma, which is the following bound

$$
\| P _ { \mathrm { o d d } } P _ { \mathrm { e v e n } } - P _ { \mathrm { a l l } } \| _ { \infty } \leq \left( 1 + \frac { \Delta ( H _ { n , t } ) } { 2 } \right) ^ { - 1 / 3 } .
$$

The statement of the lemma thus follows from Lemma 21.

To evaluate the bound in (48), note that the RHS is $\begin{array} { r } { \leq 1 - \frac { 1 } { 1 2 } \Delta ( H _ { n , t } ) + O ( \Delta ( H _ { n , t } ) ^ { 2 } ) } \end{array}$ . From part 1 of Theorem 5 we know that $\Delta ( H _ { n , t } ) \geq \delta$ for some $\delta \leq 1 / 4 2 5 0 0$ . Thus the gap in the PLR model is at least $\frac { n } { 1 3 }$ times the bound in the LR model. This completes the proof of part 2 of Theorem 5.

# V. PROOF OF LEMMAS FOR THEOREM 5

We start proving Lemma 16, which is restated below for the convenience of the reader.

Lemma 16 (restatement).

$$
g ( \nu _ { \mathrm { L R } , n , d } , t ) = 1 - \frac { \Delta ( H _ { n , t } ) } { n } .
$$

Proof. The lemma follows from

$$
\begin{array}{c} g ( \nu _ { \mathrm { L R } , n , d } , t ) ~ { = } ~ \lambda _ { t ! + 1 } \left( \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \nu _ { \mathrm { L R } , n , d } ( \mathrm { d } U ) \right)  \\ { ~ { = } ~ \lambda _ { t ! + 1 } \left( \frac { 1 } { n } \sum _ { i } P _ { i , i + 1 } \right) } \\ { ~ { = } ~ \lambda _ { t ! + 1 } \left( I - \frac { H _ { n , t } } { n } \right) { = } ~ 1 - \frac { \Delta ( H _ { n , t } ) } { n } , } \end{array}
$$

with $\lambda _ { t ! + 1 } ( X )$ the $t ! + 1 ^ { \mathrm { s t } }$ largest eigenvalue of $X$ .

We now prove Lemma 17.

Lemma 17 (restatement). For every $n , t > 0$ the following properties of $\begin{array} { r } { H _ { n , t } = \sum _ { i } ( I - P _ { i , i + 1 } ) } \end{array}$ hold:

1. [19] the minimum eigenvalue of $H _ { n , t }$ is zero and the zero eigenspace is given by

$$
\begin{array} { r } { \mathcal { G } _ { n , t } : = s p a n \left\{ | \psi _ { \pi , d } \rangle ^ { \otimes n } : | \psi _ { \pi , d } \rangle : = ( I \otimes V _ { d } ( \pi ) ) | \Phi _ { d } \rangle , \pi \in S _ { t } \right\} , } \end{array}
$$

with |Φdt i := d−t/2 Pdtk= the maximally entangled state on $( \mathbb { C } ^ { d } ) ^ { \otimes t } \otimes ( \mathbb { C } ^ { d } ) ^ { \otimes t } .$ , $S _ { t }$ the symmetric group of order $t _ { * }$ , and $V _ { d } ( \pi )$ the representation of the permutation $\pi \in S _ { t }$ which acts on $( \mathbb { C } ^ { d } ) ^ { \otimes t }$ as

$$
V _ { d } ( \pi ) | l _ { 1 } \rangle \otimes . . . \otimes | l _ { t } \rangle = | l _ { \pi ^ { - 1 } ( 1 ) } \rangle \otimes . . . \otimes | l _ { \pi ^ { - 1 } ( t ) } \rangle ;
$$

2. Let $G _ { n , t }$ be the projector onto $\mathcal { G } _ { n , t }$ . If $t ^ { 2 } \leq d ^ { n } ,$ , then

$$
\sum _ { \pi \in S _ { t } } | \langle \psi _ { \sigma , d } | \psi _ { \pi , d } \rangle | ^ { n } \leq 1 + \frac { t ^ { 2 } } { d ^ { n } } , \qquad \forall \sigma \in S _ { t }
$$

and

$$
\left. \sum _ { \pi \in S _ { t } } \psi _ { \pi , d } ^ { \otimes n } - G _ { n , t } \right. _ { \infty } \leq { \frac { t ^ { 2 } } { d ^ { n } } } .
$$

Here we use the convention that $\psi : = | \psi \rangle \langle \psi |$ .

Proof. Item 1. Since each $P _ { i , i + 1 } \leq I ,$ , we have that the smallest eigenvalue of $H$ is $\geq 0$ . Let us now determine the ground space.

$$
\begin{array} { r l r } {  { H _ { n , t } | \varphi \rangle = 0 \Leftrightarrow \frac { 1 } { n } \sum _ { i = 1 } ^ { n } P _ { i , i + 1 } | \varphi \rangle = | \varphi \rangle } } \\ & { } & { \Leftrightarrow \forall i \in [ n ] , \forall U \in U ( d ^ { 2 } ) , ( I _ { d } ^ { \otimes i - 1 } \otimes U _ { i , i + 1 } \otimes I _ { d } ^ { \otimes n - i - 1 } ) ^ { \otimes t , t } | \varphi \rangle = | \varphi \rangle } \\ & { } & { \Leftrightarrow \forall U \in \mathbb { U } ( d ^ { n } ) , U ^ { \otimes t , t } | \varphi \rangle = | \varphi \rangle } \end{array}
$$

Here Eq. (58) is because nearest-neighbor unitaries generate the set of all unitaries [10]. To justify (57), observe that

$$
\mathrm { R e } \langle \varphi | \mathbb { E } _ { i \in [ n ] } P _ { i , i + 1 } | \varphi \rangle = \mathrm { R e } \mathbb { E } _ { i \sim [ n ] } \mathbb { E } _ { U _ { i , i + 1 } } \langle \varphi | U _ { i , i + 1 } ^ { t , t } | \varphi \rangle \leq 1
$$

with equality if and only if $U _ { i , i + 1 } ^ { \otimes t , t } | \varphi \rangle = | \varphi \rangle$ for all but a measure-zero subset of the $( i , U _ { i , i + 1 } )$ pairs.   
And by continuity, we can assume this subset is empty.

We can without loss of generality write $| \varphi \rangle = ( I _ { d } ^ { \otimes n t } \otimes M ) | \Phi _ { d ^ { n t } } \rangle$ for some matrix $M$ . In terms of $M _ { ☉ }$ , Eq. (58) implies that $| \varphi \rangle$ is a ground state of $H _ { n , t }$ if and only if $M$ commutes with $U ^ { \otimes t }$ for all $U \in U ( d ^ { n } )$ . It is well-known (see [35], or [22] for a quantum information perspective) that the set of such $M$ is precisely given by the span of the $V _ { d } ( \pi )$ for $\pi \in S _ { t }$ . 2

Item 2. Eq. (54) follows from

$$
\begin{array} { l } { \displaystyle \sum _ { \pi \in S _ { t } } | \langle \psi _ { \sigma , d } | \psi _ { \pi , d } \rangle | ^ { n } = \frac { 1 } { d ^ { t n } } \displaystyle \sum _ { \pi \in S _ { t } } \mathrm { t r } \left( V _ { d ^ { n } } ( \pi ) V _ { d ^ { n } } ( \sigma ) ^ { T } \right) } \\ { = \frac { 1 } { d ^ { t n } } \displaystyle \sum _ { \pi \in S _ { t } } \mathrm { t r } \left( V _ { d ^ { n } } ( \pi \sigma ^ { - 1 } ) \right) } \\ { = \frac { 1 } { d ^ { t n } } \displaystyle \sum _ { \pi \in S _ { t } } \mathrm { t r } \left( V _ { d ^ { n } } ( \pi ) \right) } \\ { = \frac { d ! } { d ^ { t n } } \displaystyle \mathrm { t r } \left( P _ { \mathrm { s y m } , t , d ^ { n } } \right) , } \end{array}
$$

with $P _ { \mathrm { s y m } , t , d ^ { n } }$ the projector onto the symmetric subspace of $\left( \mathbb { C } ^ { d ^ { n } } \right) ^ { \otimes t }$ . The first equality follows from the definition of $| \psi _ { \pi , d } \rangle$ and the relation $V _ { d ^ { n } } ( \pi ) = ( V _ { d } ( \pi ) ) ^ { \otimes n } ,$ the second and third from the fact that $S _ { t }$ is a group and $V _ { d ^ { n } } ( \pi )$ a representation of $\pi _ { \epsilon }$ , and the last from the relation

$$
P _ { \mathrm { s y m } , t , d ^ { n } } = \frac { 1 } { t ! } \sum _ { \pi \in S _ { t } } V _ { d ^ { n } } ( \pi ) .
$$

Using $\mathrm { t r } ( P _ { \mathrm { s y m } , t , d ^ { n } } ) = ( d ^ { n } + t - 1 ) . . . ( d ^ { n } + 1 ) d ^ { n } / t !$ , Eq. (59), and our assumption that $t ^ { 2 } \leq d ^ { n } ,$ , we obtain

$$
\sum _ { \pi \in S _ { t } } | \langle \psi _ { \sigma , d } | \psi _ { \pi , d } \rangle | ^ { n } = \frac { ( d ^ { n } + t - 1 ) . . . ( d ^ { n } + 1 ) d ^ { n } } { d ^ { t n } } \leq 1 + \frac { t ^ { 2 } } { d ^ { n } } .
$$

To prove Eq. (55), let $\begin{array} { r } { B : = \sum _ { \pi \in { \cal S } _ { t } } | \pi \rangle \langle \psi _ { \pi , d } | ^ { \otimes n } , } \end{array}$ , with $\{ | \pi \rangle \} _ { \pi \in S _ { t } }$ an orthornomal set of vectors. We have

$$
\left\| B B ^ { \dagger } - \sum _ { \pi \in S _ { t } } | \pi \rangle \langle \pi | \right\| _ { \infty } \leq \operatorname* { m a x } _ { \sigma } \sum _ { \pi \neq \sigma } | \langle \psi _ { \sigma , d } | \psi _ { \pi , d } \rangle | ^ { n } \leq \frac { t ^ { 2 } } { d ^ { n } } ,
$$

where we used Eq. (61) and the fact that for $M$ a Hermitian matrix, $\begin{array} { r } { \| M \| _ { \infty } \leq \operatorname* { m a x } _ { i } \sum _ { j } | M _ { i j } | } \end{array}$ . (The proof of this last claim is essentially Perron-Frobenius: observe that if $M | \varphi \rangle = \lambda | { \bar { \varphi } } \rangle$ and

$i = \arg \operatorname* { m a x } _ { i } | \langle i | \varphi \rangle |$ then $\begin{array} { r } { | \lambda | | \langle i | \varphi \rangle | = | \sum _ { j } M _ { i , j } \langle j | \varphi \rangle | \le \sum _ { j } | M _ { i , j } | \cdot | \langle i | \varphi \rangle | . } \end{array}$ ) Since $B B ^ { \dagger }$ has the same eigenvalues as $B ^ { \dagger } B$ and

$$
A _ { n , t } : = \sum _ { \pi \in S _ { t } } \left( | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | \right) ^ { \otimes n } = B ^ { \dagger } B ,
$$

we find $\begin{array} { r } { ( 1 - \frac { t ^ { 2 } } { d ^ { n } } ) G _ { n , t } \leq A _ { n , t } \leq ( 1 + \frac { t ^ { 2 } } { d ^ { n } } ) G _ { n , t } , } \end{array}$ where we used that $G _ { n , t }$ is the projector onto the support of $A _ { n , t }$ . Thus

$$
\left. A _ { n , t } - G _ { n , t } \right. _ { \infty } \leq \frac { t ^ { 2 } } { d ^ { n } } ,
$$

which is Eq. (55).

The facts used here about $P _ { \mathrm { s y m } , t , d ^ { n } }$ are proved and discussed in a quantum-information setting in [43].

# C. Proof of Lemma 18

We start defining the necessary notation to state the result of [64] which we employ. We consider a chain of systems with local finite dimensional Hilbert space $\mathcal { H }$ labeled by natural numbers (excluding 0). We consider a family of Hamiltonians

$$
H _ { [ m , n ] } = \sum _ { i = m } ^ { n - 1 } h _ { i , i + 1 }
$$

acting on ${ \mathcal { H } } ^ { \otimes ( n - m + 1 ) }$ , where $h _ { i , i + 1 }$ are the nearest neighbor interaction terms, which are assumed to be projectors. In words, $H _ { [ m , n ] }$ includes all the interactions terms for which both systems belong to the interval $[ m , n ]$ . We also let the chain be translationally invariant, i.e. $h _ { i , i + 1 }$ are the same for all $i$ . We assume further that the minimum eigenvalue of $H _ { [ m , n ] }$ is zero for all $m , n$ and denote by $\mathcal { G } _ { [ m , n ] }$ the ground space of $H _ { [ m , n ] } ,$ namely

$$
\mathcal { G } _ { [ m , n ] } = \{ | \psi \rangle \in \mathcal { H } ^ { \otimes ( n - m + 1 ) } \colon H _ { [ m , n ] } | \psi \rangle = 0 \} .
$$

Finally let $G _ { [ m , n ] }$ be the projector onto $\mathcal { G } _ { [ m , n ] }$ .

Lemma 23 (Nachtergaele, Theorem 3 of [64]). Suppose there exist positive integers $l$ and $n _ { l } ,$ and a real number $\epsilon _ { l } \leq 1 / \sqrt { l }$ such that for all $n _ { l } \leq m \leq n ,$

$$
\| I _ { A _ { 1 } } \otimes G _ { A _ { 2 } B } \left( G _ { A _ { 1 } A _ { 2 } } \otimes I _ { B } - G _ { A _ { 1 } A _ { 2 } B } \right) \| _ { \infty } \leq \epsilon _ { l }
$$

with $A _ { 1 } : = [ 1 , m - l - 1 ] , A _ { 2 } : = [ m - l , m - 1 ] , B$ $B : = m$ . Then

$$
\Delta ( H _ { [ 1 , n ] } ) \geq \Delta ( H _ { [ 1 , l ] } ) \frac { ( 1 - \epsilon _ { l } \sqrt { l } ) ^ { 2 } } { l - 1 } .
$$

We can now prove Lemma 18, restated below:

Lemma 18 (restatement). For every integers $n , t$ with $n \geq \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil ,$ ,

$$
\Delta ( H _ { n , t } ) \geq \frac { \Delta ( H _ { \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil , t } ) } { 4 \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil } .
$$

Proof. We apply Lemma 23 with $n _ { l } = 2 l$ and $\epsilon _ { l } = 1 / ( 2 \sqrt { l } )$ . Then we must show that for all $m$ in the range $2 l \leq m \leq n ,$

$$
\| I _ { A _ { 1 } } \otimes G _ { A _ { 2 } B } \left( G _ { A _ { 1 } A _ { 2 } } \otimes I _ { B } - G _ { A _ { 1 } A _ { 2 } B } \right) \| _ { \infty } \leq \frac { 1 } { 2 \sqrt { l } } ,
$$

with $A _ { 1 } = [ 1 , m - l - 1 ] , A _ { 2 } = [ m - l , m - 1 ]$ and $B = m$ . Let

$$
X _ { k } : = \sum _ { \pi \in { \cal S } _ { t } } ( | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | ) ^ { \otimes k } .
$$

By Eq. (55) of Lemma 17 we have

$$
\| G _ { [ 1 , \ldots , k ] } - X _ { k } \| _ { \infty } \leq \frac { t ^ { 2 } } { d ^ { k } } .
$$

Then

$$
\begin{array} { r c l } { { } } & { { } } & { { M : = \ \lVert I _ { A _ { 1 } } \otimes G _ { A _ { 2 } B } \left( G _ { A _ { 1 } A _ { 2 } } \otimes I _ { B } - G _ { A _ { 1 } A _ { 2 } B } \right) \rVert _ { \infty } } } \\ { { } } & { { } } & { { \leq \ \lVert I _ { A _ { 1 } } \otimes X _ { l + 1 } \left( X _ { m - 1 } \otimes I _ { B } - X _ { m } \right) \rVert _ { \infty } + \frac { 5 t ^ { 2 } } { d ^ { l } } } } \\ { { } } & { { } } & { { = \ \left. \displaystyle \sum _ { \pi \in S _ { t } } ( | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | ) ^ { \otimes ( m - l - 1 ) } \otimes Y _ { \pi } \right. _ { \infty } + \frac { 5 t ^ { 2 } } { d ^ { l } } . } } \end{array}
$$

with

$$
\begin{array} { r l r } {  { Y _ { \pi } : = \sum _ { \sigma \neq \pi } \Big ( | \psi _ { \sigma , d } \rangle \langle \psi _ { \sigma , d } | ) ^ { \otimes l } ( | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | ) ^ { \otimes l } \Big ) \otimes ( | \psi _ { \sigma , d } \rangle \langle \psi _ { \sigma , d } | ( I _ { B } - | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | ) ) } } \\ & { } & { = \sum _ { \sigma \neq \pi } ( \langle \psi _ { \sigma , d } | \psi _ { \pi , d } \rangle ) ^ { l } ( | \psi _ { \pi , d } \rangle \langle \psi _ { \sigma , d } | ) ^ { \otimes l } \otimes ( | \psi _ { \sigma , d } \rangle \langle \psi _ { \sigma , d } | ( I _ { B } - | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | ) ) . } \end{array}
$$

In the remainder of the proof we show

$$
\left\| \sum _ { \pi \in { \cal S } _ { t } } ( | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | ) ^ { \otimes ( m - l - 1 ) } \otimes { \cal Y } _ { \pi } \right\| _ { \infty } \leq \left( 1 + \frac { t ^ { 2 } } { d ^ { m - l - 1 } } \right) \operatorname* { m a x } _ { \pi } \| { \cal Y } _ { \pi } \| _ { \infty } .
$$

Then,

$$
\begin{array} { r l r } {  { M \le ( 1 + \frac { t ^ { 2 } } { d ^ { m - l - 1 } } ) \operatorname* { m a x } _ { \pi } \| Y _ { \pi } \| _ { \infty } + \frac { 5 t ^ { 2 } } { d ^ { l } } } } \\ & { } & { \le ( 1 + \frac { t ^ { 2 } } { d ^ { m - l - 1 } } ) \operatorname* { m a x } _ { \pi } \sum _ { \sigma \neq \pi } | \langle \psi _ { \sigma , d } | \psi _ { \pi , d } \rangle | ^ { 2 l } + \frac { 5 t ^ { 2 } } { d ^ { l } } } \\ & { } & { \le ( 1 + \frac { t ^ { 2 } } { d ^ { m - l - 1 } } ) \frac { t ^ { 2 } } { d ^ { 2 l } } + \frac { 5 t ^ { 2 } } { d ^ { l } } \le \frac { 6 t ^ { 2 } } { d ^ { l } } . \quad \quad } \end{array}
$$

where the before-last inequality follows from (54) of Lemma 17 (which can be applied as $t ^ { 2 } < d ^ { l }$ ).   
Then, choosing $l \geq \lceil 2 . 5 \log _ { d } ( 4 t ) \rceil$ we find $M \leq ( 2 \sqrt { l } ) ^ { - 1 }$ , and we get (69) from Lemma 23.

Let us turn to prove Eq. (75). Consider the linear map

$$
B _ { k } : = \sum _ { \pi \in S _ { t } } | \psi _ { \pi , d } \rangle ^ { \otimes k } \langle \pi | ,
$$

with $\{ | \pi \rangle \} _ { \pi \in S _ { t } }$ an orthornomal set of vectors. Using Eq. (55) of Lemma 17 we have

$$
\| B _ { k } B _ { k } ^ { \dagger } \| _ { \infty } = \left\| \sum _ { \pi \in S _ { t } } \left( | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | \right) ^ { \otimes k } \right\| _ { \infty } \leq 1 + \frac { t ^ { 2 } } { d ^ { k } }
$$

Then

$$
\begin{array} { r l } { \displaystyle \left\| \sum _ { \pi \in S _ { t } } ( | \psi _ { \pi , d } \rangle \langle \psi _ { \pi , d } | ) ^ { \otimes ( m - l - 1 ) } \otimes Y _ { \pi } \right\| _ { \infty } = } & { \displaystyle \left\| \sum _ { \pi \in S _ { t } } ( B _ { ( m - l - 1 ) } | \pi \rangle \langle \pi | B _ { ( m - l - 1 ) } ^ { \dagger } ) \otimes Y _ { \pi } \right\| _ { \infty } } \\ & { \leq \left\| B _ { ( m - l - 1 ) } B _ { ( m - l - 1 ) } ^ { \dagger } \right\| _ { \infty } \left\| \sum _ { \pi \in S _ { t } } | \pi \rangle \langle \pi | \otimes Y _ { \pi } \right\| _ { \infty } } \\ & { = \left\| B _ { ( m - l - 1 ) } B _ { ( m - l - 1 ) } ^ { \dagger } \right\| _ { \infty } \operatorname* { m a x } _ { \pi } \| Y _ { \pi } \| _ { \infty } , } \end{array}
$$

and Eq. (75) follows from the bound given by Eq. (78).

# D. Proof of Lemma 19

For two probability distributions $\nu _ { 1 } , \nu _ { 2 } ,$ we say $( X , Y )$ is a coupling for $\nu _ { 1 } , \nu _ { 2 }$ if $X$ and $Y$ are distributed according to $\nu _ { 1 }$ and $\nu _ { 2 } ,$ respectively. Define the $L ^ { p }$ Wasserstein distance between two probability distributions $\nu _ { 1 }$ and $\nu _ { 2 }$ with respect to a distance measure $d$ as follows

$$
\nu _ { 2 } ) : = \operatorname* { i n f } \left\{ \mathbb { E } [ d ( X , Y ) ^ { p } ] ^ { 1 / p } : ( X , Y ) { \mathrm { ~ i s ~ a ~ p a i r ~ o f ~ r a n d o m ~ v a r i a b l e s ~ c o u p l i n g ~ } } ( \nu _ { 1 } , \nu _ { 2 } ) \right\} .
$$

We note that

$$
W _ { \mathrm { F r o } } ( \nu _ { 1 } , \nu _ { 2 } ) \leq W _ { \mathrm { R i e } , 1 } ( \nu _ { 1 } , \nu _ { 2 } ) \leq W _ { \mathrm { R i e } , 2 } ( \nu _ { 1 } , \nu _ { 2 } ) .
$$

We now state Oliveira’s result (in fact a particular case of Theorem 3 of [68]), which offers a version of the path coupling method for Markov chains on the unitary group. It shows that a local contraction, in the $L ^ { 2 }$ Wasserstein distance, can be boosted into a global contraction.

Lemma 24 (Oliveira, Theorem 3 of [68]). Let $\nu$ be a probability measure on $\mathbb { U } ( d )$ such that

$$
\operatorname* { l i m } _ { \varepsilon \to 0 } \operatorname* { s u p } _ { X , Y \in \mathbb { U } ( d ) } \left\{ \frac { W _ { R i e , 2 } ( \nu * \delta _ { X } , \nu * \delta _ { Y } ) } { d _ { R i e } ( X , Y ) } \ : \ d _ { R i e } ( X , Y ) \leq \varepsilon \right\} \leq \eta ,
$$

with $\delta _ { U }$ a mass-point distribution at $U \in \mathbb { U } ( d )$ . Then for all probability measures $\nu _ { 1 } , \nu _ { 2 }$ on $\mathbb { U } ( d ) .$

$$
W _ { R i e , 2 } ( \nu * \nu _ { 1 } , \nu * \nu _ { 2 } ) \leq \eta W _ { R i e , 2 } ( \nu _ { 1 } , \nu _ { 2 } ) .
$$

In the rest of this section we apply Lemma 24 to prove Lemma 19. Before we turn to the proof of Lemma 19 in earnest, we prove the particular case of the random walk on three sites. Then in the sequence we will built up on it to get the general case.

Lemma 25. For every integer $k > 0$ ,

$$
W _ { R i e , 2 } ( \nu _ { L R , 3 , d } ) ^ { * 2 k } , \mu _ { H a a r } ) \leq \left( 1 - \frac { 1 } { 2 d ^ { 2 } + 2 } \right) ^ { k / 2 } \sqrt { 2 } d ^ { 3 / 2 } .
$$

Proof. We will show

$$
\operatorname { ^ { u p } } _ { X , Y \in \mathbb { U } ( d ^ { 3 } ) } \left\{ \frac { W _ { \mathrm { R i e } , 2 } ( ( \nu _ { \mathrm { L R } , 3 , d } ) ^ { * 2 } * \delta _ { X } , ( \nu _ { \mathrm { L R } , 3 , d } ) ^ { * 2 } * \delta _ { Y } ) } { d _ { \mathrm { R i e } } ( X , Y ) } \ : \ d _ { \mathrm { R i e } } ( X , Y ) \leq \tau \right\} \leq \eta : = \sqrt { 1 - \frac { \delta ^ { 2 } } { \delta ^ { 2 } } } \alpha ,
$$

Then applying Lemma 24 repeatedly we find

$$
\begin{array} { r l } { W _ { \mathrm { R i e } , 2 } ( ( \nu _ { \mathrm { L R } , 3 , d } ) ^ { * 2 k } , \mu _ { \mathrm { H a a r } } ) \ = \ } & { W _ { \mathrm { R i e } , 2 } ( ( \nu _ { \mathrm { L R } , 3 , d } ) ^ { * 2 k } * \delta _ { \mathbb { I } } , ( \nu _ { \mathrm { L R } , 3 , d } ) ^ { * 2 k } * \mu _ { \mathrm { H a a r } } ) } \\ { \ } & { \leq \ \eta ^ { k } W _ { \mathrm { R i e } , 2 } ( \delta _ { \mathbb { I } } , \mu _ { \mathrm { H a a r } } ) } \\ { \ } & { \leq \ \eta ^ { k } \pi \delta ^ { 3 / 2 } , } \end{array}
$$

where in the last inequality we used that $W _ { \mathrm { R i e } , 2 } ( \delta _ { I } , \mu _ { \mathrm { H a a r } } ) \le \operatorname* { m a x } _ { X , Y } d _ { \mathrm { R i e } } ( X , Y ) \le \pi d ^ { 3 / 2 }$ . For this last inequality we use the fact that the optimal path is of the form $X e ^ { i H t }$ for $\| H \| _ { \infty } \leq \pi$ [6] (see also Section 4.4 of [68] for a similar argument.) The statement of the lemma thus follows from Eqs. (86) and (81).

Let us turn to prove Eq. (85). Let $X$ and $Y$ be two unitaries acting on three $d$ -dimensional systems satisfying $d _ { \mathrm { R i e } } ( X , Y ) \leq \epsilon$ . Consider two steps of the walk. Then we have four possibilities, each occuring with probability $\textstyle { \frac { 1 } { 4 } }$ ,

$$
X  \{ { \tilde { U } } _ { 1 2 } U _ { 1 2 } X , { \tilde { U } } _ { 2 3 } U _ { 1 2 } X , { \tilde { U } } _ { 1 2 } U _ { 2 3 } X , { \tilde { U } } _ { 2 3 } U _ { 2 3 } X \} ,
$$

for independent Haar distributed unitaries $U _ { 1 2 } , U _ { 2 3 } , \tilde { U } _ { 1 2 } , \tilde { U } _ { 2 3 } ,$ and likewise for $Y$ . Here the indices of the unitaries label in which subsystems they act non-trivially.

At the moment we have a trivial coupling, i.e. $X$ and $Y$ are subjected to the same transformation. Now we introduce a nontrivial coupling, which we show on average brings two infinitesimally close unitaries closer to each other. We consider the transformation:

$$
X  X ^ { \prime } \in \{ \tilde { U } _ { 1 2 } U _ { 1 2 } X , \tilde { U } _ { 2 3 } V _ { 2 3 } U _ { 1 2 } X , \tilde { U } _ { 1 2 } V _ { 1 2 } U _ { 2 3 } X , \tilde { U } _ { 2 3 } U _ { 2 3 } X \}
$$

where the unitary $V _ { 2 3 }$ can depend on $U _ { 1 2 }$ and $V _ { 1 2 }$ can depend on $U _ { \mathrm { 2 3 } } ,$ and of course both can depend on $X$ and $Y$ . The unitary $Y$ , in turn, undergoes the same transformation as before, namely

$$
Y  Y ^ { \prime } \in \{ \tilde { U } _ { 1 2 } U _ { 1 2 } Y , \tilde { U } _ { 2 3 } U _ { 1 2 } Y , \tilde { U } _ { 1 2 } U _ { 2 3 } Y , \tilde { U } _ { 2 3 } U _ { 2 3 } Y \}
$$

Let us check that the transformations above indeed define a valid coupling. In order to do so the induced distribution on the two unitaries $X ^ { \prime }$ and $Y ^ { \prime }$ must be the same as in the case of a trivial coupling. This is clearly true for $Y ^ { \prime }$ . To see that it is also true for $X ^ { \prime }$ , we observe that for any fixed $V _ { 2 3 }$ $, \tilde { U } _ { 2 3 } \breve { V } _ { 2 3 }$ is Haar distributed for a Haar distributed $\tilde { U } _ { 2 3 }$ (and likewise for $\tilde { U } _ { 1 2 } V _ { 1 2 } ,$ ).

In the sequel we show

$$
\begin{array} { r } { \mathbb { E } \left( d _ { \mathrm { R i e } } ( X ^ { \prime } , Y ^ { \prime } ) ^ { 2 } \right) \leq \eta ^ { 2 } \mathbb { E } \left( d _ { \mathrm { R i e } } ( X , Y ) ^ { 2 } \right) + O ( \epsilon ^ { 3 } ) , } \end{array}
$$

where $X ^ { \prime }$ and $Y ^ { \prime }$ are random variables related by the coupling and $X$ and $Y$ satisfy $d _ { \mathrm { R i e } } ( X , Y ) \leq$ $\epsilon$ . We first estimate both sides with respect to the Frobenius distance. The LHS of (90) then corresponds to

$$
\begin{array} { r l } & { \mathbb { E } \left( \| X ^ { \prime } - Y ^ { \prime } \| _ { 2 } ^ { 2 } \right) = \frac { 1 } { 4 } \left( \mathbb { E } \left( \| \tilde { U } _ { 1 2 } U _ { 1 2 } X - \tilde { U } _ { 1 2 } U _ { 1 2 } Y \| _ { 2 } ^ { 2 } \right) + \mathbb { E } \left( \| \tilde { U } _ { 2 3 } V _ { 2 3 } U _ { 1 2 } X - \tilde { U } _ { 2 3 } U _ { 1 2 } Y \| _ { 2 } ^ { 2 } \right) } \\ & { \mathbb { E } \left( \| \tilde { U } _ { 1 2 } V _ { 1 2 } U _ { 2 3 } X - \tilde { U } _ { 1 2 } U _ { 2 3 } Y \| _ { 2 } ^ { 2 } \right) + \mathbb { E } \left( \| \tilde { U } _ { 2 3 } U _ { 2 3 } X - \tilde { U } _ { 2 3 } U _ { 2 3 } Y \| _ { 2 } ^ { 2 } \right) \right) , } \end{array}
$$

with the expectation taken over Haar distributed $\tilde { U } _ { 1 2 } , U _ { 1 2 } , \tilde { U } _ { 2 3 } , U _ { 2 3 }$ . Using the unitary invariance of the 2-norm we can rewrite this as

$$
\mathbb { E } \left( \| X ^ { \prime } - Y ^ { \prime } \| _ { 2 } ^ { 2 } \right) = \frac { 1 } { 4 } \left( 2 \| X - Y \| _ { 2 } ^ { 2 } + \mathbb { E } \left( \| V _ { 2 3 } U _ { 1 2 } X - U _ { 1 2 } Y \| _ { 2 } ^ { 2 } \right) + \mathbb { E } \left( \| V _ { 1 2 } U _ { 2 3 } X - U _ { 2 3 } Y \| _ { 2 } ^ { 2 } \right) \right)
$$

Since $V _ { 1 2 }$ and $V _ { 2 3 }$ can depend in an arbitrary way on $U _ { 2 3 }$ and $U _ { 1 2 } ,$ respectively, we can take the minimum over $V _ { 1 2 }$ and $V _ { 2 3 }$ to get

$$
\begin{array} { r } { \mathbb { E } \left( \| X ^ { \prime } - Y ^ { \prime } \| _ { 2 } ^ { 2 } \right) = \frac { 1 } { 4 } \left( 2 \| X - Y \| _ { 2 } ^ { 2 } + \mathbb { E } \left( \underset { V _ { 2 3 } } { \operatorname* { m i n } } \| V _ { 2 3 } U _ { 1 2 } X - U _ { 1 2 } Y \| _ { 2 } ^ { 2 } \right) \right. } \\ { + \left. \mathbb { E } \left( \underset { V _ { 1 2 } } { \operatorname* { m i n } } \| V _ { 1 2 } U _ { 2 3 } X - U _ { 2 3 } Y \| _ { 2 } ^ { 2 } \right) \right) . } \end{array}
$$

For any two unitaries $U _ { 1 } , U _ { 2 }$ we have

$$
\begin{array} { r } { \| U _ { 1 } - U _ { 2 } \| _ { 2 } ^ { 2 } = 2 \left( \operatorname { t r } ( \mathbb { I } ) - \operatorname { R e } \left( \operatorname { t r } ( U _ { 1 } U _ { 2 } ^ { \dagger } ) \right) \right) . } \end{array}
$$

Since $X$ and $Y$ are infinitesimally close we can write

$$
R : = X Y ^ { \dagger } = e ^ { i \epsilon H } = \mathbb { I } + i \epsilon H - \frac { \epsilon ^ { 2 } } { 2 } H ^ { 2 } + O ( \epsilon ^ { 3 } )
$$

for a Hermitian matrix $H$ with $\| H \| _ { 2 } \leq 1$ . Then applying (94) we get

$$
\| X - Y \| _ { 2 } ^ { 2 } = \epsilon ^ { 2 } \mathrm { t r } ( H ^ { 2 } ) + O ( \epsilon ^ { 3 } )
$$

Let us now consider the term $\begin{array} { r } { \mathbb { E } \left( \operatorname* { m i n } _ { V _ { 1 2 } } \| V _ { 1 2 } U _ { 2 3 } X - U _ { 2 3 } Y \| _ { 2 } ^ { 2 } \right) } \end{array}$ (for the other term the calculation gives the same result). We have

$$
\begin{array} { r l } { \mathbb { E } \left( \underset { V _ { 1 2 } } { \operatorname* { m i n } } \| V _ { 1 2 } U _ { 2 3 } X - U _ { 2 3 } Y \| _ { 2 } ^ { 2 } \right) \ = \ 2 \left( \mathrm { t r } ( \mathbb { I } ) - \mathbb { E } \left( \underset { V _ { 1 2 } } { \operatorname* { m a x } } | \mathrm { t r } ( V _ { 1 2 } U _ { 2 3 } X Y ^ { \dagger } U _ { 2 3 } ^ { \dagger } ) | \right) \right) } & { } \\ { \ } & { = \ 2 \left( \mathrm { t r } ( \mathbb { I } ) - \mathbb { E } \| \mathrm { t r } _ { 3 } ( U _ { 2 3 } R U _ { 2 3 } ^ { \dagger } ) \| _ { 1 } \right) , } \end{array}
$$

with $R = X Y ^ { \dagger }$ . The last equality follows from the following variational characterizarion of the trace norm: $\| Z \| _ { 1 } = \operatorname* { m a x } _ { U \in \mathbb { U } } | \operatorname { t r } ( U Z ) |$ [12].

From Eq. (95) we get

$$
\mathrm { t r } _ { 3 } ( U _ { 2 3 } R U _ { 2 3 } ^ { \dagger } ) = d \mathbb { I } _ { 1 2 } + i \epsilon \mathrm { t r } _ { 3 } ( U _ { 2 3 } H U _ { 2 3 } ^ { \dagger } ) - \frac { \epsilon ^ { 2 } } { 2 } \mathrm { t r } _ { 3 } ( U _ { 2 3 } H ^ { 2 } U _ { 2 3 } ^ { \dagger } ) + O ( \epsilon ^ { 3 } ) .
$$

An easy calculation shows that for any two Hermitian operators $A , B$ we have

$$
\left\| \mathbb { I } + i \epsilon A - \frac { \epsilon ^ { 2 } } { 2 } B \right\| _ { 1 } = \operatorname { t r } ( \mathbb { I } ) + \frac { \epsilon ^ { 2 } } { 2 } ( \operatorname { t r } A ^ { 2 } - \operatorname { t r } B ) + O ( \epsilon ^ { 3 } ) .
$$

Hence we obtain

$$
\left\| \mathrm { t r } _ { 3 } ( U _ { 2 3 } R U _ { 2 3 } ^ { \dagger } ) \right\| _ { 1 } = \mathrm { t r } ( \mathbb { I } ) + \frac { \epsilon ^ { 2 } } { 2 } \frac { 1 } { d } \mathrm { t r } \big ( ( \mathrm { t r } _ { 3 } ( U _ { 2 3 } H U _ { 2 3 } ^ { \dagger } ) ) ^ { 2 } \big ) - \frac { \epsilon ^ { 2 } } { 2 } \mathrm { t r } ( H ^ { 2 } ) + O ( \epsilon ^ { 3 } ) ,
$$

so that by Eq. (97),

$$
\mathbb { E } \operatorname* { i n f } _ { V _ { 1 2 } } \| V _ { 1 2 } U _ { 2 3 } X - U _ { 2 3 } Y \| _ { 2 } ^ { 2 } = \epsilon ^ { 2 } \left[ \mathrm { t r } ( H ^ { 2 } ) - \frac { 1 } { d } \mathbb { E } \left( \mathrm { t r } \big ( ( \mathrm { t r } _ { 3 } ( U U _ { 2 3 } ^ { \dagger } ) ) ^ { 2 } \big ) \right) \right] + O ( \epsilon ^ { 3 } ) .
$$

Now our goal is to compute the average $\mathbb { E } \left( \operatorname { t r } \big ( ( \operatorname { t r } _ { 3 } ( U _ { 2 3 } H U _ { 2 3 } ^ { \dagger } ) ) ^ { 2 } \big ) \right)$ . We note that for any operator $C _ { 1 2 3 }$ we have

$$
\operatorname { t r } ( C _ { 1 2 } ^ { 2 } ) = \operatorname { t r } \left( ( C _ { 1 2 3 } \otimes C _ { \overline { { { 1 2 3 } } } } ) \left( \mathbb { F } _ { 1 2 : \overline { { { 1 2 } } } } \otimes \mathbb { I } _ { 3 \overline { { { 3 } } } } \right) \right)
$$

where systems with bars are copies of original systems, and $\mathbb { F }$ is the operator which swaps systems 12 with $\overline { { 1 2 } }$ . Therefore

$$
\boldsymbol { \mathfrak { E } } \left( \operatorname { t r } \left( \operatorname { t r } _ { 3 } ( U _ { 2 3 } H U _ { 2 3 } ^ { \dagger } ) ^ { 2 } \right) \right) = \mathbb { E } \left( \operatorname { t r } \left( \left( H _ { 1 2 3 } \otimes H _ { \overline { { 1 2 3 } } } \right) ( U _ { 2 3 } ^ { \dagger } \otimes U _ { \overline { { 2 3 } } } ^ { \dagger } ) ( \mathbb { F } _ { 1 2 : \overline { { 1 2 } } } \otimes \mathbb { I } _ { 3 3 } ) ( U _ { 2 3 } \otimes U _ { \overline { { 2 3 } } } ) \right) \right)
$$

We now compute (see also Lemma IV.3 of [2])

$$
\mathbb { E } \left( ( U _ { 2 3 } ^ { \dagger } \otimes U _ { \frac { \dagger } { 2 3 } } ^ { \dagger } ) ( \mathbb { F } _ { 2 : \overline { { 2 } } } \otimes \mathbb { I } _ { 3 \overline { { 3 } } } ) ( U _ { 2 3 } \otimes U _ { \overline { { 2 3 } } } ) \right) = \frac { d } { d ^ { 2 } + 1 } ( I _ { 2 3 : \overline { { 2 3 } } } + \mathbb { F } _ { 2 3 : \overline { { 2 3 } } } )
$$

Using the fact that the tensor product of swap operators is again a swap operator (e.g. $\mathbb { F } _ { 1 2 : \overline { { 1 2 } } } =$ $\mathbb { F } _ { 1 : \overline { { 1 } } } \otimes \mathbb { F } _ { 2 : \overline { { 2 } } } )$ , we obtain

$$
\begin{array} { r l } { \mathrm { r } \big ( \mathrm { t r } _ { 3 } ( U _ { 2 3 } H U _ { 2 3 } ^ { \dagger } ) ^ { 2 } \big ) \Big ) } & { = \frac { d } { d ^ { 2 } + 1 } \left( \mathrm { t r } \big ( ( H _ { 1 2 3 } \otimes H _ { \overline { { 1 2 3 } } } ) \mathbb { F } _ { 1 2 3 : \overline { { 1 2 3 } } } \big ) + \mathrm { t r } \big ( ( H _ { 1 2 3 } \otimes H _ { \overline { { 1 2 3 } } } ) \mathbb { F } _ { 1 : \overline { { 1 } } } \otimes \mathbb { I } _ { \overline { { 1 } } } \big ) \right) } \\ & { = \frac { d } { d ^ { 2 } + 1 } \left( \mathrm { t r } ( H ^ { 2 } ) + \mathrm { t r } ( H _ { 1 } ^ { 2 } ) \right) } \\ & { \geq \frac { d } { d ^ { 2 } + 1 } \mathrm { t r } ( H ^ { 2 } ) . } \end{array}
$$

Inserting this into (101)

$$
\mathbb { E } \operatorname* { i n f } _ { V _ { 1 2 } } \left( \| V _ { 1 2 } U _ { 2 3 } X - U _ { 2 3 } Y \| _ { 2 } ^ { 2 } \right) \leq \epsilon ^ { 2 } \left( 1 - \frac { 1 } { d ^ { 2 } + 1 } \right) \operatorname { t r } ( H ^ { 2 } ) + O ( \epsilon ^ { 3 } ) .
$$

Finally, using Eq. (93),

$$
\mathbb { E } \left( \| X ^ { \prime } - Y ^ { \prime } \| _ { 2 } ^ { 2 } \right) \le \epsilon ^ { 2 } \left( \frac { 2 d ^ { 2 } + 1 } { 2 d ^ { 2 } + 2 } \right) \operatorname { t r } ( H ^ { 2 } ) + O ( \epsilon ^ { 3 } ) = \eta ^ { 2 } \mathbb { E } \left( \| X - Y \| _ { 2 } ^ { 2 } \right) + O ( \epsilon ^ { 3 } ) .
$$

This proves the desired bound in (90) except with respect to the Frobenius distance and not the Riemannian distance. However, these distances are the same to same leading order for very close points. Indeed [68] shows

$$
d _ { \mathrm { F r o } } ( U , V ) \leq d _ { \mathrm { R i e } } ( U , V ) \leq d _ { \mathrm { F r o } } ( U , V ) + c d _ { \mathrm { F r o } } ( U , V ) ^ { 2 } .
$$

For our purposes we would like $c$ to be independent of dimension. To see this, consider for simplicity $U = I$ and $V = e ^ { i \mathrm { d i a g } ( \lambda ) }$ for $\lambda = ( \lambda _ { 1 } , \ldots , \lambda _ { D } ) ,$ , $D = d ^ { 3 } .$ , and with $\mathrm { d i a g } ( \lambda )$ the matrix with $\lambda$ along the diagonal and zeros elsewhere. Then we compute (using [6])

$$
\begin{array} { l } { { d _ { \mathrm { F r o } } ( U , V ) ^ { 2 } = \displaystyle \sum _ { j } | 1 - e ^ { i \lambda _ { j } } | ^ { 2 } = 4 \displaystyle \sum _ { j } \sin ^ { 2 } ( \lambda _ { j } / 2 ) } } \\ { { d _ { \mathrm { R i e } } ( U , V ) ^ { 2 } = \displaystyle \sum _ { j } \lambda _ { j } ^ { 2 } } } \end{array}
$$

Using $\sin x \geq x - x ^ { 3 } / 6$ we have $\sin ^ { 2 } ( x ) \geq x ^ { 2 } - x ^ { 4 } / 3$ and

$$
d _ { \mathrm { F r o } } ( U , V ) ^ { 2 } = 4 \sum _ { j } \sin ^ { 2 } ( \lambda _ { j } / 2 ) \geq \sum _ { j } \lambda _ { j } ^ { 2 } - \frac { 1 } { 1 2 } \sum _ { j } \lambda _ { j } ^ { 4 } \geq d _ { \mathrm { R i e } } ( U , V ) ^ { 2 } - \frac { 1 } { 1 2 } d _ { \mathrm { R i e } } ( U , V ) ^ { 4 }
$$

This allows to convert (107) into our desired bound:

$$
\begin{array} { r l } & { \mathbb { E } \left( d _ { \mathrm { R i e } } ( X ^ { \prime } , Y ^ { \prime } ) ^ { 2 } \right) \leq \mathbb { E } \left( d _ { \mathrm { F r o } } ( X ^ { \prime } , Y ^ { \prime } ) ^ { 2 } \right) + 1 2 \epsilon ^ { 4 } } \\ & { \leq \eta ^ { 2 } \mathbb { E } \left( d _ { \mathrm { F r o } } ( X , Y ) ^ { 2 } \right) + O ( \epsilon ^ { 3 } ) } \\ & { \leq \eta ^ { 2 } \mathbb { E } \left( d _ { \mathrm { R i e } } ( X , Y ) ^ { 2 } \right) + O ( \epsilon ^ { 3 } ) } \end{array}
$$

Remark (Why one step of the walk does not work): It is instructive to see why coupling only one step of the walk does not seem to be enough to prove contraction. In this case, a general class of couplings is given by

$$
\begin{array} { r c l } { { } } & { { } } & { { X  \{ U _ { 1 2 } V _ { 1 2 } X , U _ { 2 3 } V _ { 2 3 } X \} } } \\ { { } } & { { } } & { { } } \\ { { } } & { { } } & { { Y  \{ U _ { 1 2 } Y , U _ { 2 3 } Y \} , } } \end{array}
$$

where $V _ { 1 2 }$ and $V _ { 2 3 }$ can depend only on $X$ and $Y$ . If we optimize over the choice of $V _ { 1 2 } , V _ { 2 3 }$ we get

$$
\begin{array} { l } { \displaystyle \mathbb { E } \left( \| X - Y \| _ { 2 } ^ { 2 } \right) = 2 \operatorname { t r } ( \mathbb { I } ) - \mathbb { E } \left( \| \operatorname { t r } _ { 3 } ( R ) \| _ { 1 } \right) - \mathbb { E } \left( \| \operatorname { t r } _ { 1 } ( R ) \| _ { 1 } \right) } \\ { \displaystyle = \epsilon ^ { 2 } \left( \operatorname { t r } ( H ^ { 2 } ) - \frac { 1 } { 2 d } ( \operatorname { t r } ( H _ { 1 2 } ^ { 2 } ) + \operatorname { t r } ( H _ { 2 3 } ^ { 2 } ) \right) + O ( \epsilon ^ { 3 } ) } \end{array}
$$

where $H _ { 1 2 } = \operatorname { t r } _ { 3 } ( H ) ,$ , and $H _ { 2 3 } = \mathrm { t r } _ { 1 } ( H )$ . However there exist Hermitian matrices $H$ such that $H _ { 1 2 } = H _ { 2 3 } = 0 ,$ , in which case $\begin{array} { r } { \mathbb { E } \| X - Y \| _ { 2 } ^ { 2 } = \epsilon ^ { 2 } \mathrm { t r } ( H ^ { 2 } ) + { \cal O } ( \epsilon ^ { 3 } ) = \| X _ { 0 } - Y _ { 0 } \| _ { 2 } ^ { 2 } , } \end{array}$ and so that we do not have any contraction. We can thus understand the role of the second step of the walk in constructing a useful coupling: it is to randomly change such bad cases of $H$ into good $H$ , with non-zero probability. $\boxed { \begin{array} { r l } \end{array} }$

We are now in position to prove Lemma 19:

Lemma 19 (restatement) For every integers $k , n > 0$ ,

$$
W _ { \mathrm { R i e } , 2 } ( ( \nu _ { \mathrm { L R } , n , d } ) ^ { * ( n - 1 ) k } , \mu _ { \mathrm { H a a r } } ) \leq \left( 1 - \frac { 1 } { e ^ { n } ( d ^ { 2 } + 1 ) ^ { n - 2 } } \right) ^ { \frac { k } { n - 1 } } \pi d ^ { n / 2 } .
$$

Proof. We will show that

$$
\operatorname* { s u p } _ { > 0 } ~ \operatorname* { s u p } _ { X , Y \in \mathbb { U } ( d ^ { n } ) } \left\{ \frac { W _ { \mathrm { R i e } , 2 } \left( \left( \nu _ { \mathrm { L R } , n , d } \right) ^ { * ( n - 1 ) } \ast \delta _ { X } , \left( \nu _ { \mathrm { L R } , n , d } \right) ^ { * ( n - 1 ) } \ast \delta _ { Y } \right) } { \| X - Y \| _ { 2 } } : \| X - Y \| _ { 2 } \leq \varepsilon \right\} \leq \varepsilon
$$

with

$$
\eta : = \left( 1 - \frac { 1 } { e ^ { n } ( d ^ { 2 } + 1 ) ^ { n - 2 } } \right) ^ { \frac { 1 } { n - 1 } } .
$$

Then, in analogy to the proof of Lemma 25,

$$
\begin{array} { r l } { V _ { \mathrm { R i e } , 2 } \bigl ( \bigl ( \nu _ { \mathrm { L R } , n , d } \bigr ) ^ { * ( n - 1 ) k } , \mu _ { \mathrm { H a a r } } \bigr ) } & { = \ W _ { \mathrm { R i e } , 2 } \bigl ( \bigl ( \nu _ { \mathrm { L R } , n , d } \bigr ) ^ { * ( n - 1 ) k } * \delta _ { \mathbb { I } } , \bigl ( \nu _ { \mathrm { L R } , n , d } \bigr ) ^ { * ( n - 1 ) k } * \mu _ { \mathrm { H a a r } } \bigr ) } \\ & { \leq \ \eta ^ { k } W _ { \mathrm { R i e } , 2 } ( \delta _ { \mathbb { I } } , \mu _ { \mathrm { H a a r } } ) } \\ & { \leq \ \eta ^ { k } \pi d ^ { n / 2 } , } \end{array}
$$

and the statement of the lemma follows from the bound $\begin{array} { r l } { W _ { \mathrm { R i e , 2 } } ( ( \nu _ { \mathrm { L R } , n , d } ) ^ { * ( n - 1 ) k } , \mu _ { \mathrm { H a a r } } ) } & { { } \leq } \end{array}$ $W _ { \mathrm { R i e , 2 } } ( ( \nu _ { \mathrm { L R } , n , d } ) ^ { * ( n - 1 ) k } , \mu _ { \mathrm { H a a r } } )$ .

Let us turn to prove Eq. (116). In order to avoid the problem that occured when we applied a single step of the walk to three systems, we now need to apply $k = n - 1$ steps of walk. There are then $k ^ { k }$ possible paths, and we make a nontrivial coupling only for $k !$ of them. Namely, for those paths for which no pair of systems is repeated, i.e. for the case $U _ { n - 1 n } \dots U _ { 2 3 } U _ { 1 2 }$ and all its permutations (all sequences which come from permuting the order of the unitaries in the sequence above). For those $k !$ paths we consider the following coupling

$$
\begin{array} { r l } & { X  X ^ { \prime } : = U _ { i _ { n - 1 } , i _ { n - 1 } + 1 } V _ { i _ { n - 1 } , i _ { n - 1 } + 1 } \ldots U _ { i _ { 2 } , i _ { 2 } + 1 } U _ { i _ { 1 } , i _ { 1 } + 1 } X } \\ & { Y  Y ^ { \prime } : = U _ { i _ { n - 1 } , i _ { n - 1 } + 1 } V _ { i _ { n - 1 } , i _ { n - 1 } + 1 } \ldots U _ { i _ { 2 } , i _ { 2 } + 1 } U _ { i _ { 1 } , i _ { 1 } + 1 } Y } \end{array}
$$

where $V$ can depend on all unitaries sitting to the right, and $i _ { j } \in \{ 1 , \ldots , n - 1 \}$ . We now consider explicitly a particular sequence $U _ { 1 2 } U _ { 2 3 } \ldots U _ { n - 1 n }$ and compute the analogue of (97) (for the other sequences the calculations give the same result). We have

$$
\begin{array} { r l r } {  { \operatorname* { i n f } _ { V _ { 1 2 } } \mathbb { E } ( \| U _ { 1 2 } V _ { 1 2 } U _ { 2 3 } \ldots U _ { n - 1 n } X - U _ { 1 2 } U _ { 2 3 } \ldots U _ { n - 1 n } Y \| _ { 2 } ^ { 2 } ) } } \\ & { = } & { 2 ( \operatorname { t r } ( \mathbb { I } ) - \mathbb { E } ( \| \operatorname { t r } _ { 3 \ldots n } ( U _ { 2 3 } \ldots U _ { n - 1 n } R U _ { 2 3 } ^ { \dagger } \ldots U _ { n - 1 n } ^ { \dagger } ) \| _ { 1 } ) ) . } \end{array}
$$

Expanding in $\epsilon$ we get in analogy to (101):

$$
\begin{array} { r l } & { \underset { V _ { 1 2 } } { \operatorname* { i n f } } \mathbb { E } \| U _ { 1 2 } V _ { 1 2 } U _ { 2 3 } \dots U _ { n - 1 n } X - U _ { 1 2 } U _ { 2 3 } \dots U _ { n - 1 n } Y \| _ { 2 } ^ { 2 } = } \\ & { \epsilon ^ { 2 } \left[ \mathrm { t r } ( H ^ { 2 } ) - \frac { 1 } { d ^ { n - 2 } } \mathbb { E } \mathrm { t r } \big ( ( \mathrm { t r } _ { 3 \dots n } ( U _ { 2 3 } \dots U _ { n - 1 n } H U _ { 2 3 } \dots U _ { n - 1 n } ^ { \dagger } ) ) ^ { 2 } \big ) \right] + O ( \epsilon ^ { 3 } ) . } \end{array}
$$

Moreover, using repeatedly (105) we obtain

$$
\mathbb E \left( \mathrm { t r } \big ( ( \mathrm { t r } _ { 3 \dots n } ( U _ { 2 3 } \dots U _ { n - 1 n } H U _ { 2 3 } \dots U _ { n - 1 n } ^ { \dagger } ) ) ^ { 2 } \big ) \right) \geq \left( \frac { d } { d ^ { 2 } + 1 } \right) ^ { n - 2 } \mathrm { t r } \left( H ^ { 2 } \right) ,
$$

so that

$$
\operatorname* { n f } _ { V _ { 1 2 } } \mathbb { E } \left( \| U _ { 1 2 } V _ { 1 2 } U _ { 2 3 } \ldots U _ { n - 1 n } X - U _ { 1 2 } U _ { 2 3 } \ldots U _ { n - 1 n } Y \| _ { 2 } ^ { 2 } \right) \le \epsilon ^ { 2 } \left( 1 - \frac { 1 } { ( d ^ { 2 } + 1 ) ^ { n - 2 } } \right) \operatorname { t r } ( H ^ { 2 } )
$$

Finally, we have $k ^ { k } - k !$ paths of walk for which we do not have any shrinking (as our coupling was trivial for those paths) and $k$ ! paths in which we have a shrinking factor of $\mathsf { \bar { 1 } } - ( d ^ { 2 } + 1 ) ^ { - \mathsf { \bar { ( } n - 2 ) } }$ Thus this gives

$$
\begin{array} { r } { \mathbb { E } \left( \| X ^ { \prime } - Y ^ { \prime } \| _ { 2 } ^ { 2 } \right) \leq \epsilon ^ { 2 } \chi \| X - Y \| _ { 2 } ^ { 2 } + O ( \epsilon ^ { 3 } ) } \end{array}
$$

with

$$
\chi : = 1 - \frac { ( n - 1 ) ! } { ( n - 1 ) ^ { ( n - 1 ) } } \frac { 1 } { ( d ^ { 2 } + 1 ) ^ { n - 2 } } \leq 1 - \frac { 1 } { e ^ { n } ( d ^ { 2 } + 1 ) ^ { n - 2 } } = \eta ,
$$

where we used the bound $n ! \geq n ^ { n } e ^ { - n }$ .

We now can convert this bound to one for the Riemannian distance using the same arguments used in Lemma 25. ⊓⊔

# E. Proof of Lemma 20

In this section we prove the last lemma needed in the proof of Theorem 5:

Lemma 20 (restatement). For every $t , d \geq 1$ and every measure $\nu$ on $\mathbb { U } ( d ^ { n } )$ ,

$$
g ( \nu , t ) \leq 2 t W _ { F r o } ( \nu , \mu _ { H a a r } )
$$

Proof. The definition of $g ( \cdot , \cdot )$ states that

$$
g ( \nu , t ) = \left\| \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \nu ( \mathrm { d } U ) - \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \right\| _ { \infty } .
$$

Let $X$ be such that $\| X \| _ { 1 } \leq 1$ and

$$
\begin{array} { r l } & { \mathrm { t r } \left( \left( \displaystyle \int \nu ( \mathrm { d } U ) U ^ { \otimes t , t } - \displaystyle \int \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) U ^ { \otimes t , t } \right) X \right) } \\ & { = \displaystyle \left\| \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \nu ( \mathrm { d } U ) - \displaystyle \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \right\| _ { \infty } . } \end{array}
$$

That such a $X$ always exists follows from the following variational characterization of the operator norm: $\| A \| _ { \infty } = \operatorname* { m a x } _ { X } \{ \operatorname { t r } ( A X ) ~ : ~ \| X \| _ { 1 } \leq 1 ~ \}$ [12].

Define $f ( U ) : = \mathrm { t r } ( U ^ { \otimes t , t } X )$ . We claim $f$ is $2 t$ -Lipschitz. Before proving it, let us show how it implies the statement of the lemma. Indeed, since $f / ( 2 t )$ is 1-Lipschitz,

$$
\begin{array} { r l r } { g ( \nu , t ) } & { = } & { 2 t \displaystyle \left. \int f ( U ) / ( 2 t ) \nu ( \mathrm { d } U ) - \int f ( U ) / ( 2 t ) \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \right. } \\ { } & { \leq } & { 2 t W _ { \mathrm { F r o } } ( \nu , \mu _ { \mathrm { H a a r } } ) , } \end{array}
$$

where the last inequality follows from the definition of the Wasserstein distance, given by Eq.   
(36).

It remains to show that $f ( U )$ is $2 t$ -Lipschitz. This follows from

$$
\begin{array} { r l } { | f ( U ) - f ( V ) | } & { = \vert \operatorname { t r } ( ( U ^ { \otimes t , t } - V ^ { \otimes t , t } ) X ) \vert } \\ & { \le \vert \vert X \vert \vert _ { 1 } \vert \vert U ^ { \otimes t , t } - V ^ { \otimes t , t } \vert \vert _ { \infty } } \\ & { \le \vert \vert U ^ { \otimes t , t } - V ^ { \otimes t , t } \vert \vert _ { \infty } } \\ & { \le 2 t \vert \vert U - V \vert \vert _ { \infty } } \\ & { \le 2 t \vert \vert U - V \vert \vert _ { 2 } } \end{array}
$$

The first inequality follows from the relation $\operatorname { t r } ( A ^ { \dagger } B ) \ \leq \ \| A \| _ { 1 } \| B \| _ { \infty }$ and the second from the bound $\| X \| _ { 1 } \leq 1 ,$ and the third from the hybrid argument; that is, by repeatedly applying the inequality

$$
\begin{array} { r } { \| A \otimes B - C \otimes D \| _ { \infty } \leq \| A - C \| _ { \infty } + \| B - D \| _ { \infty } , } \end{array}
$$

valid for unitaries $A , B , C$ and $D$ . This, in turn, follows from

$$
\begin{array} { r l } { \| A \otimes B - C \otimes D \| _ { \infty } \ = \ \| A \otimes ( B - D ) + ( A - C ) \otimes D \| _ { \infty } } & { } \\ & { \leq \ \| A \otimes ( B - D ) \| _ { \infty } + \| ( A - C ) \otimes D \| _ { \infty } } \\ & { \leq \ \| A \| _ { \infty } \| B - D \| _ { \infty } + \| D \| _ { \infty } \| A - C \| _ { \infty } } \\ & { \leq \ \| B - D \| _ { \infty } + \| A - C \| _ { \infty } . } \end{array}
$$

# VI. PROOF OF COROLLARY 7

We now show how we can get convergence rates for other universal set of gates from our analysis of the Haar random case:

Corollary 7 (restatement). Fix $d \geq 2$ . Let $G = \{ g _ { i } \} _ { i = 1 } ^ { m }$ be a universal set of gates containing inverses, with each $\textstyle g _ { i } \in S \mathbb { U } ( d ^ { 2 } )$ composed of algebraic entries. Then there exists $C = C ( G ) > 0$ such that

1. $G$ -local random circuits of length $C n [ \log _ { d } ( 4 t ) ] ^ { 2 } t ^ { 5 } t ^ { 3 . 1 / \log ( d ) } ( n t \log ( d ) + \log ( 1 / \epsilon ) ) .$

2. $G$ -parallel local random circuits of length $C \lceil \log _ { d } ( 4 t ) \rceil ^ { 2 } t ^ { 5 } t ^ { 3 . 1 / \log ( d ) } ( n t \log ( d ) + \log ( 1 / \epsilon ) )$ form ǫ- approximate $t$ -designs.

Proof. Define the Hermitian matrices

$$
P _ { G , t } : = \frac { 1 } { m } \sum _ { i = 1 } ^ { m } g _ { i } ^ { \otimes t , t } \qquad P _ { \mathrm { H a a r } , t } : = \int _ { \mathbb { U } ( d ^ { 2 } ) } U ^ { \otimes t , t } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U )
$$

Note that $P _ { \mathrm { H a a r } , t }$ is a projector while $P _ { G , t }$ in general will not be. The two operators commute and indeed $P _ { G , t } P _ { \mathrm { H a a r } , t } = P _ { \mathrm { H a a r } , t }$ . Thus $P _ { G , t }$ acts trivially on the subspace projected on by $P _ { \mathrm { H a a r } , t }$ . The only question is then what it does with the orthogonal space.

It was proven in [13] that there is a constant $\lambda < 1 .$ , independent of $t ,$ such that for all $t ,$

$$
\left\| P _ { G , t } - P _ { \mathrm { H a a r } , t } \right\| _ { \infty } \leq \lambda .
$$

(Their breakthrough was to make $\lambda$ independent of $t$ . The same result has long been known [8] with $\lambda$ a function of $G$ and $t$ for any universal set of gates.) Using the block decomposition of $P _ { G , t }$ we then have

$$
I - P _ { G , t } \geq \lambda \left( I - P _ { \mathrm { H a a r } , t } \right) .
$$

Define the local Hamiltonian in $\left( \mathbb { C } ^ { d } \right) ^ { \otimes n }$ :

$$
H _ { G , n , t } : = \sum _ { i = 1 } ^ { n - 1 } \left( I - P _ { G , t } \right) _ { i , i + 1 } .
$$

Note it has the same groundstate as $H _ { n , t }$ . From Eq. (135):

$$
H _ { G , n , t } \geq \lambda H _ { n , t } ,
$$

with $H _ { n , t }$ given by Eq. (28). Moreover $H _ { G , n , t }$ has the same ground space as $H _ { n , t }$ . Thus

$$
\Delta ( H _ { G , n , t } ) \geq \lambda \Delta ( H _ { n , t } ) .
$$

In complete analogy to the proof of Lemma 16, we have that

$$
g ( \nu _ { \mathrm { L R } , n , d , G } , t ) = 1 - \frac { \Delta ( H _ { G , n , t } ) } { n }
$$

with $\nu _ { \mathrm { L R } , n , d , G }$ the distribution over circuits that is obtained by replacing the Haar measure in $\nu _ { \mathrm { L R } , n , d }$ with uniform measure over the set $G$ . (We define $\nu _ { \mathrm { P L R } , n , d , G }$ analogously.) The first claim of the corollary now follows from Eq. (42).

For the model with parallel gates, we need to replace $M _ { n , t }$ in (43) with

$$
\begin{array} { r l } & { M _ { G , n , t } : = \frac { ( P _ { G , t } ) _ { 1 , 2 } ( P _ { G , t } ) _ { 3 , 4 } \cdot \cdot \cdot ( P _ { G , t } ) _ { n - 1 , n } + ( P _ { G , t } ) _ { 2 , 3 } ( P _ { G , t } ) _ { 4 , 5 } \cdot \cdot \cdot ( P _ { G , t } ) _ { n - 2 , n - 1 } } { 2 } } \\ & { \qquad : = \frac { P _ { G , t , \mathrm { o d d } } + P _ { G , t , \mathrm { e v e n } } } { 2 } } \end{array}
$$

where we use the notation $( X ) _ { i , i + 1 }$ to indicate the operator $X$ acting on sites $i , i + 1$ tensored with identity operators elsewhere. Let $P _ { G , t } ^ { \prime } = P _ { G , t } - P _ { \mathrm { H a a r } , t }$ and observe that by (134), $\| P _ { G , t } ^ { \prime } \| _ { \infty } \leq \lambda$ Then

$$
\begin{array} { r l } & { P _ { G , t , \mathrm { o d d } } = ( P _ { \mathrm { H a a r } , t } + P _ { G , t } ^ { \prime } ) _ { 1 , 2 } ( P _ { \mathrm { H a a r } , t } + P _ { G , t } ^ { \prime } ) _ { 3 , 4 } \cdot \cdot \cdot ( P _ { \mathrm { H a a r } , t } + P _ { G , t } ^ { \prime } ) _ { n - 1 , n } } \\ & { \qquad : = P _ { \mathrm { o d d } } + Q _ { \mathrm { o d d } } } \end{array}
$$

where we have defined $P _ { \mathrm { o d d } } = ( P _ { \mathrm { H a r } , t } ) _ { 1 , 2 } ( P _ { \mathrm { H a a r } , t } ) _ { 3 , 4 } \cdot \cdot \cdot ( P _ { \mathrm { H a a r } , t } ) _ { n - 1 , n }$ (as in Section IV B) and defined $Q _ { \mathrm { o d d } }$ to be the sum of the remaining $2 ^ { n / 2 } - 1$ terms. Because of the block decomposition of $P _ { G , t }$ each of these terms is orthogonal to the others as well as to $P _ { \mathrm { H a a r } , t }$ . Thus $\| Q _ { \mathrm { o d d } } \| _ { \infty } \leq \lambda$ and $Q _ { \mathrm { o d d } }$ and $P _ { \mathrm { o d d } }$ are orthogonal to each other. This means that

$$
P _ { G , t , \mathrm { o d d } } \leq P _ { \mathrm { o d d } } + \lambda ( I - P _ { \mathrm { o d d } } ) = ( 1 - \lambda ) P _ { \mathrm { o d d } } + \lambda I .
$$

Similar arguments imply that

$$
P _ { G , t , \mathrm { e v e n } } \leq P _ { \mathrm { e v e n } } + \lambda ( I - P _ { \mathrm { e v e n } } ) = ( 1 - \lambda ) P _ { \mathrm { e v e n } } + \lambda I .
$$

Recall from Lemma 22 and the following discussion that

$$
\frac { P _ { \mathrm { o d d } } + P _ { \mathrm { e v e n } } } { 2 } \leq P _ { \mathrm { a l l , t } } + ( 1 - \delta / 1 3 ) ( I - P _ { \mathrm { a l l , } t } ) ,
$$

where $\delta$ is the lower bound on $\Delta ( H _ { n , t } )$ from (42). Putting this together we find that

$$
\lambda _ { t ! + 1 } ( M _ { G , n , t } ) \leq 1 - \frac { ( 1 - \lambda ) \delta } { 1 3 } .
$$

This bound on the gap can yield the desired bound on the number of gates needed using the same arguments that have appeared for the case of Haar-random gates.

# VII. PROOF OF PROPOSITION 8

In this section, we state lower bounds on the size of $t$ -designs that match our results in Corollary 6 up to polynomial factors.

First we argue that if $\nu$ is an approximate $t$ -design, it must have large support. More precise lower bounds are known for exact $t$ -designs [71] and for approximate 2-designs [5], but for our purposes, it will be enough to determine the rate of scaling.

Lemma 26. If $\nu$ is an $\epsilon$ -approximate $t$ -design on $\mathbb { U } ( N )$ then

$$
| \operatorname { s u p p } ( \nu ) | \geq ( 1 - \epsilon ) { \binom { N + t - 1 } { t } } ^ { 2 }
$$

Proof. Let $S = \vee ^ { t } \mathbb { C } ^ { N }$ be the symmetric subspace of $( \mathbb { C } ^ { N } ) ^ { \otimes t }$ (c.f. Definition 29 in Appendix A) Define $| \varphi \rangle$ to be the maximally entangled state on $S \otimes S$ . Since $S$ is an irrep of $\mathbb { U } ( N )$ under the action $U \mapsto U ^ { \otimes t } ,$ , it follows that $( \Delta _ { \mu _ { \mathrm { H a a r } , t } } \otimes \mathrm { i d } ) ( \varphi )$ is the maximally mixed state on $S \otimes S$ . This has rank $\binom { N + t - 1 } { t } ^ { 2 }$ . Thus, to approximate this state to within trace distance $\epsilon$ requires a state of rank at least $\left( 1 - \epsilon \right) { \binom { N + t - 1 } { t } } ^ { 2 }$ . Finally, $\mathrm { r a n k } ( ( \Delta _ { \nu , t } \otimes \mathrm { i d } ) ( \varphi ) ) \leq | \operatorname { s u p p } ( \nu ) | .$ b

To relate the cardinality of a design with the number of gates in a quantum circuit, we need to discretize the set of all quantum circuits. We say that a set $X$ is an $\epsilon$ -covering of $Y$ if for all $y \in Y$ , there exists an $x \in X$ with $d ( x , y ) \leq \epsilon$ for some distance measure $d$ .

Lemma 27. There exists an $\epsilon$ -covering in diamond norm of $\begin{array} { r } { s i z e \leq \binom { n } { 2 } ^ { r } \left( \frac { 1 0 r } { \epsilon } \right) ^ { r d ^ { 4 } } } \end{array}$ for the set of circuits on n qudits comprised of $\leq r$ two-qudit gates.

Before proving the lemma, we note the following useful bound from part 6 of Lemma 12 of [4] that applies to any unitaries $U , V$ :

$$
\begin{array} { r } { \| \mathrm { a d } _ { U } - \mathrm { a d } _ { V } \| _ { \infty } \leq 2 \| U - V \| _ { \infty } . } \end{array}
$$

Proof. To describe an $\epsilon$ -covering for circuits, it suffices to specify the location of each gate and to approximate each gate to accuracy $\epsilon / r$ . The former has ${ \binom { n } { 2 } } ^ { \hat { r } }$ choices; the latter requires $r$ copies of a $\epsilon / r$ -covering for $\bar { U } ( d ^ { 2 } )$ . Finally, standard arguments [63] show that such nets can be constructed with size $\leq ( 5 r / \epsilon ) ^ { d ^ { 4 } }$ for the operator norm. We convert operator norm to diamond norm using (149). ⊓⊔

Combining these results we can prove that $t$ -designs require large circuits.

Proposition (Restatement of Proposition 8). Let $\nu$ be a distribution with support on circuits of size smaller than $r$ . Suppose that $\nu$ is an $\epsilon$ -approximate $t$ -design on n qudits with $\epsilon \leq 1 / 4$ and $t \leq d ^ { n / 2 }$ . Then

$$
r \geq \frac { n t } { 5 d ^ { 4 } \ln ( n t ) } .
$$

Proof. Let the distribution $\nu$ be an $\varepsilon$ -approximate unitary $t$ -design with all elements composed of $r$ two-qudit gates, possibly including the identity. From Lemma 27, construct a diamond-norm $\delta$ -covering for the set of circuits on $n$ qudits, and denote it by $C _ { \delta }$ . Consider a new distribution ${ \tilde { \nu } } ( \mathrm { d } U )$ in which each unitary $U$ is replaced by its closest unitary $\tilde { U } \in C _ { \delta }$ . We claim that $\{ \tilde { \nu } ( \mathrm { d } U ) , U \}$ is a $( \varepsilon + t \delta )$ -approximate unitary $t$ -design. Indeed

$$
\begin{array} { r l } & { \| \Delta _ { \tilde { \nu } , t } - \Delta _ { \mu _ { \mathrm { H a r } } , t } \| _ { \infty } \leq \| \Delta _ { \nu , t } - \Delta _ { \mu _ { \mathrm { H a r } } , t } \| _ { \infty } + \| \Delta _ { \tilde { \nu } , t } - \Delta _ { \nu , t } \| _ { \infty } } \\ & { \qquad \leq \varepsilon + \underset { U \in \mathrm { s u p p } ( \nu ) } { \operatorname* { m a x } } \underset { \tilde { U } \in \mathcal { C } _ { \delta } } { \operatorname* { m i n } } \| \mathrm { a d } _ { U ^ { \otimes t } } - \mathrm { a d } _ { \tilde { U } \otimes t } \| _ { \infty } } \\ & { \qquad \leq \varepsilon + 2 \underset { U \in \mathrm { s u p p } ( \nu ) } { \operatorname* { m a x } } \underset { \tilde { U } \in \mathcal { C } _ { \delta } } { \operatorname* { m i n } } \| U ^ { \otimes t } - \tilde { U } ^ { \otimes t } \| _ { \infty } } \\ & { \qquad \leq \varepsilon + 2 t \underset { U \in \mathrm { s u p p } ( \nu ) } { \operatorname* { m a x } } \underset { \tilde { U } \in \mathcal { C } _ { \delta } } { \operatorname* { m i n } } \| U - \tilde { U } \| _ { \infty } } \\ & { \qquad \leq \varepsilon + 2 t \delta , } \end{array}
$$

See Fact 2.0.1 of [11] for a statement and proof of the hybrid inequality.

Choosing $\delta = \varepsilon / 2 t$ we get that the distribution $\tilde { \nu }$ is a $2 \varepsilon \cdot$ -approximate $t$ -design. Now we invoke Lemmas 26 and 27 to bound

$$
( 1 - 2 \varepsilon ) { \binom { d ^ { n } + t - 1 } { t } } \leq | \mathbf { s u p p } ( \tilde { \nu } ) | \leq { \binom { n } { 2 } } ^ { r } \left( { \frac { 2 0 r t } { \varepsilon } } \right) ^ { r d ^ { 4 } } . \qquad 
$$

After some algebra, we obtain the desired bound on $r$ . which implies that

$$
r \geq \frac { n t } { 2 \log ( t ) d ^ { 4 } } .
$$

# VIII. PROOF OF COROLLARIES 10 AND 12

In the proof of Corollary 10 we make use of the following lemma due to Low, which gives a measure concentration result for $t$ -designs. Our definition of approximate $t$ -designs differs from his by a normalizing factor, and we have adjusted the statement of the result accordingly.

Lemma 28 (Low, Theorem 1.2 of [60]). Let $f ~ : ~ \mathbb { U } ( D ) ~ \to ~ \mathbb { R }$ be a polynomial of degree $K$ . Let $\begin{array} { r } { f ( U ) = \sum _ { i } \alpha _ { i } M _ { i } ( U ) } \end{array}$ where $M _ { i } ( U )$ are monomials and let $\textstyle \alpha ( f ) = \sum _ { i } | \alpha _ { i } |$ . Suppose that $f$ has probability concentration

$$
\Pr _ { U \sim \mu _ { H a a r } } \left( | f ( U ) - \mu | \geq \delta \right) \leq C e ^ { - a \delta ^ { 2 } } ,
$$

and let $\nu$ be an $\epsilon$ -approximate unitary $t$ -design. Then for any integer m with $2 m K \leq t ,$

$$
\operatorname* { P r } _ { U \sim \nu } \left( | f - \mu | \geq \delta \right) \leq \frac { 1 } { \delta ^ { 2 m } } \left( C \left( \frac { m } { a } \right) ^ { m } + 2 \epsilon ( \alpha + | \mu | ) ^ { 2 m } \right) .
$$

Let us turn to the proof of Corollary 10.

Corollary 10 (restatement). Let $\left( \nu _ { L R , d , n } \right) ^ { \ast s }$ be the distribution on $\mathbb { U } ( d ^ { n } )$ induced by s steps of the local random quantum circuit model. Then for every $\delta \leq 1 / 2 0$ ,

$$
\operatorname* { P r } _ { U \sim \left( \nu _ { L R , d , n } \right) ^ { * s } } \left( \operatorname* { m a x } _ { M \in s i z e ( r ) } \left. \langle 0 ^ { n } | U ^ { \dagger } M U | 0 ^ { n } \rangle - \frac { \operatorname { t r } ( M ) } { d ^ { n } } \right. \geq \delta \right) \leq \left( \frac { r } { \delta } \right) ^ { 2 r d ^ { 4 } } \cdot 3 \left( \frac { 5 6 0 t } { d ^ { n } \delta ^ { 2 } } \right) ^ { t / 4 } ,
$$

with

$$
t = \left\lfloor \left( { \frac { s } { 1 4 0 0 n ^ { 2 } \log ( d ) } } \right) ^ { 1 / 1 1 } \right\rfloor ,
$$

and where the maximization is realized over all two-outcome POVMs $\{ M , { \mathrm { i d } } - M \}$ which can be imple mented by quantum circuits of size $r$ .

In particular, for fixed $d$ and n sufficiently large, all but a $2 ^ { - \Omega ( n ) }$ -fraction of states generated by circuits of size $n ^ { k }$ (for $k \geq 1 0 ,$ ) cannot be distinguished from the maximally mixed state with bias larger than $n ^ { - \Omega ( 1 ) }$ by any circuit of size $n ^ { \frac { k - 9 } { 1 1 } } \operatorname { p o l y l o g } ^ { - 1 } ( \bar { n } )$ .

Proof. Consider a fixed POVM element $0 \le M \le I$ . Let us apply Lemma 28 with $f _ { M } ( U ) : =$ $\langle 0 ^ { n } | { \dot { U } } ^ { \dagger } M U | 0 ^ { n } \rangle$ . We have $D = d ^ { n }$ , $K = 2$ and $\mu = \mathrm { t r } ( M ) / d ^ { n } \leq 1$ . We can upper bound $\alpha ( f )$ by $\begin{array} { r } { \sum _ { i , j } | M _ { i , j } | \leq d ^ { 2 n } . } \end{array}$ . Moreover, by Levy’s lemma [58],

$$
\operatorname* { P r } _ { U \sim \mu _ { \mathrm { H a r } } } \left( | f _ { M } ( U ) - \mu | \geq \delta \right) \leq 2 e ^ { - \frac { d ^ { n } \delta ^ { 2 } } { 1 4 0 } } .
$$

Choose

$$
t = \left\lfloor \left( { \frac { s } { 1 4 0 0 n ^ { 2 } d ^ { 2 } \log ( d ) } } \right) ^ { 1 / 1 1 } \right\rfloor \qquad { \mathrm { a n d ~ } } \qquad \epsilon = \left( { \frac { 3 5 t } { ( d ^ { 2 n } + 1 ) ^ { 2 } d ^ { n } } } \right) ^ { t / 4 } .
$$

From Corollary 6 we get that local random quantum circuits of size $s$ form an $\epsilon$ -approximate unitary $t$ -design. Then using Lemma 28 with $m = t / 4$

$$
\begin{array} { r l } { \underset { U \sim \nu _ { \mathrm { L R } , d , n } ^ { * * } } { \operatorname* { P r } } \left( | f _ { M } ( U ) - \mu | \geq \delta / 2 \right) \leq \frac { 1 } { ( \delta / 2 ) ^ { t / 2 } } \left( 2 \left( \frac { 1 4 0 t } { 4 d ^ { n } } \right) ^ { t / 4 } + 2 \epsilon ( d ^ { 2 n } + 1 ) ^ { t / 2 } \right) } & { } \\ { = } & { 4 \left( \frac { 1 4 0 t } { d ^ { n } \delta ^ { 2 } } \right) ^ { t / 4 } . \quad } \end{array}
$$

Next, we let $S _ { r }$ be a $\delta / 2$ -covering of the set of circuits of size $r$ (see Lemma 27 for a definition). By Lemma 27 and using $n \leq r ,$ we can assume

$$
| S _ { r } | \leq \binom { n } { 2 } ^ { r } \left( \frac { 2 0 r } { \delta } \right) ^ { r d ^ { 4 } } \leq \left( \frac { r } { \delta } \right) ^ { 2 r d ^ { 4 } } .
$$

The quantity we are interesting in upper bounding is

$$
p : = \operatorname* { P r } _ { U \sim \nu _ { \mathrm { L R } , d , n } ^ { \mathrm { s s } } } \left( \operatorname* { m a x } _ { M \in \mathrm { s i z e } ( r ) } | f _ { M } ( U ) - \mu | \geq \delta \right) \leq \operatorname* { P r } _ { U \sim \nu _ { \mathrm { L R } , d , n } ^ { \mathrm { s s } } } \left( \operatorname* { m a x } _ { M \in S _ { r } } | f _ { M } ( U ) - \mu | \geq \delta / 2 \right)
$$

Using a union bound, this latter probability is

$$
\leq \left( \frac { r } { \delta } \right) ^ { 2 r d ^ { 4 } } \cdot 3 \left( \frac { 5 6 0 t } { d ^ { n } \delta ^ { 2 } } \right) ^ { t / 4 } .
$$

Substituting our choice of $t ,$ we see that this probability is negligible when $\delta$ and $d$ are constant and $r \log ( r ) \ll s ^ { 1 / 1 1 } n ^ { 9 / 1 1 }$ .

Finally we prove

Lemma 12 (restatement). Let $C _ { U }$ be a quantum circuit of size $r o n \leq r$ qudits that makes use of a unitary oracle $U$ on $n \leq r$ qudits. That is, each gate in $C _ { U }$ can either apply an arbitrary two-qudit gate to any pair of qudits, or can apply $U$ to its first n qudits. Then

$$
\left\| \int _ { \mathbb { U } ( d ^ { n } ) } \mathrm { a d } _ { C _ { U } } \nu _ { \mathrm { L R } , d , n } ^ { * s } ( \mathrm { d } U ) - \int _ { \mathbb { U } ( d ^ { n } ) } \mathrm { a d } _ { C _ { U } } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \right\| _ { \diamond } \leq \epsilon ,
$$

for any $\epsilon > 0$ and $s \geq 4 2 5 0 0 n r ^ { 9 . 5 } \log ^ { 2 } ( r ) ( 6 n r d ^ { 2 } \log ( d ) + \log ( 1 / \epsilon ) )$ . In other words, random circuits cannot be distinguished from Haar-random unitaries by significantly shorter circuits.

Proof. Let $- I \leq M \leq I$ and $\left| \psi \right. \in \left( \mathbb { C } ^ { d } \otimes \mathbb { C } ^ { d } \right) ^ { \otimes n }$ be such that

$$
\begin{array} { r l r } { X } & { : = } & { \left\| \displaystyle \int _ { \mathbb { U } ( d ^ { n } ) } { \mathrm { a d } } _ { C _ { U } } \nu _ { \mathrm { L R } , d , n } ^ { * r } ( \mathrm { d } U ) - \displaystyle \int _ { \mathbb { U } ( d ^ { n } ) } { \mathrm { a d } } _ { C _ { U } } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \right\| _ { \diamond } } \\ & { = } & { \mathrm { t r } \left( M \left( \displaystyle \int _ { \mathbb { U } ( d ^ { n } ) } ( C _ { U } \otimes I ) | \psi \rangle \langle \psi | ( C _ { U } \otimes I ) ^ { \dagger } \nu _ { \mathrm { L R } , d , n } ^ { * r } ( \mathrm { d } U ) - \displaystyle \int _ { \mathbb { U } ( d ^ { n } ) } ( C _ { U } \otimes I ) | \psi \rangle \langle \psi | ( C _ { U } \otimes I ) ^ { \dagger } \nu _ { \mathrm { L R } , d , n } ^ { * r } ( \mathrm { d } U ) \right) \right. } \end{array}
$$

Using repeatedly that $\operatorname { t r } ( ( A _ { 1 } \otimes . . . \otimes A _ { k } ) \mathbb { V } _ { 1 , . . . , k } ) = \operatorname { t r } ( A _ { 1 } A _ { 2 } . . . A _ { k } ) ,$ , for $\mathbb { V } _ { 1 , \ldots , k }$ a representation in $\left( \mathbb { C } ^ { d } \right) ^ { \hat { \otimes } k }$ of a cycle, we can write

$$
X = \mathrm { t r } \left( L \left( \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \otimes I ^ { \otimes 2 r n } \nu _ { \mathrm { L R } , d , n } ^ { * r } ( \mathrm { d } U ) - \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \otimes I ^ { \otimes 2 r n } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \right) \right) ,
$$

with $t \leq r$ and $L : = L _ { 1 } . . . L _ { p } ,$ where each $L _ { k }$ is given by a tensor product of unitary operators and $| \psi \rangle \langle \psi |$ . Thus $\| L \| _ { 1 } \leq d ^ { 4 r n } \| L \| _ { \infty } \leq d ^ { 4 r n }$ and so

$$
\begin{array} { r l } {  { X \ \leq \| L \| _ { 1 } \| \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \otimes I ^ { \otimes 2 r n } \nu _ { \mathrm { L R } , d , n } ^ { * r } ( \mathrm { d } U ) - \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \otimes I ^ { \otimes 2 r n } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \| _ { \infty } } } \\ & { \leq \ d ^ { 4 r n } \| \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \nu _ { \mathrm { L R } , d , n } ^ { * r } ( \mathrm { d } U ) - \int _ { \mathbb { U } ( d ^ { n } ) } U ^ { \otimes t , t } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) \| _ { \infty } . } \end{array}
$$

The statement follows from part 1 of Theorem 5.

# IX. PROOF OF COROLLARY 15

Corollary 15 (restatement). There exists a universal constant $C < 1 0 ^ { 9 }$ such that for any two orthogonal $n$ -qubit states $| \psi _ { 0 } \rangle$ and $\left| \psi _ { 1 } \right.$ most random unitaries $U$ chosen from the measure $\left( \nu _ { P L R , d , n } \right) ^ { * C n } ,$ n∗Cn, induced by $C n$ steps of the parallel local random circuit model, map $| \psi _ { 0 } \rangle , | \psi _ { 1 } \rangle$ to states with nearly identical marginals. More precisely, with probability larger than $1 - 2 ^ { - n / 8 }$ , for every region $X = \{ l _ { 0 } , . . . , l _ { 0 } + l \}$ of size $l \leq n / 4$ :

$$
\begin{array} { r } { \left\| \operatorname { t r } _ { \setminus X } \Big ( U | \psi _ { 0 } \rangle \langle \psi _ { 0 } | U ^ { \dagger } \Big ) - \tau _ { X } \right\| _ { 1 } , \left\| \operatorname { t r } _ { \setminus X } \Big ( U | \psi _ { 1 } \rangle \langle \psi _ { 1 } | U ^ { \dagger } \Big ) - \tau _ { X } \right\| _ { 1 } \leq 2 ^ { - n / 8 } } \end{array}
$$

and

$$
\begin{array} { r } { \| \operatorname { t r } _ { \mathrm { \backslash } X } ( U | \psi _ { 0 }  \langle \psi _ { 1 } | U ^ { \dagger } ) \| _ { 1 } \leq 2 ^ { - n / 8 } , } \end{array}
$$

with $\tau _ { X }$ the maximally mixed state in $X$ and $\operatorname { t r } _ { \setminus X }$ the partial trace with respect to all sites except the ones in region $X$ . Thus the states $U | \psi _ { 0 } \rangle$ and $U | \psi _ { 1 } \rangle$ exhibit $( n / 4 , 2 ^ { - n / 8 } ,$ )-TQO.

Proof. A standard estimate gives that for a Haar random unitary $U$ :

$$
\begin{array} { r } { \mathbb { E } _ { U \sim \mu _ { \mathrm { H a r } } } \left\| \mathrm { t r } _ { \backslash X } \left( U | \psi _ { 0 } \rangle \langle \psi _ { 0 } | U ^ { \dagger } \right) - \tau _ { X } \right\| _ { 2 } ^ { 2 } \leq 2 ^ { - ( n - l ) } . } \end{array}
$$

Apply part 2 of Theorem 5 with $d = 2 , t = 2 , \epsilon = 2 ^ { - n }$ to find that

$$
\begin{array} { r } { \mathbb { E } _ { U \sim \left( \nu _ { \mathrm { P L R } , d , n } \right) ^ { * C n } } \left\| \mathrm { t r } _ { \backslash X } \left( U | \psi _ { 0 } \rangle \langle \psi _ { 0 } | U ^ { \dagger } \right) - \tau _ { X } \right\| _ { 2 } ^ { 2 } \leq 2 ^ { - ( n - l ) } + 2 ^ { - n } , } \end{array}
$$

for $C \le 1 0 ^ { 9 }$ . (168) then follows from the relation $\| Z \| _ { 1 } \leq \sqrt { D } \| Z \| _ { 2 } ,$ valid for any $D \times D$ matrix $Z$

The proof of (169) is completely analogous, we just have to note that

$$
\begin{array} { r } { \mathbb { E } _ { U \sim \mu _ { \mathrm { H a a r } } } \left\| \operatorname { t r } _ { \backslash X } \left( U | \psi _ { 0 } \rangle \langle \psi _ { 1 } | U ^ { \dagger } \right) \right\| _ { 2 } ^ { 2 } \leq 4 \cdot 2 ^ { - ( n - l ) } . } \end{array}
$$

# X. DISCUSSION AND OPEN QUESTIONS

Our work shows that random unitary circuits resemble Haar-uniform unitaries in the sense of being approximate $k$ designs. Of course, this is not the only possible criteria for rapid mixing. At least two other conditions that would be interesting to investigate are the rapid-scrambling criterion [57, 72] and the log-Sobolev condition [53]. In general, it makes sense to investigate these conditions in the context of an application, and here too more work could be done to clarify questions such as which definition of $\epsilon$ -approximate $t { \cdot }$ -designs is most natural.

Another natural open question is to extend our results to an arbitrary universal set of gates. Currently we can only handle the case of sets composed of gates with algebraic entries, but we believe this is just a technicality.

For nearest-neighbor circuits in one dimension, our results are nearly optimal. In other geometries, random circuits mix at least as well, but in this case, our results are likely to be far from optimal. For interactions on general graphs, it is plausible that parallel random circuits mix in time comparable to the diameter of the graph, which we establish only in the case of graphs of linear diameter.

Another open question is whether our results can be strengthened to prove the incompressibility of quantum circuits. See Application II in Section III for more discussion of this point.

Finally, in physical systems, it is natural to consider random time-independent Hamiltonians, rather than random sequences of unitaries. Here the situation is qualitatively unlike that of classical time-independent stochastic processes, since the phenomenon of Anderson localization prevents mixing in many cases (see [38] for a review). It is an intriguing open question to understand the cases in which rapid mixing nevertheless occurs, and in particular to give a physically plausible derivation of the observed phenomenon of thermalization.

# XI. ACKNOWLEDGMENTS

We would like to thank Dorit Aharonov, Itai Arad, Winton Brown, Daniel Jonathan, Emilio Onorati, Alex Russell, and Tomasz Szarek for useful discussions and suggestions on approximate unitary designs, Bruno Nachtergaele for helpful explanations about [64], Kevin Zatloukal for sharing his results about partitions and Andreas Winter for suggesting Definition 2. We are grateful to Juani Bermejo Vega, Dominik Hangleiter and Jonas Haferkamp for making us aware of mistakes in the previous version. We would like to thank the anonymous referee for many useful comments. FGSLB acknowledges support from EPSRC through an Early Career Fellowship, the Swiss National Science Foundation, via the National Centre of Competence in Research QSIT, the Ministry of Education and the National Research Foundation, Singapore, and the Polish Ministry of Science and Higher Education Grant No. IdP2011 000361. AWH was funded by NSF grants 0916400, 0829937, 0803478, 1111382, 1452616; DARPA QuEST contract FA9550-09-1- 0044; and the IARPA MUSIQC and QCS contracts. MH is supported by EU grant QESSENCE, the project QUASAR of the National Centre for Research and Development of Poland and by Polish Ministry of Science and Higher Education grant N N202 231937. Part of this work was done in National Quantum Information Center of Gdansk. We thank the hospitality of Institute Mittag Leffler within the program “Quantum Information Science”, where (another) part of this work was done.

# Appendix A: Facts about designs and tensor-product expanders

Definition 29. Define the symmetric subspace of $( \mathbb { C } ^ { N } ) ^ { \otimes t }$ to be the set of vectors that are invariant under $V _ { N } ( \pi )$ (defined in Eq. (32)) for all $\pi \in S _ { t }$ . Denote this subspace by $\vee ^ { t } \mathbb { C } ^ { N }$ . Note that $\mathrm { d i m } \vee ^ { t } \mathbb { C } ^ { N } =$ N N +t−1.

Before proving Lemma 3, we relate the design condition of Definition 2 to an easier-to-prove condition.

Lemma 30. For ν a measure on $\mathbb { U } ( N )$ , define:

$$
\begin{array} { r } { \rho _ { \nu } : = ( \Delta _ { \nu , t } \otimes \mathrm { i d } ) ( \Phi _ { N } ^ { \otimes t } ) \qquad } \\ { \rho _ { H a a r } : = ( \Delta _ { \mu _ { H a a r } , t } \otimes \mathrm { i d } ) ( \Phi _ { N } ^ { \otimes t } ) \qquad } \end{array}
$$

Then

1. The support of $\rho _ { \nu }$ and $\rho _ { H a a r } $ is contained in $S : = \vee ^ { t } ( \mathbb { C } ^ { N } \otimes \mathbb { C } ^ { N } )$ .

2. The minimum eigenvalue of $\rho _ { H a a r } | _ { S } i s \ge N ^ { - 2 t }$ .

3.

$$
G ( \nu , t ) \leq N ^ { 2 t } \| \rho _ { \nu } - \rho _ { H a a r } \| _ { \infty }
$$

Proof. 1. Each density matrix is a mixture of states of the form $( ( U \otimes I ) | \Phi _ { N } \rangle ) ^ { \otimes t } ,$ , each of which individually belongs to $\forall ^ { t } ( \mathbb { C } ^ { N } \otimes \mathbb { C } ^ { N } )$ .

2. We will use Schur duality (see [35, 42] for reviews). Schur duality implies that

$$
| \Phi _ { N } \rangle ^ { \otimes t } \cong \sum _ { \lambda \in \mathrm { P a r } ( t , N ) } \sqrt { \frac { \dim Q _ { \lambda } ^ { N } \dim \mathcal { P } _ { \lambda } } { N ^ { t } } } | \lambda , \lambda \rangle \otimes | \Phi _ { Q _ { \lambda } ^ { N } } \rangle \otimes | \Phi _ { \mathcal { P } _ { \lambda } } \rangle ,
$$

where $\operatorname* { P a r } ( t , N )$ denotes the partitions of $t$ into $\leq N$ parts, $\mathcal { Q } _ { \lambda } ^ { N }$ denotes the irrep of $\mathbb { U } ( N )$ corresponding to partition $\lambda , \mathcal { P } _ { \lambda }$ the irrep of $S _ { t }$ corresponding to $\lambda ,$ and $| \Phi _ { \mathcal { Q } _ { \lambda } ^ { N } } \rangle , | \Phi _ { \mathcal { P } _ { \lambda } } \rangle$ refers to maximally entangled states on pairs of these spaces. Then

$$
\begin{array} { r l r } {  { \rho _ { \mathrm { H a a r } } = \int _ { \mathbb { U } ( N ) } ( \mathrm { a d } _ { U \otimes I } ( \Phi _ { N } ) ) ^ { \otimes t } \mu _ { \mathrm { H a a r } } ( \mathrm { d } U ) } } \\ & { } & { \quad \cong \sum _ { \lambda \in \mathrm { P a r } ( t , N ) } \frac { \dim Q _ { \lambda } ^ { N } \dim \mathcal { P } _ { \lambda } } { N ^ { t } } | \lambda \rangle \langle \lambda | ^ { \otimes 2 } \otimes ( \frac { I _ { Q _ { \lambda } ^ { N } } } { \dim Q _ { \lambda } ^ { N } } ) ^ { \otimes 2 } \otimes | \Phi _ { \mathcal { P } _ { \lambda } } \rangle \langle \Phi _ { \mathcal { P } _ { \lambda } } | . } \end{array}
$$

Restricting to ∨t(CN ⊗ CN ), we find that the minimum eigenvalue is minλ dim PλNt dim QN . This minimum is achieved by the symmetric irrep $\lambda = ( t )$ , for which $\dim { \mathcal { P } } _ { \lambda } = 1$ and $\dim \mathcal { Q } _ { \lambda } ^ { N } =$ $\binom { N + t - 1 } { t } \leq N ^ { t }$ . Thus $\lambda _ { \operatorname* { m i n } } ( \rho _ { \mathrm { H a a r } } | _ { S } ) \geq N ^ { - 2 t }$ .

3. This follows from parts 1 and 2 of this Lemma, along with (9).

Proof of Lemma 3. Let $\Theta : = \Delta _ { \nu , t } - \Delta _ { \mu _ { \mathrm { H a a r } } , t } .$ . Then

$$
\begin{array} { r l } & { \| \Theta \| _ { \diamond } = \underset { \boldsymbol { \psi } } { \operatorname* { m a x } } \| ( \Theta \otimes \mathrm { i d } ) ( \boldsymbol { \psi } ) \| _ { 1 } } \\ & { \qquad = \underset { 0 \leq M _ { - } , M _ { + } \leq I } { \operatorname* { m a x } } \underset { \boldsymbol { \psi } } { \operatorname* { m a x } } \left[ \mathrm { t r } M _ { + } ( \Theta \otimes \mathrm { i d } ) ( \boldsymbol { \psi } ) - \mathrm { t r } M _ { - } ( \Theta \otimes \mathrm { i d } ) ( \boldsymbol { \psi } ) \right] } \\ & { \qquad \leq 2 \epsilon , } \end{array}
$$

where the last line used (8).

Conversely, suppose that

$$
\| \Delta _ { \mu _ { \mathrm { H a a r } , t } } - \Delta _ { \nu , t } \| _ { \diamond } \leq \epsilon
$$

Define $\rho _ { \nu } , \rho _ { \mathrm { H a a r } }$ as in (A1). Then by (A9) we have

$$
\epsilon \geq \| \rho _ { \nu } - \rho _ { \mathrm { H a a r } } \| _ { 1 } \geq \| \rho _ { \nu } - \rho _ { \mathrm { H a a r } } \| _ { \infty }
$$

The desired claim now follows from Lemma 30.

Proof of Lemma 4. For the first inequality, observe that

$$
g ( \nu , t ) \stackrel { ( 1 ) } { \leq } N ^ { t / 2 } \lVert \Delta _ { \nu , t } - \Delta _ { \mu _ { \mathrm { H a a r } } , t } \rVert _ { \diamond } \stackrel { ( 2 ) } { \leq } 2 N ^ { t / 2 } G ( \nu , t ) ,
$$

Here (1) is from part of Lemma 2.2.14 of [61] (see in particular $\mathrm { F i g } 2 . 1 $ of [61]), with the definition OPERATOR-2-NORM from [61] corresponding to the TPE condition here, and (2) is from Lemma 3.

For the second inequality, we use the fact that the $2  2$ norm is stable under tensoring with the identity map to obtain

$$
\| ( \Delta _ { \nu , t } - \Delta _ { \mu _ { \mathrm { H a r } } , t } ) \otimes \mathrm { i d } _ { N ^ { t } } \| _ { 2  2 } \leq g ( \nu , t ) .
$$

Thus, defining $\rho _ { \nu } , \rho _ { \mathrm { H a a r } }$ as in (A1), we have

$$
g ( \nu , t ) \geq \| \rho _ { \nu } - \rho _ { \mathrm { H a a r } } \| _ { 2 } \geq \| \rho _ { \nu } - \rho _ { \mathrm { H a a r } } \| _ { \infty } .
$$

Thus, Lemma 30 implies that $G ( \nu , t ) \leq N ^ { 2 t } g ( \nu , t )$ .

[1] S. Aaronson. The ten most annoying questions in quantum computing, 2006. http://www.scottaaronson.com/blog/ $? { \mathrm { p } } { = } 1 1 2$ .   
[2] A. Abeyesinghe, I. Devetak, P. Hayden, and A. Winter. The mother of all protocols: Restructuring quantum information’s family tree. Proc. Roc. Soc. A, 465(2108):2537–2563, 2009, arXiv:quant-ph/0606225.   
[3] D. Aharonov, I. Arad, U. Vazirani, and Z. Landau. The detectability lemma and its applications to quantum hamiltonian complexity. New Journal of Physics, 13(11):113043, 2011, arXiv:1011.3445.   
[4] D. Aharonov, A. Kitaev, and N. Nisan. Quantum circuits with mixed states. In Proceedings of the thirtieth annual ACM symposium on Theory of computing, pages 20–30. ACM, 1998, arXiv:quant-ph/9806029.   
[5] A. Ambainis, J. Bouda, and A. Winter. Nonmalleable encryption of quantum information. Journal of Mathematical Physics, 50(4):042106, 2009, arXiv:0808.0353.   
[6] E. Andruchow. Short geodesics of unitaries in the $L _ { 2 }$ metric. Canadian Mathematical Bulletin, 48(3):340– 354, 2005.   
[7] L. Arnaud and D. Braun. Efficiency of producing random unitary matrices with quantum circuits. Phys. Rev. A, 78:062329, Dec 2008, arXiv:0807.0775. [8] V. I. Arnold and A. L. Krylov. Uniform distribution of points on a sphere and some ergodic properties of solutions of linear ordinary differential equations in a complex domain. Soviet Math. Dokl., 4(1), 1962.   
[9] M. C. Ba ˜nuls, J. I. Cirac, and M. B. Hastings. Strong and weak thermalization of infinite nonintegrable quantum systems. Phys. Rev. Lett., 106:050405, Feb 2011, arXiv:1007.3957.   
[10] A. Barenco, C. H. Bennett, R. Cleve, D. P. DiVincenzo, N. Margolus, P. Shor, T. Sleator, J. A. Smolin, and H. Weinfurter. Elementary gates for quantum computation. Phys. Rev. A, 52:3457–3467, Nov 1995, arXiv:quant-ph/9503016.   
[11] E. Bernstein and U. Vazirani. Quantum complexity theory. In Proceedings of the 25th Annual ACM Symposium on the Theory of Computation (STOC), pages 11–20, El Paso, Texas, 1993. ACM Press.   
[12] R. Bhatia. Matrix analysis, volume 169. Springer Science & Business Media, 2013.   
[13] J. Bourgain and A. Gamburd. A spectral gap theorem in $\mathrm { S U } ( d )$ . Journal of the European Mathematical Society, 14(5):1455–1511, 2012, arXiv:1108.6264.   
[14] F. G. S. L. Brand ˜ao, P. Cwikli ´nski, M. Horodecki, P. Horodecki, J. K. Korbicz, and ´ M. Mozrzymas. Convergence to equilibrium under a random Hamiltonian. Phys. Rev. E, 86:031101, Sep 2012, arXiv:1108.2985.   
[15] F. G. Brandao and M. Horodecki. Exponential quantum speed-ups are generic. Quantum Inf. Comput., 13:0901–0924, 2013, arXiv:1010.3654.   
[16] S. Bravyi, M. Hastings, and F. Verstraete. Lieb-Robinson bounds and the generation of correlations and topological quantum order. Phys. Rev. Lett., 97:050401, 2006, arXiv:quant-ph/0603121.   
[17] M. J. Bremner, C. Mora, and A. Winter. Are random pure states useful for quantum computation? Phys. Rev. Lett., 102:190502, May 2009, arXiv:00812.3001.   
[18] A. Brodsky and S. Hoory. Simple permutations mix even better. Random Struct. Algorithms, 32:274–289, May 2008, arXiv:math/0411098.   
[19] W. G. Brown and L. Viola. Convergence rates for arbitrary statistical moments of random quantum circuits. Phys. Rev. Lett., 104:250501, Jun 2010, arXiv:0910.0913.   
[20] R. Bubley and M. Dyer. Path coupling: A technique for proving rapid mixing in Markov chains. In Foundations of Computer Science, 1997. Proceedings., 38th Annual Symposium on, pages 223–231, Oct 1997.   
[21] X. Chen, Z.-G. Gu, and X.-G. Wen. Local unitary transformation, long-range quantum entanglement, wave function renormalization, and topological order. Phys. Rev. B, 82:1083, 2010, arXiv:1004.3835.   
[22] M. Christandl. The structure of bipartite quantum states: Insights from group theory and cryptography. PhD thesis, University of Cambridge, 2006, arXiv:quant-ph/0604183.   
[23] M. Cramer. Thermalization under randomized local Hamiltonians. New Journal of Physics, 14(5):053051, 2012, arXiv:1112.5295.   
[24] M. Cramer and J. Eisert. A quantum central limit theorem for non-equilibrium systems: exact local relaxation of correlated states. New Journal of Physics, 12(5):055020, 2010, arXiv:0911.2475.   
[25] O. C. O. Dahlsten, R. Oliveira, and M. B. Plenio. The emergence of typical entanglement in twoparty random processes. Journal of Physics A: Mathematical and Theoretical, 40(28):8081–8108, 2007, arXiv:quant-ph/0701125.   
[26] I. B. Damgard, S. Fehr, L. Salvail, and C. Schaffner. Cryptography in the bounded quantum-storage model. In Proceedings of the 46th Annual IEEE Symposium on Foundations of Computer Science, FOCS $^ { \prime } 0 5$ , pages 449–458, Washington, DC, USA, 2005. IEEE Computer Society, arXiv:quant-ph/0508222.   
[27] C. Dankert, R. Cleve, J. Emerson, and E. Livine. Exact and approximate unitary 2-designs and their application to fidelity estimation. Phys. Rev. A, 80:012304, Jul 2009, arXiv:quant-ph/0606161.   
[28] I. Diniz and D. Jonathan. Comment on ”Random Quantum Circuits are Approximate 2-designs”. Commun. Math. Phys., 304:281–293, 2011, arXiv:1006.4202.   
[29] J. Emerson, E. Livine, and S. Lloyd. Convergence conditions for random quantum circuits. Phys. Rev. A, 72(060302), 2005, arXiv:quant-ph/0503210.   
[30] J. Emerson, Y. S. Weinstein, M. Saraceno, S. Lloyd, and D. G. Cory. Pseudo-random unitary operators for quantum information processing. Science, 302(5653):2098–2100, 2003.   
[31] M. Fannes, B. Nachtergaele, and R. Werner. Finitely correlated states on quantum spin chains. Commun. Math. Phys., 144:443–490, 1992.   
[32] C. Gogolin, M. P. M ¨uller, and J. Eisert. Absence of thermalization in nonintegrable systems. Phys. Rev. Lett., 106:040401, Jan 2011, arXiv:1009.2493.   
[33] S. Goldstein, J. Lebowitz, R. Tumulka, and N. Zanghi. Long-time behavior of macroscopic quantum systems: Commentary accompanying the English translation of John von Neumann’s 1929 article on the quantum ergodic theorem. European Phys. J., 35:173, 2010.   
[34] S. Goldstein, J. L. Lebowitz, R. Tumulka, and N. Zangh\`ı. Canonical typicality. Phys. Rev. Lett., 96:050403, Feb 2006, arXiv:cond-mat/0511091.   
[35] R. Goodman and N. Wallach. Representations and Invariants of the Classical Groups. Cambridge University Press, 1998.   
[36] D. Gross, K. Audenaert, and J. Eisert. Evenly distributed unitaries: On the structure of unitary designs. J. Math. Phys., 48(052104), 2007, arXiv:quant-ph/0611002.   
[37] D. Gross, S. T. Flammia, and J. Eisert. Most quantum states are too entangled to be useful as computational resources. Phys. Rev. Lett., 102:190501, May 2009, arXiv:0810.4331.   
[38] G ¨unter Stolz. An introduction to the mathematics of Anderson localization, 2011, arXiv:1104.2317.   
[39] S. Hallgren and A. Harrow. Superpolynomial speedups based on almost any quantum circuit. In ICALP, volume 5125, pages 782–795, 2008, arXiv:0805.0007.   
[40] A. Harrow and R. Low. Efficient quantum tensor product expanders and $k$ -designs. In Proc. of APPROX-RANDOM, volume 5687 of LNCS, pages 548–561. Springer, 2009, arXiv:0811.2597.   
[41] A. Harrow and R. Low. Random quantum circuits are approximate 2-designs. Commun. Math. Phys., 291:257–302, 2009, arXiv:0802.1919.   
[42] A. W. Harrow. Applications of coherent classical communication and Schur duality to quantum information theory. PhD thesis, M.I.T., Cambridge, MA, 2005, arXiv:quant-ph/0512255.   
[43] A. W. Harrow. The church of the symmetric subspace, 2013, arXiv:1308.6595.   
[44] M. Hastings. Topological order at non-zero temperature. Phys. Rev. Lett., 107:210501, 2011, arXiv:1106.6026.   
[45] M. B. Hastings and A. W. Harrow. Classical and quantum tensor product expanders. Q. Inf. Comp., 9(3&4):336–360, 2009, arXiv:0804.0011.   
[46] P. Hayden, P. W. S. D. W. Leung, and A. J. Winter. Randomizing quantum states: Constructions and applications. Commun. Math. Phys., 250:371–391, 2004, arXiv:quant-ph/0307104.   
[47] P. Hayden, D. W. Leung, and A. Winter. Aspects of generic entanglement. Communications in Mathematical Physics, 265(1):95–117, 2006.   
[48] P. Hayden and J. Preskill. Black holes as mirrors: quantum information in random subsystems. JHEP, 0709:120, 2007, arXiv:0708.4025.   
[49] S. Hoory, A. Magen, S. Myers, and C. Rackoff. Simple permutations mix well. Theor. Comput. Sci., 348(2):251–261, Dec. 2005.   
[50] M. Znidariˇc. Exact convergence times for generation of rando ˇ m bipartite entanglement. Phys. Rev. A, 78:032324, Sep 2008, arXiv:0809.0554.   
[51] E. Kaplan, M. Naor, and O. Reingold. Derandomized constructions of k-wise (almost) independent permutations. Algorithmica, 55:113–133, May 2009. ECCC TR06-002.   
[52] M. Kassabov. Symmetric groups and expander graphs. Inventiones mathematicae, 170(2):327–354, Nov 2007, arXiv:math/0503204.   
[53] M. J. Kastoryano and K. Temme. Quantum logarithmic Sobolev inequalities and rapid mixing. Journal of Mathematical Physics, 54(5):052202, 2013, arXiv:1207.3261.   
[54] A. Kitaev. Fault-tolerant quantum computation by anyons. Ann. Phys., 303:1, 2003, arXiv:quant-ph/9707021.   
[55] A. Y. Kitaev, A. H. Shen, and M. N. Vyalyi. Classical and Quantum Computation, volume 47 of Graduate Studies in Mathematics. AMS, 2002.   
[56] E. Knill. Approximation by quantum circuits, 1995, arXiv:quant-ph/9508006.   
[57] N. Lashkari, D. Stanford, M. Hastings, T. Osborne, and P. Hayden. Towards the fast scrambling conjecture. Journal of High Energy Physics, 2013(4):22, 2013, arXiv:1111.6580.   
[58] M. Ledoux. The Concentration of Measure Phenomenon. AMS, 2001.   
[59] N. Linden, S. Popescu, A. J. Short, and A. Winter. Quantum mechanical evolution towards thermal

equilibrium. Phys. Rev. E, 79:061103, Jun 2009, arXiv:0812.2385. [60] R. A. Low. Large deviation bounds for k-designs. Proceedings of the Royal Society A: Mathematical, Physical and Engineering Science, 465(2111):3289–3308, 2009, arXiv:0903.5236. [61] R. A. Low. Pseudo-randomness and Learning in Quantum Computation. PhD thesis, University of Bristol, 2010, arXiv:1006.5227. [62] L. Masanes, A. J. Roncaglia, and A. Acin. The complexity of energy eigenstates as a mechanism for equilibration, 2011, arXiv:1108.0374. [63] V. Milman and G. Schechtman. Asymptotic theory of finite dimensional normed spaces. Lecture notes in mathematics. Springer, 1986. [64] B. Nachtergaele. The spectral gap for some spin chains with discrete symmetry breaking. Communications in Mathematical Physics, 175:565–606, 1996, arXiv:cond-mat/9410110. [65] C. Nayak, S. Simon, A. Stern, M. Freedman, and S. D. Sarma. Non-abelian anyons and topological quantum computation. Rev. Mod. Phys., 80:1083, 2008, arXiv:0707.1889. [66] J. Neumann. Beweis des ergodensatzes und des h-theorems in der neuen mechanik. Zeitschrift f ¨ur Physik, 57(1-2):30–70, 1929, arXiv:1003.2133. [67] R. Oliveira, O. C. O. Dahlsten, and M. B. Plenio. Efficient Generation of Generic Entanglement. Phys. Rev. Lett., 98(130502), 2007, arXiv:quant-ph/0605126. [68] R. I. Oliveira. On the convergence to equilibrium of Kac’s random walk on matrices. Ann. Appl. Probab., 19(3):1200–1231, 2009, arXiv:0705.2253. [69] D. Perez-Garcia, F. Verstraete, M. M. Wolf, and J. I. Cirac. Matrix product state representations. Quantum Inf. Comput., 7(5&6):401–430, 2007, arXiv:quant-ph/0608197. [70] P. Reimann. Foundation of statistical mechanics under experimentally realistic conditions. Phys. Rev. Lett., 101:190403, Nov 2008, arXiv:0810.3092. [71] A. Roy and A. J. Scott. Unitary designs and codes. Designs, Codes and Cryptography, 53:13–31, October 2009, arXiv:0809.3813. [72] Y. Sekino and L. Susskind. Fast scramblers. Journal of High Energy Physics, 10:065, 2008, arXiv:0808.2096. [73] P. Sen. Random measurement bases, quantum state distinction and applications to the hidden subgroup problem. In IEEE Conference on Computational Complexity, pages 274–287, 2006, arXiv:quant-ph/0512085. [74] V. Shende, S. Bullock, and I. Markov. Synthesis of quantum-logic circuits. Computer-Aided Design of Integrated Circuits and Systems, IEEE Transactions on, 25(6):1000–1010, 2006, arXiv:quant-ph/0406176. [75] L. Susskind. Computational complexity and black hole horizons. Fortschritte der Physik, 64(1):24–43, 2016, arXiv:1402.5674. [76] T. Szarek. Feller processes on nonlocally compact spaces. The Annals of Probability, 34(5):1849–1863, 2006, arXiv:math/0512221. [77] T. Szarek, 2011. private communication. [78] G. T ´oth and J. J. Garc´ıa-Ripoll. Efficient algorithm for multiqudit twirling for ensemble quantum computation. Phys. Rev. A, 75:042311, Apr 2007, arXiv:quant-ph/0609052. [79] S. Trotzky, Y.-A. Chen, A. Flesch, I. P. McCulloch, U. Schollw ¨ock, J. Eisert, and I. Bloch. Probing the relaxation towards equilibrium in an isolated strongly correlated one-dimensional bose gas. Nature Physics, 8(4):325–330, 2012, arXiv:1101.2659. [80] Vinayak and M. Znidariˇc. Subsystem dynamics under random hamiltonian ev ˇ olution. Journal of Physics A: Mathematical and Theoretical, 45(12):125204, 2012, arXiv:1107.6035. [81] X.-G. Wen. Topological orders in rigid states. Int. J. Mod. Phys, 239:050401, 1990.