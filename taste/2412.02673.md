**Sample Complexity of Black Box Work Extraction**


Shantanav Chakraborty, [1, 2,] _[ ∗]_ Siddhartha Das, [1, 2,] _[ †]_ Arnab
Ghorui, [1, 2,] _[ ‡]_ Soumyabrata Hazra, [1, 3,] _[ §]_ and Uttam Singh [1, 2,] _[ ¶]_

1 _Centre for Quantum Science and Technology (CQST),_
_International Institute of Information Technology Hyderabad, Gachibowli 500032, Telangana, India_
2 _Center for Security, Theory and Algorithmic Research (CSTAR),_
_International Institute of Information Technology Hyderabad, Gachibowli 500032, Telangana, India_
3 _Center for Computational Natural Sciences and Bioinformatics (CCNSB),_
_International Institute of Information Technology Hyderabad, Gachibowli 500032, Telangana, India_
(Dated: October 2, 2025)


Extracting work from a physical system is one of the cornerstones of quantum thermodynamics.
The extractable work, as quantified by ergotropy, necessitates a complete description of the quantum
system. This is significantly more challenging when the state of the underlying system is unknown,
as quantum tomography is extremely inefficient. In this article, we analyze the number of samples
of the unknown state required to extract work. With only a single copy of an unknown state, we
prove that ergotropy approaches zero in the asymptotic limit, rendering work extraction nearly
impossible. In contrast, when multiple copies are available, we quantify the sample complexity
required to estimate extractable work, establishing a scaling relationship that balances the desired
accuracy with success probability. Our work develops a sample-efficient protocol to assess the utility
of unknown states as quantum batteries and opens avenues for estimating thermodynamic quantities
using near-term quantum computers.


**I.** **INTRODUCTION**


Quantum thermodynamics [1–6] is vital for developing and optimizing a range of quantum technologies, including
computation [7–9], heat engines [10–15], batteries [16–18], and sensors [19, 20]. A central focus of this field is the
study of work extraction from quantum systems [21–26], which has significant implications for the development
and advancement of quantum technologies. A better understanding of the amount of extractable work from a given
system is crucial for characterizing quantum batteries, powering quantum technologies, and, more broadly, building
thermodynamically efficient and scalable quantum devices [27–37].
For an _N_ -dimensional quantum system in a state _ρ_ with Hamiltonian _H_, the extractable work under unitary
transformations is quantified by the ergotropy of the state _ρ_, given by [38–40]

                                -                                Erg ( _ρ_ ) = max _H_ _ρ_ _UρU_ _[†]_ [��] _,_ (1)
_U_ _∈_ U( _N_ ) [Tr] _−_

where U( _N_ ) is the group of _N × N_ unitary matrices. In recent years, ergotropy has been extensively explored across
various information processing and computing tasks [41–50].
To estimate the maximal amount of extractable work by measuring ergotropy, it is necessary to optimize over
unitaries _U_, as shown in Eq. (1). The resulting optimal unitary depends on the spectrum of _ρ_, which is revealed
only when a complete description of the state of a quantum system is available. However, in realistic settings, due
to technological limitations, the presence of uncontrollable environmental noise, and/or untrusted sources, the state
in which the system is prepared is often unknown or, at best, only partially known [51–61]. This makes it impossible
to estimate ergotropy (and hence, the maximal possible extractable work) without performing a full tomography on
_ρ_, a highly inefficient procedure [62, 63]. The best we can hope for is to devise a strategy in such a black-box setting
that still provides some information about the amount of extractable work while requiring only a few samples of
_ρ_ . This naturally leads us to the following question: In such a black box setting, where the underlying quantum
state is unknown, how many samples are needed to obtain an estimate of the amount of extractable work from the
system? Despite the importance of a sample-efficient scheme for work extraction, this question has remained largely
unexplored. In this paper, we address this gap by examining how the number of copies of _ρ_ affects work extraction.


_∗_ [shchakra@iiit.ac.in](mailto:shchakra@iiit.ac.in)

_†_ [das.seed@iiit.ac.in](mailto:das.seed@iiit.ac.in)

_‡_ [arnab.ghorui@research.iiit.ac.in](mailto:arnab.ghorui@research.iiit.ac.in)
_§_ [soumyabrata.hazra@research.iiit.ac.in](mailto:soumyabrata.hazra@research.iiit.ac.in)

_¶_ [uttam@iiit.ac.in](mailto:uttam@iiit.ac.in)


2

















Fig. 1. Schematic of the possibilities for extracting work when a quantum system is prepared in some unknown state _ρ_ . We
show that it is nearly impossible to extract any work with only a single copy of _ρ_ . On the other hand, when multiple copies
are available, we provide a sample and qubit-efficient randomized quantum algorithm for work extraction that requires only a
few samples of _ρ_ .


One possibility is to proceed by assuming that the _N_ -dimensional unknown state _ρ_ is random. That is, the
purification of _ρ_ leads to a Haar random state of dimension _NN_ _[′]_ (for large environment dimension _N_ _[′]_ ). Our first
contribution is to rigorously establish that it is nearly impossible to extract any (non-zero) work from a single copy of
the unknown random quantum state in the asymptotic limit. This is obtained by proving that ergotropy is Lipschitz
continuous with the Lipschitz constant scaling as the spectral norm of the Hamiltonian of the system, allowing us to
use the concentration of measure phenomenon (such as Levy’s lemma [64]) to show that for any random _ρ_, Erg( _ρ_ ) is
close to its expectation value, which approaches zero as _N_ _[′]_ _→∞_ . Owing to its connections with quantifying work,
there is widespread interest in estimating ergotropy and understanding its properties. Consequently, our result is
of independent interest. On the other hand, as mentioned before, tomography would require exponentially many
samples and measurements to estimate ergotropy. This points to a trade-off between the number of available copies
of the unknown state and extractable work. Interestingly, in Ref. [65], the authors propose a scheme using partial
information from quantum measurements that quantifies the extractable work from unknown quantum states by
associating it with a quantity called observational ergotropy. However, it is unclear if this quantity can be estimated
faithfully in a sample-efficient manner.


Our second contribution equips this procedure with rigorous performance guarantees. More precisely, we develop
a sample-efficient randomized protocol to estimate observational ergotropy, facilitating work extraction. Our method
computes this quantity to _ε_ -additive accuracy, with high probability, by making very few measurements on _ρ_ - this
requires _O_ (1 _/ε_ [2] ) copies of _ρ_ and, remarkably, has only a logarithmic dependence on the dimension of the system.
The protocol is a randomized quantum algorithm that can be efficiently run on a quantum computer using as many
samples of _ρ_ . Finally, we establish rigorous robustness bounds, showing that observational ergotropy can still be
reliably estimated under realistic errors. Our result thus broadens the applicability of quantum computers to the
efficient estimation of extractable work and the characterization of quantum batteries.


The article is organized as follows. In Sec. II, we give an overview of our main findings, namely the two distinct
approaches to work extraction. Sec. II A shows that the ergotropy of a single copy of a random state _ρ_ approaches
zero in the asymptotic limit. In contrast, when multiple copies of _ρ_ are available, Sec. II B presents a sample-efficient
randomized quantum algorithm for estimating observational ergotropy. The robustness of this estimation is analyzed
in Sec. II C. Preliminaries are introduced in Sec. III, which lay the foundation for the technical proofs in Sec. IV.
Detailed derivations of the results from Secs. II A, II B, and II C are provided in Secs. IV A, IV B, and IV C, respectively.
In Sec. IV D, we also outline an alternative quantum algorithm that efficiently estimates extractable work when the
system Hamiltonian is local. Sec. V concludes the paper. Finally, the Appendix presents several complementary
results and illustrative examples that further reinforce the theoretical findings.


**II.** **MAIN RESULTS**


In this section, we outline the main findings of our work, which are summarized in Fig. 1. Throughout this work,
we consider _n_ -qubit quantum systems associated with a Hilbert space _HN_ of dimension _N_ = 2 _[n]_, and the underlying
system is described by a Hamiltonian _H_, which we have full knowledge of. Suppose _DN_ denotes the set of density
operators on _N_, then, in our setting, the _n_ -qubit system of Hamiltonian _H_ is prepared in some unknown quantum
_H_
state _ρ_ _N_ .
_∈D_


3


**A.** **(No) work extraction from a single copy of** _ρ_


When only a single copy of the unknown state is available, it is, in principle, possible to consider _ρ_ to be a random
state drawn from some statistical distribution over all possible density matrices. In this picture, we assume that a
single query to a black box produces a state sampled from a known distribution, motivated by the fact that with only
one copy of _ρ_ there is little else that the experimentalist can exploit. Thus, in this black box setting, although the
underlying distribution is known, the specific instance of the state, produced by the black box, remains unknown.
The idea then is to use information about this distribution to extract some work. To this end, we assume that _ρ_ _N_
_∈D_
is a random full rank density matrix whose purification leads to a Haar random state of dimension _NN_ _[′]_ . We prove
that it is almost always impossible to extract any nontrivial amount of work (ergotropy) with high probability over
possible density matrices from this distribution. This result is obtained via a sequence of non-trivial steps, which we
outline here, while detailed derivations can be found in Sec. IV A.
Since _ρ_ is a random quantum state, its ergotropy, Erg( _ρ_ ), is a random variable. For any Hamiltonian _H_ of bounded
spectral norm _∥H∥_, we first prove that this expectation value is upper bounded by a quantity which approaches zero
as _N_ _[′]_ _→∞_ . More precisely, (See Lemma 4 of Sec. IV A), we prove that

              


E [Erg( _ρ_ )] _≤∥H∥_



_N_
_N_ _[′]_ _[.]_



We then estimate for a random instance of _ρ_ how close Erg( _ρ_ ) is to its expected value. Typically, this is proved
using measure concentration bounds, which require Lipschitz continuity. However, whether the latter property holds
for the ergotropy function has been unknown until recently [66]. We develop a slightly different approach to prove
that ergotropy is a Lipschitz continuous function with a Lipschitz constant of 4 _∥H∥_ . This allows us to apply the
concentration of measure bound to derive that with a high probability Erg( _ρ_ ) _≤_ _γ_, where _γ_ is a small number
approaching zero. Our results are formally stated via the following theorem.


**Theorem 1** (Impossibility of work extraction from a random state) **.** _Let ρ_ ( _U_ ) _∈DN be a full rank random density_
_matrix obtained by partial tracing subsystem B of a randomly selected pure state U |ψ_ 0 _⟩AB in a composite Hilbert space_ _of dimension of NN_ _[′]_ _, where |ψ_ 0 _⟩AB is some fixed state and N_ _[′]_ _> N_ _. Then for γ >_ 2 _∥H∥_ _N/N_ _[′]_ _, the ergotropy of_

_ρ_ ( _U_ ) _satisfies_








_−_ 768 _[NN]_ _∥H_ _[ ′][γ]_ _∥_ [2][2]







Pr [Erg( _ρ_ ( _U_ )) _> γ_ ] _≤_ exp



_._ (2)



We prove this theorem in detail in Sec. II A. Note that the tolerance _γ_ of ergotropy goes to zero in the limit _N_ _[′]_ _→∞_ .
Also, the right-hand side of Eq. (2) vanishes in the limit _N_ _[′]_ _→∞_ for any _γ_, however small. Thus Theorem 1 can
be interpreted as follows: it is impossible (assuming that the Hamiltonian is bounded) to extract any ergotropy from
a full rank random quantum state in _DN_ obtained by partial tracing randomly selected pure state in a composite
Hilbert space of dimension of _NN_ _[′]_, in the limit _N_ _[′]_ _→∞_ . We numerically calculate the ergotropy of random quantum
states (obtained as mentioned previously) with increasing _N_ _[′]_, for a fixed Hamiltonian _H_ . The results, shown in Fig.2,
indicate that the upper bound on Erg( _ρ_ ) from Theorem 1, becomes increasingly tight as the ratio _N/N_ _[′]_ decreases.
One expects that this limitation can be overcome given access to multiple copies of the unknown state _ρ_ . In the
next section, we consider a different black box setting and rigorously quantify the number of samples of _ρ_ required to
quantify the amount of work that can be extracted from it.


**B.** **Extracting work from multiple copies of** _ρ_


In this section, we consider a different setting: each query to a black box returns the same fixed but unknown state
_ρ_ . By allowing multiple queries, one can obtain multiple copies of this state. Crucially, unlike the single-copy scenario
discussed earlier, this multi-copy black-box model does not involve sampling from a random ensemble: the state _ρ_ is
fixed (though unknown) throughout. We show that, in this setting, the observational ergotropy, which quantifies the
extractable work, can be estimated in a sample-efficient manner using a quantum computer.
As outlined in Ref. [65], this quantity can be obtained via the following two-stage process: (i) Firstly, perform
projective measurement with mutually orthogonal operators _{Pi}i_ _[M]_ =1 [such that][ �] _i_ _[P][i]_ [ =][ I] _[N]_ [, and compute] _[ p][i]_ [ = Tr[] _[P][i][ρ]_ [],]

for each _i_ . This step essentially decomposes the full space into _M_ blocks of orthogonal support, i.e. _⊕i_ _[M]_ =1 _[H][i]_ [, where]
_i_ = _Pi_ _N_ _Pi_ . We assume that the dimension of each block is 2 _[r]_, where _r_ = log2( _N/M_ ). (ii) Secondly, randomize
_H_ _H_


4



|.6|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|
|---|---|---|---|---|---|---|---|---|
|1<br>.2<br>.3<br>.4<br>.5<br>6|||||||||
|1<br>.2<br>.3<br>.4<br>.5<br>6|||||||||
|1<br>.2<br>.3<br>.4<br>.5<br>6|||||||||
|1<br>.2<br>.3<br>.4<br>.5<br>6|||||||||
|1<br>.2<br>.3<br>.4<br>.5<br>6|||||||||
|10<br><br>|||||||||
|10<br><br>||5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|


(b) N=3

|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|
|---|---|---|---|---|---|---|---|
|||||||||
|||||||||
|||||||||
|||||||||
|||||||||
|||||||||
|10<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|



(d) N=5





|.4<br>.3<br>.2<br>.1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|
|---|---|---|---|---|---|---|---|---|
|1<br>.2<br>.3<br>.4|||||||||
|1<br>.2<br>.3<br>.4|||||||||
|1<br>.2<br>.3<br>.4|||||||||
|10<br><br>.0<br>|||||||||
|10<br><br>.0<br>||5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|


(a) N=2

|.6<br>.5<br>.4<br>.3<br>.2<br>.1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|
|---|---|---|---|---|---|---|---|---|
|1<br>.2<br>.3<br>.4<br>.5<br>.6|||||||||
|1<br>.2<br>.3<br>.4<br>.5<br>.6|||||||||
|1<br>.2<br>.3<br>.4<br>.5<br>.6|||||||||
|1<br>.2<br>.3<br>.4<br>.5<br>.6|||||||||
|10<br><br>|10<br><br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|5<br>20<br>25<br>30<br>35<br>40<br>45<br>50<br>|



(c) N=4





Fig. 2. Ergotropy of random states. We plot the ergotropy of random quantum states (generated by partial tracing _NN_ _[′]_ dimensional Haar random pure states) for _N_ = 2 (Fig. 2a), _N_ = 3 (Fig. 2b), _N_ = 4 (Fig. 2c), and _N_ = 5 (Fig. 2d), as a
function of _N_ _[′]_ . The Hamiltonian is considered to be _H_ = [�] _i_ _[N]_ =1 _[h][i][/N]_ [, where] _[ h][i]_ [ =] _[ |]_ [1] _[⟩⟨]_ [1] _[|]_ [, and] _[ ∥][H][∥]_ [= 1. For each] _[ N]_ [ and] _[ N][ ′]_ [,]
we sample several random density matrices and compute the ergotropy for each of them (indicated by the cluster of points for
each _N, N_ _[′]_ ). The red curve in each figure is a plot of the function ~~�~~ _N/N_ _[′]_, which is an upper bound on ergotropy of random

states with high probability as established in Theorem 1. We find that our upper bound becomes increasingly tighter as the
ratio _N/N_ _[′]_ decreases.


each block completely by applying a direct sum of Haar random unitaries to convert the still unknown state from the
previous step into a known state � _ρ_ . That is,




  -  -  - ��  -  - ��
_ρ_ - = _dµ_ Haar _i_ =1 _[V]_ [�] _[i]_ _i_ =1 _[V]_ [�] _[i]_ _ρ_ _i_ =1 _[V]_ [�] _[ †]_ _i_ _,_ (3)

_V_   - _i∼U_ (2 _r_ ) _⊕_ _[M]_ _×_ _⊕_ _[M]_ _⊕_ _[M]_




                              -                              where _dµ_ Haar is the normalized Haar measure, which factorizes nicely as _dµ_ Haar _i_ =1 _[V]_ [�] _[i]_ = [�]
_⊕_ _[M]_




   -    _i_ _[dµ]_ [Haar] _V_ - _i_ . These



steps allow us to compute the observational ergotropy of the original unknown state _ρ_, which is defined as (see Sec. III
and Refs. [65, 67, 68])




                          -                          - ��
Ergobs ( _ρ_ ) = Tr _H_ _ρ −_ _U_ gl � _ρ U_ gl _[†]_ _,_ (4)

where _U_ gl is a global unitary implementing a basis change from the basis of space _⊕i_ _[M]_ =1 _[H][i]_ [ to the eigenbasis of] _[ H]_
and a permutation that orders the _pi_ ’s in non-increasing order. This has the effect of constructing the passive state
with respect to � _ρ_, analogous to the role of the optimal unitary in the expression for ergotropy. As there is complete


5



knowledge of _H_, all that is required to construct _U_ gl are the _pi_ ’s obtained from the first stage. Since � _ρ_ is obtained by
extracting partial information from the original state, the quantity Ergobs( _ρ_ ) provides a lower bound on Erg( _ρ_ ), with
the two quantities matching when _ρ_ is completely known. In fact, in Appendix C, we rigorously derive a non-trivial
lower bound on the deviation between these two quantities.
We first quantify the number of samples of _ρ_ required to obtain an estimate � _pi_ of _pi_ = Tr[ _Piρ_ ], for all _i ∈_

[1 _, M_ ]. Performing a projective measurement results in outcome _i_ with probability _pi_ . The strategy is to make _T_ [�]
repeated projective measurements, each time with a fresh copy of _ρ_ : for the _j_ [th] iteration, the measurement outcome
_i_ corresponds to an i.i.d. random variable _Yi_ [(] _[j]_ [)] whose expectation value is _pi_ . So, for _i_ [1 _, M_ ], we take the sample

mean of each of the _T_ [�] runs, i.e. _p_ - _i_ = [�] _Tj_ [�] =1 _[Y]_ _i_ [ (] _[j]_ [)] _/T_ [�] . Then, in Sec. II B we prove that Hoeffding’s inequality [ _∈_ 69]

ensures that _|p_ - _i −_ _pi| ≤_ _ε_, with a failure probability of at most _δ/M_, as long as _T_ [�] is large enough. That is, if _Gi_ is
the event that _p_ - _i_ _pi_ _> ε_, then Pr[ _Gi_ ] _δ/M_ . Finally, using the union-bound, we derive that only _T_ [�] samples are
sufficient to ensure that for every _|_ _−_ _|_ _i_ [1 _, M ≤_ ], _p_ - _i_ _pi_ _ε_, with a probability of at least 1 _δ_ .
Observe that the construction of the global unitary _∈_ _|_ _−_ _| ≤ U_ gl necessitates arranging the set of estimates _−_ _{p_  - _i}i_ _[M]_ =1 [in non-]
increasing order. That is, the accuracy with which these estimates approximate each _pi_ should be such that they
leave this ordering unaltered, i.e., _pi_ _pj_ 0 should also imply � _pi_ _p_ - _j_ 0, for all pairs of _i, j_ [1 _, M_ ]. Thus, if
_−_ _≥_ _−_ _≥_ _∈_

∆:= min
_i,j_

_[{|][p][i][ −]_ _[p][j][|]_ [ :] _[ p][i][ ̸]_ [=] _[ p][j][}][,]_

this is ensured by choosing any _ε <_ ∆ _/_ 2. Despite requiring only a few measurements, this estimation scheme provides
sufficient information regarding _ρ_ to enable the construction of _U_ gl. Formally, we prove the following lemma in
Sec. IV B:

**Lemma 1.** _The number_ _T_ [�] _of samples of ρ required to estimate M probabilities upto an error_ ∆ _/_ 3 _, i.e.,_ _p_ - _i_ _pi_ ∆ _/_ 3
_for all i ∈_ [ _M_ ] _with failure probability at most δ, is_ _|_ _−_ _| ≤_




  log( _M/δ_ )
_T_ - = _O_





_._ (5)



∆ [2]



Having estimated every � _pi_ with sufficient accuracy in a sample-efficient manner, we are now in a position to
estimate observational ergotropy for unknown state _ρ_ . The central idea is to develop an easy-to-implement, efficient,
randomized scheme that iteratively estimates the desired quantity. This is given by Protocol 1. Indeed, the outcome
of this randomized protocol is a number that approximates the observational ergotropy to _ε_ -additive accuracy, with
a success probability of at least 1 _−_ _δ_ . We outline the details of this scheme.


**Protocol 1:** `Work Extraction from unknown` _ρ_


1. With probability 1 _/_ 2, measure _H_ on the state _ρ_ .


2. With probability 1 _/_ 2, execute steps ( _a_ ) _−_ ( _c_ ).


(a) Measure _ρ_ in the basis spanned by the projectors _{Pi}_ _[M]_ _i_ =1 [and ignore the outcomes to obtain the]
post-measurement state ¯ _ρ_ .


(b) Sample a unitary _Ur_ uniformly at random from the _r_ -qubit Pauli group, where _r_ = log2( _N/M_ ), and apply the
unitary _U_ gl(I _M ⊗_ _Ur_ ) to ¯ _ρ_ to obtain


_ρ_ _[′]_ = _U_ gl(I _M ⊗_ _Ur_ )¯ _ρ_ (I _M ⊗_ _Ur_ ) _[†]_ _U_ gl _[†]_


(c) Measure _−H_ in the state obtained after Step 2(b).


3. Store the outcome of the measurement of the _j_ [th] iteration into _µj_ .


4. Repeat Steps 1 and 2, a total of _T_ times.

5. Output _µ_ = [2]   - _Tj_ =1 _[µ][j]_ [.]

_T_


As the outcome of the measurement on _ρ_ is ignored, Step 2(a) naturally coarse-grains the state, on average. Note
that each _Pi_ acts on the whole Hilbert space _HN_, but has support only on _Hi_ . If _ρii_ denotes the projection of _ρ_ on
the support of _Pi_, the post-measurement state ¯ _ρ_, averaged over all outcomes, is




- _M_

_ρii._

_i_ =1



E[¯ _ρ_ ] =




- _M_

_PiρPi_ =

_i_ =1


6


This is a block-diagonal state, where each block corresponds to the restriction of _ρ_ to _i_ . To obtain the desired
coarse-grained state � _ρ_ (as defined in Eq. (3)), it suffices to apply a direct sum of Haar-random unitaries to _H_ E[¯ _ρ_ ].
However, doing so efficiently is essential for preserving the overall sample complexity of the protocol.
To achieve this, Step 2(b) samples a single unitary _Ur_ uniformly at random from the _r_ -qubit Pauli group _P_ ( _r_ ),
which forms an exact unitary 1-design consisting of _L_ = 4 _[r]_ [+1] elements, denoted as _U_ [�] 1 _, . . .,_ _U_ [�] _L_ [70]. The operation
I _M_ Let _⊗_ _ρUr_ _[′′]_ =denote the resulting state after this application. Then, averaging over the randomness in _⊕i_ _[M]_ =1 _[U][r]_ [ then applies the same unitary] _[ U][r]_ [ independently to each block of the post-measurement state ¯] _Ur_, we find _[ρ]_ [.]




1

_L_









E _Ur∼P_ ( _r_ )[ _ρ_ _[′′]_ ] =


=




- _M_


_j_ =1


- _M_


_j_ =1



_UρjjU_ _[†]_ d _µ_ ( _U_ ) = � _ρ,_ (6)
_U_ _∼_ U(2 _[r]_ )




- _L_

_U_ ˜ _ℓρjj_ ˜ _Uℓ_ _[†]_
_ℓ_ =1



where the second equality follows because the Pauli group is a unitary 1-design.
As discussed earlier, applying the global unitary _U_ gl to the coarse-grained state � _ρ_ produces the passive state
associated with � _ρ_ . Therefore, by linearity of expectation, the average output of Step 2(b) of Protocol 1 is


E[ _ρ_ _[′]_ ] = _U_ gl E _Ur∼P_ ( _r_ )[ _ρ_ _[′′]_ ] _U_ gl _[†]_ [=] _[ U]_ [gl][ �] _[ρ U]_ gl _[ †]_ _[.]_


In Protocol 1, Step 1 involves performing a POVM measurement of the Hamiltonian _H_ on the state _ρ_ . The measurement outcome is a random variable taking values in the interval [ _−∥H∥,_ + _∥H∥_ ], with expectation value given by
Tr[ _Hρ_ ]. Similarly, the outcome of Step 2(c), which measures _−H_ on the output state _ρ_ _[′]_, is also a random variable,
with expected value

                     -                      Tr[ _−H_ E[ _ρ_ _[′]_ ]] = Tr _−H U_ glE _U_ _∼P_ ( _r_ )[ _ρ_ _[′′]_ ] _U_ gl _[†]_ = _−_ Tr[ _H U_ gl _ρU_              - gl _[†]_ []] _[.]_


As both these measurements are performed independently with probability 1 _/_ 2, the outcome of the _j_ [th] run of Steps
1 and 2 of Protocol 1 is a random variable _µj_ such that

2E[ _µj_ ] = Tr[ _H_ ( _ρ −_ _U_ gl _ρU_                  - gl _[†]_ [)] = Erg] obs [(] _[ρ]_ [)] _[ .]_ (7)

Since these steps in Protocol 1 are executed a total of _T_ times, the outcome is a sequence of i.i.d. random variables
_{µj}j_ _[T]_ =1 [. Finally, in Step 5, the overall output of our method is twice the mean] _[ µ]_ [ of these random variables. We find]
_T_ for which the sample mean _µ_ is an _ε_ -accurate estimate of the actual expectation value (Ergobs ( _ρ_ )) via Hoeffding’s
inequality [69], which implies for any _ε >_ 0,

                               -                               Pr [ _|µ −_ Ergobs ( _ρ_ ) _| ≥_ _ε_ ] _≤_ 2 exp _−Tε_ [2] _∥H∥_ _[−]_ [2] _/_ 8 _._

Thus, _µ_ approximates observational ergotropy to _ε_ -additive accuracy, i.e., _|µ −_ Ergobs ( _ρ_ ) _| ≤_ _ε_, with probability at
least 1 _−_ _δ_, as long as







_T_ = _O_




_∥H∥_ [2] log (1 _/δ_ )



_ε_ [2]



_._ (8)



Overall, the probability estimation stage (See Lemma 1) and the work estimation stage combined require




    _H_ 2 log( _M/δ_ )
_T_ - + _T_ = _O_ _∥_ _∥_

_ε_ [2]





(9)



samples (equivalently, as many measurements) of _ρ_ and succeeds with probability (1 _−_ _δ_ ) [2] . Note that the overall
sample complexity depends only logarithmically on the dimension of the system.
In Fig. 3, we numerically demonstrate how Protocol 1 estimates the observational ergotropy. We plot this quantity
as a function of samples of the unknown state. We consider a 3-qubit system described by the Heisenberg XXX model
Hamiltonian [71]. For _ε_ = 10 _[−]_ [2], _δ_ = 10 _[−]_ [4], observe that Protocol 1 requires roughly 1 _._ 5 _/ε_ [2] samples to estimate the
desired quantity. To help illustrate our findings, we provide other examples in Sec. A and Sec. B of the Appendix.
Our method can also be seen as a randomized quantum algorithm to estimate the amount of extractable work
from an unknown state. Since the projectors _Pi_ are easily implementable, both stages can be implemented on a


7


Fig. 3. Work extraction from translationally invariant Heisenberg XXX model. The Hamiltonian for _n_ spins is given by
_Hn_ = _−_ [�] _[n]_ _j_ =1 _[σ]_ _z_ [(] _[j]_ [)] _⊗_ _σz_ [(] _[j]_ [+1)] _−_ [�] _[n]_ _j_ =1 _[σ]_ _x_ [(] _[j]_ [)] (with the periodic boundary condition), where _σz_ [(] _[j]_ [)] and _σx_ [(] _[j]_ [)] for Pauli- _Z_ and Pauli_X_ matrices for the _j_ th spin, respectively. For _n_ = 3, let the spins be in the state _ρ_ = _|_ 11 _⟩⟨_ 11 _| ⊗_ I2 _/_ 4 + [1] 2 _[|][ψ][⟩⟨][ψ][|]_ [, where]

_|ψ⟩_ = ~~_√_~~ 1

3 [(] _[−|]_ [011] _[⟩]_ [+] _[ |]_ [100] _[⟩]_ [+] _[ |]_ [101] _[⟩]_ [). We have Erg (] _[ρ]_ [)] _[ ≈]_ [2] _[.]_ [53 while Erg][obs][ (] _[ρ]_ [)] _[ ≈]_ [1] _[.]_ [37. To estimate the latter quantity, we perform]
projective measurement _{Li}_ [4] _i_ =1 [with] _[ L]_ [1] [=] _[ |]_ [00] _[⟩⟨]_ [00] _[| ⊗]_ [I][4][,] _[ L]_ [2] [=] _[ |]_ [01] _[⟩⟨]_ [01] _[| ⊗]_ [I][4][,] _[ L]_ [3] [=] _[ |]_ [10] _[⟩⟨]_ [10] _[| ⊗]_ [I][4][, and] _[ L]_ [4] [=] _[ |]_ [11] _[⟩⟨]_ [11] _[| ⊗]_ [I][4][. The]
figure shows how Protocol 1 approximates Ergobs ( _ρ_ ) as a function of the number of samples _T_ . For _T_ as in Eq. (8), we obtain
an _ε_ -accurate estimate of Ergobs ( _ρ_ ) for _ε_ = 10 _[−]_ [2], and failure probability _δ_ = 10 _[−]_ [4] .



quantum computer requiring _T_ [�] + _T_ independent iterations. Interestingly, the quantum algorithm is qubit efficient,
i.e., it requires no ancilla qubits and can potentially be implemented in the intermediate term. If _τg_ is the circuit
depth of the global unitary _U_ gl, then the circuit depth of each run is simply _O_ ( _τg_ ), as it requires constant circuit
depth to implement a randomly sampled unitary from the _r_ -qubit Pauli group (in Step 2(b)). The precise depth
of constructing _U_ gl is instance-specific: it depends on _ρ_ and the choice of the projective measurement _{Pi}_, which
determines the amount of coarse-graining. Note that this unitary implements (i) a basis change from the basis spanned
by the projectors to the eigenbasis of the Hamiltonian, followed by (ii) a sequence of permutations required to arrange
the estimated � _pi_ in non-increasing order. It is possible to implement (i) as _H_ is completely known, while the set of
projectors _Pi_ is chosen by the user. Also, (ii) can be efficiently executed [72], with the gate depth depending on the
_{_ _}_
number of permutations required to be implemented.
Our algorithm can be made more efficient in physically relevant settings. Observe that our scheme performs a
measurement of _H_ on _ρ_, which might be difficult to implement. However, consider any _H_ = [�] _j_ _[h][j]_ [Λ] _[j]_ [, which is a]

linear combination of _n_ -qubit Pauli strings Λ _j_ with total weight _h_ = [�] _j_

physics [71], instead of measuring _H_ ( _−H_ ) in Step 1 (Step 2(c)) in each run of our algorithm, we can independently _[|][h][j][|]_ [. For such Hamiltonians, ubiquitous across]
sample a Pauli term Λ according to the ensemble _{hi/h,_ Λ _i}i_ and measure Λ, and _−_ Λ, respectively. It suffices to
adopt this simple randomized measurement scheme, which enables the measurement of a single local Pauli operator in
each run. In Sec. IV D, we prove that the modified protocol (See Protocol 2 in Sec. II B) outputs _µ_ which approximates
Ergobs ( _ρ_ ) to _ε_ -additive accuracy, with probability at least 1 _−_ _δ_ as long as _T_ = _O_ ( _h_ [2] log(1 _/δ_ ) _/ε_ [2] ).


**C.** **Robustness of observational ergotropy**


As described earlier, estimating observational ergotropy involves a two-step process. Given an unknown quantum
state _ρ_ and a set of orthogonal projectors _{Pi}i_ _[M]_ =1 [, satisfying][ �] _i_ _[P][i]_ [ =][ I] _[N]_ [, our algorithm first estimates] _[ p][i]_ [ = Tr[] _[P][i][ρ]_ [],]

for all _i ∈_ [1 _, M_ ], up to _ε_ -additive accuracy. That is, we obtain estimates � _pi_ such that

_p_                    - _i_ _pi_ max
_|_ _−_ _| ≤_ _i∈_ [1 _,M_ ] _[|][p]_ [�] _[i][ −]_ _[p][i][|]_ [ =:] _[ ε,]_

for all _i ∈_ [1 _, M_ ]. This estimation step is critical because the construction of the global unitary _U_ gl relies on the correct
ordering of the probabilities _pi_ . In fact, these probabilities need to be arranged in a nonincreasing order. Therefore,
_{_ _}_
to construct the correct _U_ gl, it is essential that the estimation accuracy preserves this ordering: for all _i, j_ [1 _, M_ ], if
_∈_
_pi_ _pj_, then it must also hold that � _pi_ _p_ - _j_ . In Section II B, we show that this ordering is guaranteed to be preserved
if the estimation error satisfies _≥_ _ε <_ ∆ _≥/_ 2, where ∆= min _i,j_ _pi_ _pj_ : _pi_ = _pj_ . However, in realistic black-box
_{|_ _−_ _|_ _̸_ _}_


8


scenarios, the true probabilities _pi_ are unknown, and so is the minimum gap ∆. As a result, the experimentalist
_{_ _}_
must choose a precision _ε_ without knowing whether it suffices to preserve the correct ordering. If _ε_ is too large, the
estimated ordering may differ from the true ordering, resulting in the use of an incorrect global unitary _U_ [�] gl instead
of _U_ gl. In such cases, Protocol 1 estimates a _guessed observational ergotropy_, defined as

                          -                          - ��
Erg� obs( _ρ_ ) = Tr _H_ _ρ_ _U_ gl � _ρ_ _U_ [�] gl _[†]_ _,_ (10)
_−_ [�]


where � _ρ_ is the coarse-grained state (see Eq. (3)). In what follows, we derive an upper bound on the deviation between
the guessed and the true values of observational ergotropy.
To this end, let us redefine the coarse-grained state



_ρ_ - =




- _M_


_i_ =1



_piPi_

_d_ _[,]_



such thatthe eigenvalues of the Hamiltonian (ordered nondecreasingly) are _p_ 1 _≥_ _p_ 2 _≥· · · ≥_ _pM_ . Here _pi_ are the _true_ block probabilities, arranged in a non-decreasing order. Suppose _E_ 1 _E_ 2 _EN_ . Then, we partition this
ordered list of eigenvalues into _M_ contiguous blocks _A_ 1 _, A_ 2 _,_ _, AM_, each of size _≤_ _≤· · · ≤ d_ = 2 _[r]_, such that
_· · ·_

_Aj_ = _{E_ ( _j−_ 1) _d_ +1 _, E_ ( _j−_ 1) _d_ +2 _, · · ·, Ejd}._

Each block _Aj_ defines a projector _Pj_ onto the span of the eigenstates corresponding to the eigenvalues in _Aj_ . Then,
the average energy of block _Aj_ is defined as



_Ej_ = [1]

_d_





_e._ (11)

_e∈Aj_



Thus, the set _pj, Ej_ provides the coarse-grained description of _ρ_ in the energy eigenbasis, which serves as the input
_{_ _}_
for constructing the global unitary _U_ gl, and for defining the true observational ergotropy.
Now the experimentalist obtains the _estimated_ block probabilities � _p_ 1 _, · · ·,_  - _pM_, i.e. each � _pi_ is associated with the
block labeled by _Pi_ . Let _π_ be the permutation that sorts these estimated probabilities:


_p_                     - _π_ (1) _p_                     - _π_ (2)                     - _pπ_ ( _M_ ) _._
_≥_ _≥· · ·_

Consequently, the global unitary used by the experimentalist is constructed from the sorted estimated probabilities
as _U_ [�] gl, which maps the eigenvectors of _Pπ_ ( _i_ ) to the energy block _Ai_ . Let _pπ_ ( _i_ ) denote the _true_ probability of the block
_Pπ_ ( _i_ ) which the experimentalist believes to be the _i_ -th largest. Then, we prove the following lemma.

**Lemma 2.** _For any density operator ρ, let pi_ = Tr[ _ρPi_ ] _for i ∈_ [1 _, M_ ] _be the true measurement probabilities and_
_{p_ - _i}i_ _[M]_ =1 _[be the estimated probabilities. Let][ π][ be a permutation on][ M][ objects such that for][ i][ ∈]_ [[1] _[, M][ −]_ [1]] _[,]_

_p_                       - _π_ ( _i_ ) _p_                       - _π_ ( _i_ +1) _._
_≥_

_Then,_




- _M_


_j_ =1




- _M_


_j_ =1



����Ergobs( _ρ_ ) _−_ Ergobs ( _ρ_ )��� =


_where Ej is defined as in Eq._ (11) _._



������




- _pj_ _pπ_ ( _j_ )
_−_



_Ej_



������ _≤∥H∥_



�� _pj_ _pπ_ ( _j_ )�� _,_ (12)
_−_



The proof of Lemma 2 is provided in Sec. IV C, while in Appendix E, we provide an example that complements our
theoretical findings. The lemma illustrates how inaccuracies in estimating the block probabilities directly propagate
into deviations of the _guessed observational ergotropy_ from the true value. Specifically, the deviation is governed
solely by the mismatch between the true probabilities and their permuted counterparts under the estimated ordering,
weighted by the block energies. This makes clear that the “penalty” for implementing an incorrect global unitary is
controlled: the discrepancy can never exceed the operator norm of the Hamiltonian multiplied by the total probability
mass misassigned due to sorting errors. Consequently, even when the estimation precision _ε_ is too coarse to guarantee
the correct ordering, one can still obtain a rigorous upper bound on the possible loss (or gain) in the extracted work.
Importantly, the lemma also shows that the _guessed observational ergotropy_ is not necessarily smaller than the true
value. Instead, it provides an explicit quantification of the worst-case deviation that an experimentalist should expect,
thereby shedding light on the robustness of our protocol under imperfect probability estimation.


9


**III.** **PRELIMINARIES**


In this section, we introduce standard notation, definitions, and facts that have been utilized to derive our main
results.
Recall that _N_ = 2 _[n]_, the Hilbert space of _n_ qubits is denoted by _HN_ and the set of density operators, trace one
positive semi-definite matrices, on _HN_ is denoted by _DN_ . Further, define [ _s_ ] = _{_ 1 _, · · ·, s}_ . The Hamiltonian of the _n_
qubit system, denoted by _H_, satisfies




- _s_

_EaQa,_ (13)

_a_ =1




- _ga_

_Ea_ ; _κ_ _Ea_ ; _κ_ :=
_|_ _⟩⟨_ _|_
_κ_ =1



_H_ =




- _s_

_Ea_

_a_ =1



where _Qa_ := [�] _[g]_ _κ_ _[a]_ =1
energy eigenvalue� _s_ _E_ _[|]_ _a_ _[E]_, and _[a]_ [;] _[ κ][⟩⟨]_ _E_ _[E]_ _a_ _[a]_ _< E_ [;] _[ κ][|]_ [ is the projector onto the eigensubspace of energy] _a_ +1 for all _a ∈_ [ _s −_ 1]. _s_ is the total number of distinct eigenvalues of _[ E][a]_ [,] _[ g][a]_ [ is the degeneracy of the] _H_ and
_a_ =1 _[g][a]_ [ =] _[ N]_ [. Let us further define an ordering on the eigenstates, for convenience, as follows:] _[ |][E]_ [1][; 1] _[⟩≤· · · ≤]_
_E_ 1; _g_ 1 _Es_ ; 1 _Es_ ; _gs_ . Denote by ( _ϕ_ 1 _,_ _,_ _ϕg_ 1 _,_ _,_ _ϕN_ _−gs_ +1 _,_ _,_ _ϕN_ ) the ordered tuple
_|_ _⟩≤· · · ≤|_ _⟩≤· · · ≤|_ _⟩_ _|_ _⟩_ _· · ·_ _|_ _⟩_ _· · ·_ _|_ _⟩_ _· · ·_ _|_ _⟩_
�of eigenvectors arranged in order of nondecreasing energy. Here we have partitioned _s_ _N_ as _{g_ 1 _, · · ·, gs}_ such that
_a_ =1 _[g][a]_ [ =] _[ N]_ [. In particular, the set]

                    - ��

���� _ϕ_ 1+� _la−_ =11 _[g][a]_ _, · · ·,_ ��� _ϕ_                                     - _la_ =1 _[g][a]_


spans the eigenspace of energy _El_, where _l_ [ _s_ ].
_∈_

**Ergotropy:** Let us consider a quantum system of _n_ qubits with the Hamiltonian _H_ (Eq. (13)) in an arbitrary
state _ρ_ _N_ . Note that the extractable work is a path/process-dependent quantity; the extractable work from any
_∈D_
quantum system can be defined in multiple ways depending on the quantum operations used for work extraction
(see, e.g., Refs . [22, 25, 38, 73]). Ergotropy captures the notion of extractable work under unitary operations. As
mentioned previously, for a quantum system in a state _ρ_ [38, 40],

                                -                                Erg ( _ρ_ ) = max _H_ _ρ_ _UρU_ _[†]_ [��] _,_ (14)
_U_ _∈_ U( _N_ ) [Tr] _−_


where U( _N_ ) is the group of _N_ _N_ unitary matrices. Let the spectral decomposition of _ρ_ be given by _ρ_ =

- _N_ _×_
_i_ =1 _[λ][i][ |][λ][i][⟩⟨][λ][i][|]_ [, where] _[ λ][i][ ≥]_ [0 and][ �] _i_ _[N]_ =1 _[λ][i]_ [ = 1. Let] _[ π]_ [ be the permutation of] _[ N]_ [ objects such that] _[ λ][π]_ [(] _[i]_ [)] _[ ≥]_ _[λ][π]_ [(] _[j]_ [)][ for]
all 1 _i_ _j_ _N_ . Then the unitary matrix _V_ gl U( _N_ ) achieving the maximum in Eq. (14) can be written as
_≤_ _≤_ _≤_ _∈_



��
_λπ_ ( _κ_ + [�] _al_ =1 _−_ 1 _[g][l]_ [)]



��� _._ (15)



��� _ϕκ_ +� _al_ =1 _−_ 1 _[g][l]_




- _ga_


_κ_ =1



_V_ gl =




- _s_


_a_ =1



Thus, ergotropy of the state _ρ_ can be written as

                          -                          - ��
Erg ( _ρ_ ) = Tr _H_ _ρ_ _V_ gl _ρV_ gl _[†]_ _._ (16)
_−_

For a nondegenerate Hamiltonian _H_ = [�] _[N]_ _i_ =1 _[E][i][ |][E][i][⟩⟨][E][i][|]_ [ (with] _[ E]_ [1] _[ <][ · · ·][ < E][N]_ [), the above expression simplifies to]



Erg ( _ρ_ ) =




- _N_ - 
_Eiλj_ _λj_ _Ei_ _δj,π_ ( _i_ ) _._ (17)
_| ⟨_ _|_ _⟩|_ [2] _−_
_i,j_ =1



**Observational ergotropy:** For a physical system described by Hamiltonian _H_ in _N_, the observational ergotropy
_H_
of a state _ρ_ _N_ is defined with respect to a measurement setting. Consider the projective measurement _Pi_ _i_ =1
_∈D_ _{_ _}_ _[M]_
described by the projectors _Pi_ such that [�] _[M]_ _i_ =1 _[P][i]_ [ =][ I] _[N]_ [, and] _[ H][i]_ [ =] _[ P][i][H][N]_ _[P][i]_ [, for all] _[ i][ ∈]_ [[] _[M]_ []. Then, the observational]
ergotropy of _ρ_ is defined as

                                    Ergobs ( _ρ_ ) = Tr [ _Hρ_ ] min _HU_                    - _ρ U_ _[†]_ [�]
_−_ _U_ _∈_ U( _N_ ) [Tr]

                             -                             = Tr [ _Hρ_ ] Tr _HU_ gl � _ρ U_ gl _[†]_ _,_ (18)
_−_


10

where � _ρ_ = [�] _[M]_ _i_ =1 _[p][i][P][i][/]_ [Tr[] _[P][i]_ [], with] _[ p][i]_ [ = Tr[] _[ρP][i]_ [] for] _[ i][ ∈]_ [[] _[M]_ []. If Tr[] _[P][i]_ [] is the same for all] _[ i]_ [,] _[ U]_ [gl][ is a global unitary that]
implements (i) a basis change from _⊕i_ _[M]_ =1 _[H][i]_ [ to the eigenbasis of] _[ H]_ [, followed by (ii) a permutation that orders the] _[ p][i]_ [’s]
in non-increasing order. We refer the readers to Refs. [65, 67, 68] for bounds on observational ergotropy and other
details.


**Induced measures on the space of mixed states:** The notion of random states requires a probability measure
to be associated with the set of states. For an _N_ -dimensional system with Hilbert space _N_, a random pure state
_H_
_ψ_ may be written as _ψ_ = _U_ _ψ_ 0 _N_, where _ψ_ 0 is a fixed pure state and _U_ is an _N_ _N_ unitary matrix chosen
_|_ _⟩_ _|_ _⟩_ _|_ _⟩∈H_ _|_ _⟩_ _×_
uniformly from the unique Haar measure _µ_ Haar( _U_ ) on the unitary group U( _N_ ) (see e.g. Refs. [74, 75]). However,
the set _DN_ of density matrices (nonnegative and trace one _N × N_ matrices) does not admit any unique probability
measure on it, and in fact, there exist several inequivalent measures on _N_ . For example, one may generate a random
density matrixmeasure on the pure states in _ρ ∈DN_ by partial tracing the purifications _N_ _N ′_, where _N_ _[′]_ _N_ . This procedure induces the probability measure _|ψ⟩∈HN ⊗H D_ _N_ _′_ chosen uniformly from the unique Haar _dνN,N_ _′_ (Λ)
on the eigenvalues _λ_ 1 _, . . ., λN H_ of _⊗H ρ_, which is given by [ _≥_ 75, 76]
_{_ _}_












  - _N_
 ∆( _λ_ ) _λ_ _[N]_ _j_ _[′][−][N]_ _dλj,_ (19)
_|_ _|_ [2]

_j_ =1




- _N_

_λj_

_j_ =1



_dνN,N_ _[′]_ (Λ) := _CN,N_ _[′]_ _δ_



1 _−_



where _CN,N_ _′_ is the normalization constant and ∆( _λ_ ) = [�] 1⩽ _i<j_ ⩽ _N_ [(] _[λ][i][ −]_ _[λ][j]_ [). The eigenvectors of] _[ ρ]_ [ are distributed via]

the unique Haar measure on U( _N_ ). The normalized probability measure _µN,N_ _′_ over _DN_ is then given by

_dµN,N_ _′_ ( _ρ_ ) = _dνN,N_ _′_ (Λ) _dµ_ Haar( _U_ ) _,_ (20)
_×_

where _ρ_ = _U_ Λ _U_ _[†]_, _dνN,N_ _[′]_ (Λ) _dνN,N_ _[′]_ ( _λ_ 1 _, . . ., λN_ ).
_≡_
Another way to obtain a probability measure on _DN_ is to note that any density matrix _ρ_, using the spectral
decomposition theorem, can be written as _ρ_ = _U_ Λ _U_ _[†]_, where _U_ is an _N_ _N_ unitary matrix and Λ = diag ( _λ_ 1 _, . . ., λN_ )
_×_
is a diagonal matrix with nonnegative real entries that sum to one. Then assuming that the distributions of eigenvalues
and eigenvectors of _ρ ∈DN_ are independent, one may propose a probability measure _µ_ on _DN_ as _µ_ ( _ρ_ ) = _ν_ (Λ) _×_
_µ_ Haar( _U_ ), where the measure _µ_ Haar( _U_ ) is the unique Haar measure on U( _N_ ) and measure _ν_ (Λ) defines the distribution
of eigenvalues (see e.g. Refs. [75, 77]). The measure _ν_ (Λ) is not unique and one may pick it based on different metrics
on the Hilbert space [78]. In particular, for Hilbert-Schmidt metric, _dν_ (Λ) coincides with _dνN,N_ (Λ) given in Eq. (20)

[75]. In this work, we will focus only on the partial trace induced measure on the set of density matrices.

**Lipschitz continuity:** Let _X_ and _Y_ be two metric spaces with metrics _dX_ and _dY_, respectively and _h_ : _X �→_ _Y_
be a function on _X_ . Then _h_ is said to be a Lipschitz continuous function with the Lipschitz constant _L_ if for any
_x, x_ _[′]_ _∈_ _X_

_dY_ ( _h_ ( _x_ ) _−_ _h_ ( _x_ _[′]_ )) _≤_ _L dX_ ( _x, x_ _[′]_ ) _._ (21)

Note that any other constant _L_ _[′]_ _≥_ _L_ is also a valid Lipschitz constant [64, 79, 80].

**Concentration of measure phenomenon:** Certain smooth functions defined over measurable vector spaces are
known to take values close to their average values almost surely [64]. This phenomenon is collectively referred to
as the concentration of measure phenomenon and is expressed via various inequalities bounding the probability of
departure of the functional values from the average value. Logarithmic Sobolev inequalities together with the Herbst
argument (also called the “entropy method”) are very general techniques to prove such inequalities [81]. A particular
form of the concentration inequality suitable for our exposition is stated as the following lemma [64, 79, 82, 83].

**Lemma 3** _the Hilbert-Schmidt metric. Let_ (Concentration of measure phenomenon) _h_ : U( _k_ ) _�→_ R _be a real valued Lipschitz continuous function with a Lipschitz constant_ **.** _Let_ U( _k_ ) _be the group of k × k unitary matrices equipped with_
_L. Then for any γ >_ 0 _, we have_




               
  -  Pr _h_ ( _U_ ) _>_ EU( _k_ )[ _h_ ( _U_ )] + _γ_ _≤_ exp _−_ 12 _[kγ]_ _L_ [2][2]


**IV.** **METHODS**





_._ (22)



Having outlined the necessary preliminaries, we are now in a position to describe the techniques used to derive the
main results in Sec. II. We begin with a detailed derivation of Theorem 1.


11


**A.** **Proof of Theorem 1: Concentration of ergotropy**


The central idea is to show that the ergotropy of a full rank random quantum state _ρ_ concentrates around its
average ergotropy, which is zero in the asymptotic limit. We develop this proof via a sequence of non-trivial steps.
First, we prove an upper bound on the average ergotropy, and then show that the ergotropy functional is Lipschitz
continuous. Finally, we leverage the concentration of measure phenomena to show that Erg( _ρ_ ) is close to its average
with a high probability.


**Average ergotropy:** Let _ρ_ _ρ_ ( _U_ ) be a random state in� _N_ obtained via partial tracing Haar random pure states
eigenvalues ofon _HN ⊗HN_ _′ ρ_ . In particular,( _U_ ). Further, let _≡ ρ_ ( _U π_ ) = Tr be a permutation on _B_ _U |ψ_ 0 _⟩⟨ψ_ 0 _|AB N U D_ _[†]_ objects such that [�], where _|ψ_ 0 _⟩AB_ is a fixed state. Let _λ_ - _π_ (1)�( _U_ ) _≥· · · ≥_ _λ {π_ ( _λNi_ ()( _UU_ )) _} >i_ _[N]_ =1 0 while [be the]
_E_ 1 _≤· · · ≤_ _EN_ . The ergotropy of _ρ_ ( _U_ ) is given by Erg ( _ρ_ ( _U_ )) = max _V ∈_ U( _N_ ) Tr _H_ _ρ_ ( _U_ ) _−_ _V ρ_ ( _U_ ) _V_ _[†]_ [��] . We have




    - _N_

Erg ( _ρ_ ( _U_ )) = Tr [ _Hρ_ ( _U_ )] _Eiλπ_ ( _i_ )( _U_ ) _._ (23)
_−_

_i_ =1



Since _ρ_ ( _U_ ) is a random state, Erg ( _ρ_ ( _U_ )) is a random variable. In the following lemma, we estimate the expectation
value EU( _NN ′_ ) [Erg ( _ρ_ ( _U_ ))] of Erg ( _ρ_ ( _U_ )).


**Lemma 4.** _The average ergotropy for a full rank random quantum state sampled from the distribution_ - _µN,N_ _′_ ( _ρ_ ) _(Eq._
(20) _) is bounded from above by ∥H∥_ _N/N_ _[′]_ _._

_Proof._ Let us denote EU( _NN ′_ ) by E for the ease of notation. Using E[ _ρ_ ( _U_ )] = I _N_ _/N_ (see e.g. [75]), we have


         - _N_



E [Erg ( _ρ_ ( _U_ ))] =



_Ei_ E [ _δi_ ( _U_ )] _,_ (24)

_i_ =1



where _δi_ ( _U_ ) = 1 _/N_ _λπ_ ( _i_ )( _U_ ). From Cauchy-Schwarz inequality, we have
_−_




~~�~~

~~�~~






- _N_



E [Erg ( _ρ_ ( _U_ ))] _≤_




~~�~~

~~�~~






- _N_



_Ei_ [2]
_i_ =1



(E [ _δi_ ( _U_ )]) [2]

_i_ =1



_√_
_≤_


_√_
_≤_




~~�~~

~~�~~





_N_ _∥H∥_




- _N_



(E [ _δi_ ( _U_ )]) [2]

_i_ =1




~~�~~

~~�~~

�E



_δi_ [2][(] _[U]_ [)]
_i_ =1



_,_ (25)




~~�~~



_N_ _∥H∥_




~~�~~

- _N_



�� _N_                     - �� _N_                     where, in the last line, we applied Jensen’s inequality. Noting that� - [��] - - E _i_ =1 _[δ]_ _i_ [2][(] _[U]_ [)] = E _i_ =1 _[λ]_ _π_ [2] ( _i_ ) [(] _[U]_ [)] _−_ 1 _/N_ =




 -  -  -  E Tr _ρ_ ( _U_ ) [2][��] _−_ 1 _/N_ and E Tr( _ρ_ [2] ) = ( _N_ + _N_ _[′]_ ) _/_ ( _NN_ _[′]_ + 1) [75], we obtain







E [Erg ( _ρ_ ( _U_ ))] _≤∥H∥_



_N_
_N_ _[′]_ _[.]_ (26)



This concludes the proof of the lemma.


**Lipschitz continuity of Ergotropy:** Next, we prove that Erg ( _ρ_ ( _U_ )) is a Lipschitz continuous function. Note that
this was recently proven in Ref. [66]. We prove a slightly different version of the same result here via the following
Lemma:

**Lemma 5.** _The ergotropy of quantum states is a Lipschitz continuous function with Lipschitz constant L_ = 4 _∥H∥._
_More specifically, let ρ_ ( _U_ ) _, ρ_ ( _V_ ) _N such that ρ_ ( _U_ ) = Tr _B_ [ _ψ_ ( _U_ ) _ψ_ ( _U_ ) _AB_ ] _and ρ_ ( _V_ ) = Tr _B_ [ _ψ_ ( _V_ ) _ψ_ ( _V_ ) _AB_ ] _,_
_∈D_ _|_ _⟩⟨_ _|_ _|_ _⟩⟨_ _|_
_where B is an N_ _[′]_ _-dimensional system and |ψ_ ( _U_ ) _⟩AB_ = _U |ψ_ 0 _⟩. Here |ψ_ 0 _⟩_ _is a fixed normalized state and U and V_
_are unitaries. Then we have_


Erg ( _ρ_ ( _U_ )) Erg ( _ρ_ ( _V_ )) 4 _H_ _U_ _V_ 2 _,_ (27)
_|_ _−_ _| ≤_ _∥_ _∥∥_ _−_ _∥_

_where ∥·∥_ 2 _is the Hilbert-Schmidt norm._


12


_Proof._ Let _{λi_ ( _ρ_ ( _U_ )) _}_ and _{λi_ ( _ρ_ ( _V_ )) _}_ be the spectrum the of states _ρ_ ( _U_ ) and _ρ_ ( _V_ ). Let _λ_ _[↓]_ 1 [(] _[ρ]_ [(] _[U]_ [))] _[ ≥· · · ≥]_ _[λ][↓]_ _N_ [(] _[ρ]_ [(] _[U]_ [))]
and _λ_ _[↓]_ 1 [(] _[ρ]_ [(] _[V]_ [ ))] _[ ≥· · · ≥]_ _[λ][↓]_ _N_ [(] _[ρ]_ [(] _[V]_ [ )). Then the ergotropy of] _[ ρ]_ [(] _[U]_ [) and] _[ ρ]_ [(] _[V]_ [ ) is given, respectively, by]



Erg( _ρ_ ( _U_ )) = Tr [ _Hρ_ ( _U_ )] _−_


Erg( _ρ_ ( _V_ )) = Tr [ _Hρ_ ( _V_ )] _−_




- _N_

_Eiλ_ _[↓]_ _i_ [(] _[ρ]_ [(] _[U]_ [))] _[,]_
_i_ =1

- _N_

_Eiλ_ _[↓]_ _i_ [(] _[ρ]_ [(] _[V]_ [ ))] _[,]_
_i_ =1



where _H_ = [�] _[N]_ _i_ =1 _[E][i][ |][E][i][⟩⟨][E][i][|]_ [ with increasing energies] _[ E]_ [1] _[ ≤· · · ≤]_ _[E][N]_ [. Then]



_Ei_ ( _λ_ _[↓]_ _i_ [(] _[ρ]_ [(] _[U]_ [))] _[ −]_ _[λ]_ _i_ _[↓]_ [(] _[ρ]_ [(] _[V]_ [ )))]
_i_



�����



_|_ Erg( _ρ_ ( _U_ )) _−_ Erg( _ρ_ ( _V_ )) _| ≤|_ Tr( _H_ ( _ρ_ ( _U_ ) _−_ _ρ_ ( _V_ ))) _|_ +



�����







_≤∥H∥∥ρ_ ( _U_ ) _−_ _ρ_ ( _V_ ) _∥_ 1 + _∥H∥_ �� _λ↓_ ( _ρ_ ( _U_ )) _−_ _λ↓_ ( _ρ_ ( _V_ ))��1 _[,]_ (28)



where _λ_ _[↓]_ ( _ρ_ ( _U_ )) is the vector with components _λ_ _[↓]_ 1 [(] _[ρ]_ [(] _[U]_ [))] _[ ≥· · · ≥]_ _[λ][↓]_ _N_ [(] _[ρ]_ [(] _[U]_ [)). Here] _[ ∥·∥]_ 1 [is the trace norm. Applying]
the trace-norm version of Lidskii’s inequality [84], we have
�� _λ↓_ ( _ρ_ ( _U_ )) _λ↓_ ( _ρ_ ( _V_ ))�� (29)
1
_−_ _[≤∥][ρ]_ [(] _[U]_ [)] _[ −]_ _[ρ]_ [(] _[V]_ [ )] _[∥]_ [1] _[.]_

Combining Eqs. (28) and (29), we have


Erg( _ρ_ ( _U_ )) Erg( _ρ_ ( _V_ )) 2 _H_ _ρ_ ( _U_ ) _ρ_ ( _V_ ) 1
_|_ _−_ _| ≤_ _∥_ _∥∥_ _−_ _∥_
2 _H_ _ψ_ ( _U_ ) _ψ_ ( _U_ ) _ψ_ ( _V_ ) _ψ_ ( _V_ ) 1 _,_
_≤_ _∥_ _∥∥|_ _⟩⟨_ _| −|_ _⟩⟨_ _|∥_


where in the last line we used the contractivity of the trace norm under partial trace. Note that




         _∥|ψ_ ( _U_ ) _⟩⟨ψ_ ( _U_ ) _| −|ψ_ ( _V_ ) _⟩⟨ψ_ ( _V_ ) _|∥_ 1 = 2



1 _ψ_ ( _U_ ) _ψ_ ( _V_ ) 2 _ψ_ ( _U_ ) _ψ_ ( _V_ ) 2 _._ (30)
_−| ⟨_ _|_ _⟩|_ [2] _≤_ _∥|_ _⟩−|_ _⟩∥_



Using _∥|ψ_ ( _U_ ) _⟩−|ψ_ ( _V_ ) _⟩∥_ 2 = _∥_ ( _U −_ _V_ ) _|ψ_ 0 _⟩∥_ 2 _≤∥U −_ _V ∥_ 2, we get

Erg( _ρ_ ( _U_ )) Erg( _ρ_ ( _V_ )) 4 _H_ _U_ _V_ 2 _._
_|_ _−_ _| ≤_ _∥_ _∥∥_ _−_ _∥_


This concludes the proof of the lemma.



Finally, we prove the main result of this section.




~~�~~
_Proof of Theorem 1_ .– From Lemma 4, we have that E[Erg( _ρ_ ( _U_ ))] _≤∥H∥_




~~�~~
_NN_ _[′]_ [. Then for] _[ γ >]_ [ 2] _[∥][H][∥]_



_Proof of Theorem 1_ .– From Lemma 4, we have that E[Erg( _ρ_ ( _U_ ))] _H_ _NN_ _[′]_ [. Then for] _[ γ >]_ [ 2] _[∥][H][∥]_ _NN_ _[′]_ [, we have]
_≤∥_ _∥_

_γ/_ 2 _>_ E[Erg( _ρ_ ( _U_ ))]. Now note that



Pr [Erg( _ρ_ ( _U_ )) _> γ_ ] _≤_ Pr [Erg( _ρ_ ( _U_ )) _> γ/_ 2 + E [Erg( _ρ_ ( _U_ ))]] _._ (31)


From Lemma 3 and Lemma 5, we have








_−_ 768 _[NN]_ _∥H_ _[ ′][γ]_ _∥_ [2][2]







Pr [Erg( _ρ_ ( _U_ )) _> γ/_ 2 + E [Erg( _ρ_ ( _U_ ))]] _≤_ exp


Using Eq. (32) in Eq. (31), we complete the proof of the theorem.



_._ (32)



**B.** **Extracting work from multiple copies of** _ρ_ **: proof of Lemma 1**


In this section, we prove Lemma 1. This requires obtaining the number of samples _T_ [�] required to estimate the
probabilities � _pi_ to arbitrary additive precision. Furthermore, as discussed in Sec. II B, the appropriate choice of the
precision parameter is also crucial: ordering the estimated probabilities � _pi_ ’s should not alter the original ordering of
the _pi_ ’s. This affects the number of samples _T_ [�] . We first obtain _T_ [�] as a function of any arbitrary _ε >_ 0, and then
substitute the appropriate value of _ε_ based on our requirement.


13


**Probability estimation:** Let us consider independent and identically distributed (i.i.d.) random variables� - _Y_ 1 _, · · · YT_ which satisfy _aj_ _Yj_ _bj_ . Let, for all _j_ _T_ -, E [ _Yj_ ] := E [ _Y_ ]. For such i.i.d. random variables, for all _ε >_ 0,
_≤_ _≤_ _∈_

Hoeffding’s inequality [69, 85] states that






 _._ (33)







������ _≥_ _ε_




- _T_ 


_Yj_ E[ _Y_ ]
_j_ =1 _−_





2 _T_ [�][2] _ε_ [2]


_−_ ~~�~~ _T_ _j_ =1 [(] _[b][j][ −]_ _[a][j]_ [)][2]



 _≤_ 2 exp



Pr








������



1

_T_ 


Let _ρ_ be an unknown _n_ -qubit quantum state, and we want to estimate probabilities of outcomes of a projective
measurement given by _{Pi}i_ _[M]_ =1 [such that] _[ P]_ _i_ [ 2] [=] _[ P][i]_ [ and] _[ P][i][ ≥]_ [0 for all] _[ i][ ∈]_ [[] _[M]_ []. Further,][ �] _i_ _[M]_ =1 _[P][i]_ [ =][ I] _[N]_ [, where] _[ N]_ [ = 2] _[n]_ [.]
Suppose we perform this projective measurement _T_ [�] times. At each instance of measurement, the outcome is one of
the indices _i_ [ _M_ ]. Let us define an indicator function _Ii_, which is one if the measurement outcome is _i_ and zero
_∈_
otherwise. During _j_ th repetition of the measurement, we store the value of� - - - _Ii_ in the random variable _Yj_ [(] _[i]_ [)] . The

expectation value of _Yj_ [(] _[i]_ [)] for each _j_ _T_ - is given by E _Yj_ [(] _[i]_ [)] = _pi_, where _pi_ = Tr [ _ρPi_ ] for _i_ [ _M_ ]. Then, defining
_∈_ _∈_

_T_ 1� - _Tj_ �=1 _[Y]_ _j_ [ (] _[i]_ [)] = � _pi_, from Hoeffding’s inequality for i.i.d. random variables _Yj_ [(] _[i]_ [)], for all _ε >_ 0 we have




            Pr [ _p_ - _i_ _pi_ _ε_ ] 2 exp 2 _Tε_ [�] [2][�] _,_ (34)
_|_ _−_ _| ≥_ _≤_ _−_




                            -                             where we used the fact that 0 _Yj_ [(] _[i]_ [)] 1 for each _j_ _T_ - and _i_ [ _M_ ]. Now, for 0 _< δ <_ 1, by choosing

   - [�] _≤_ _≤_ _∈_ _∈_




   2 exp _−_ 2 _Tε_ [�] [2][�] _≤_ _δ/M_ or




    1 2 _M_
_T_ - _≥_ 2 _ε_ [2] [ln] _δ_





_,_ (35)



failure probabilitywe have Pr [ _|p_ - _i −_ _p δ/Mi| ≥_ _ε_ . Now applying union bound on measurement outcomes] _≤_ _δ/M_ . Thus, _T_ [�] samples of _ρ_ suffice to estimate _pi_ within additive error _i ∈_ [ _M_ ], we have _ε_ and maximum





 - _M_








- _M_ 
Pr [ _Gi_ ] 2 _M_ exp 2 _Tε_ [�] [2][�] _δ,_ (36)
_≤_ _−_ _≤_
_i_ =1



Pr



_Gi_

_i_ =1



_≤_




                                  whereestimate _G pi_ denotes the event that _i_ for all _i ∈_ [ _M_ ] within additive error _|p_ - _i −_ _pi| ≥_ _ε_ . This implies that _ε_ and maximum failure probability _O_ log (2 _M/δ_ ) _/ε δ_ [2] . [�] samples of _ρ_ are sufficient to

**Choosing the error** _ε_ **:** As discussed in Sec. II B, the estimates � _pi_ need to be arranged in non-increasing order for
the construction of the global unitary _U_ gl. It is thus necessary to ensure that the precision _ε_ is such that it does not
alter the ordering of the original _pi_ ’s. In other words, we intend to find error _ε_ in the estimated probabilities _p_ - _i_ _i_ =1
_{_ _}_ _[M]_
such thatin estimation does not affect _pi −_ _pj ≥_ 0 implies � _Upi_ gl _−_ . Now, for distinct ( _p_ - _j ≥_ 0 for all pairs _i, jpi, p ∈j_ ) pairs let us define ∆:= min[ _M_ ]. For the equality case, i.e., _i,j pip_ = _i_ _pjp_, the error incurred _j_ : _pi_ = _pj_ . Then
for _pi_ _pj_ 0, we have _pi_ _pj_ ∆. Using this, we have _{|_ _−_ _|_ _̸_ _}_
_−_ _≥_ _−_ _≥_

( _p_                     - _i_ _p_                     - _j_ ) = ( _p_                     - _i_ _pi_ ) ( _p_                     - _j_ _pj_ ) + ( _pi_ _pj_ )
_−_ _−_ _−_ _−_ _−_
_≥−_ 2 _ε_ + ∆ _._


Thus, taking _ε <_ ∆ _/_ 2 (e.g. taking _ε_ = ∆ _/_ 3), we can ensure that the error incurred in the estimation of probabilities
_pi_ does not affect the choice of global unitary.
The proof of Lemma 1 follows directly by substituting the upper bound on _ε_ into the expression for _T_ [�] . This shows
that the estimation of probabilities� _pi_ for all _i_ [ _M_ ] with additive error ∆ _/_ 3 and failure probability at most _δ_ requires
_∈_
only _O_ log( _M/δ_ ) _/_ ∆ [2][�] samples of the unknown state.


**C.** **Robustness of observational ergotropy: Proof of Lemma 2**


In this subsection, we formally prove Lemma 2. In Sec. II C, we divided the eigenvalues of _H_ into contiguous blocks
_A_ 1 _, A_ 2 _, · · · AM_, such that the average energy of each block _Ei_ is as stated in Eq. (11). Then, observational ergotropy


14



can be written as




            -             Ergobs ( _ρ_ ) = Tr [ _H ρ_ ] _−_ Tr _U_ gl � _ρ U_ gl _[†]_



= Tr [ _H ρ_ ] _−_




- _M_

_pjEj,_

_j_ =1



where � _ρ_ is the coarse grained state, and in the last line we have used the fact that




  -  Tr _U_ gl � _ρ U_ gl _[†]_ =




- _M_

_pjEj,_

_j_ =1



following Eq. (11).
Now, as explained in Sec. II C, for estimating _guessed observational ergotropy_, the experimentalist first sorts the
estimated probabilities � _pi_, using the permutation _π_ . Now, the global unitary _U_ [�] gl maps the eigenvectors of _Pπ_ ( _i_ ) to
the energy block _Ai_ . So, if _pπ_ ( _i_ ) is the _true_ probability of the block _Pπ_ ( _i_ ) which the experimentalist belives to be the
_i_ -th largest, then



Erg� obs( _ρ_ ) = Tr[ _H ρ_ ] _−_ Tr[ _U_ [�] gl � _ρ_ _U_ [�] gl _[†]_ []]



= Tr[ _H ρ_ ] _−_




- _M_



_pπ_ ( _i_ ) _Ei._

_i_ =1



Therefore, we obtain

                            -                            ����Ergobs( _ρ_ ) _−_ Ergobs ( _ρ_ )��� = ���Tr _U_ gl � _ρ U_ gl _[†]_ _−_ Tr[ _U_ [�] gl � _ρ_ _U_ [�] gl _[†]_ []] ���



=



������




- _M_


_j_ =1




- _pj_ _pπ_ ( _j_ )
_−_



_Ej_



������



_≤∥H∥_




- _M_


_j_ =1



�� _pj_ _pπ_ ( _j_ )�� _,_
_−_



where the upper bound in the last line follows from the triangle inequality.


**D.** **Randomized quantum algorithm for work extraction from local Hamiltonians**


For this section, consider any _n_ -qubit Hamiltonian


         - _K_



_H_ =



_hj_ Λ _j,_

_j_ =1



where each Λ _j_ is a string of _n_ -qubit Pauli operators and _h_ = [�] _j_

_h_ imaginary phase can be absorbed into the description of the Pauli operator itself, i.e., Λ _j ∈_ R [+] . This is because, in general, these coefficients can be written as _[|][h][j][|]_ [. Without loss of generality, we assume that] _hj_ = _e_ _[iϕ]_ _cj_, where _j_ _cje ∈_ _[iϕ]_ ΛR _j_ [+] .. In this case, the
In this case, we can replace the POVM measurements of _H_ in Protocol 1 with the measurements of randomly _�→_
sampled Λ _j_ which takes values in _{−_ 1 _,_ 1 _}_ . These modifications simplify the measurement scheme while still ensuring
that the randomized algorithm estimates observational ergotropy Ergobs ( _ρ_ ) to _ε_ -additive accuracy, with a success
probability of at least 1 _−_ _δ_ . We outline the steps via Protocol 2.
In particular, Step 1 and Step 2(c) of Protocol 1 is modified as follows: instead of measuring _H_ (or _−H_ ), sample a
Step 1 (or equivalentlyPauli string Λ according to the ensemble _−_ Λ in Step 2(c)). Note that _{hi/h,_ Λ _i}i_ _[M]_ E=1[Λ] = [, and perform a POVM measurement of Λ with respect to] _H/h_, and the _j_ [th] iteration of Steps 1, and Steps 2(a)-(c) _[ ρ]_ [ in]
in Protocol 2 results in a random variable _µj_ in Step 3 such that




       -        - ��

2 E[ _µj_ ] = _h_ [1] [Tr] _H_ _ρ −_ _U_ gl � _ρ U_ gl _[†]_ _._


15


**Protocol 2:** `Work Extraction from local Hamiltonians`
1. With probability 1 _/_ 2, sample Λ _∼{hi/h,_ Λ _i}_ _[M]_ _i_ =1 [and measure Λ on the state] _[ ρ]_ [.]


2. With probability 1 _/_ 2, execute steps ( _a_ ) _−_ ( _c_ ).


(a) Measure _ρ_ in the basis spanned by the projectors _{Pi}_ _[M]_ _i_ =1 [and ignore the outcomes to obtain the]
post-measurement state ¯ _ρ_ .


(b) Sample a unitary _Ur_ uniformly at random from the _r_ -qubit Pauli group, where _r_ = log2( _N/M_ ), and apply the
unitary _U_ gl(I _M ⊗_ _Ur_ ) to ¯ _ρ_ to obtain


_ρ_ _[′]_ = _U_ gl( _IM ⊗_ _Ur_ )¯ _ρ_ ( _IM ⊗_ _Ur_ ) _[†]_ _U_ gl _[†]_


(c) Sample Λ _∼{hi/h,_ Λ _i}_ _[M]_ _i_ =1 [and measure] _[ −]_ [Λ in the state obtained after step (b) above.]


3. Store the outcome of the measurement of the _j_ [th] iteration into _µj_ .


4. Repeat Steps 1 and 2(a)-(c), a total of _T_ times.



5. Output _µ_ = [2] _[h]_   - _Tj_ =1 _[µ][j]_ [.]

_T_


Then, the overall output of Protocol 2 (Step 5) is


As before, Hoeffding’s inequality ensures that



_µ_ = [2] _[h]_

_T_




- _T_

_µj._

_j_ =1



So, we have


with probability 1 _−_ _δ_ as long as




                 -                 Pr [ _|µ −_ Ergobs ( _ρ_ ) _| ≥_ _ε_ ] _≤_ 2 exp _−Th_ _[−]_ [2] _ε_ [2] _/_ 8 _._


_|µ −_ Ergobs ( _ρ_ ) _| ≤_ _ε,_




  _h_ 2 log(1 _/δ_ )
_T_ = _O_

_ε_ [2]





_._



**V.** **DISCUSSION AND FUTURE WORK**


We consider the problem of extracting work from a physical system described by a known Hamiltonian _H_, but
prepared in an unknown quantum state _ρ_, accessible only through copies provided in a black-box manner. In this
paper, we determine the number of samples required to estimate the extractable work in such a scenario. We
rigorously show that extracting any non-negligible amount of work from a single copy of _ρ_ is essentially impossible
in the appropriate limit (see Theorem 1). This underscores a fundamental limitation of single-shot thermodynamic
protocols when the state is not known and cannot be reconstructed with sufficient precision from just one instance.
When multiple copies are available, however, we demonstrate that only _O_ (1 _/ε_ [2] ) samples suffice to estimate the
amount of extractable work, as quantified by _observational ergotropy_, with high probability and _ε_ -additive accuracy.
Notably, the same number of copies is required not only to estimate the ergotropy but also to meaningfully leverage
the state as an energy resource—for instance, for charging a quantum battery [86] or implementing arbitrary quantum
gates in an energy-aware and efficient manner [87].
Observational ergotropy depends intricately on the choice of measurement and, in certain cases, may even be nonpositive. While it is theoretically possible to maximize this quantity over all measurement settings to ensure positivity,
doing so is practically infeasible due to constraints on the number of state copies and circuit complexity. Consequently,
we focus on the practically relevant setting where only a single quantum measurement is allowed. How the sample
complexity and accuracy of ergotropy estimation would be affected if multiple or adaptive measurement settings were
permitted is left open in our work. Exploring such scenarios could yield improved protocols for estimating extractable
work or for identifying near-optimal measurement bases with minimal overhead.


16


To achieve sample efficiency, our quantum algorithm employs a subtle combination of randomized sampling and
a single quantum measurement, ensuring that the entire procedure remains _qubit-efficient_ . This feature is especially
important given the current limitations of quantum hardware. This is non-trivial as other ways of estimating observational ergotropy can be inefficient. In fact, in Sec. D of the Appendix, we illustrate how more elaborate primitives,
such as the Linear Combination of Unitaries (LCU) [88, 89], can be integrated into our algorithmic framework to
estimate extractable work. While such methods provide an alternative route to estimating extractable work, they
introduce significant overhead by increasing the sample complexity exponentially and requiring additional ancilla
qubits. This highlights a key trade-off between algorithmic generality and physical resource efficiency.
Beyond efficiency, we also provide rigorous bounds that quantify the robustness of observational ergotropy estimation
in the presence of realistic errors. In particular, we show how imperfections in measurement statistics or deviations
in average energy values translate into variations in the estimation. These bounds not only certify the reliability of
our protocol under errors but also clarify the regimes where observational ergotropy provides a faithful proxy for true
extractable work.
Our work thus paves the way for using quantum computers to estimate thermodynamically meaningful quantities of
unknown quantum systems in a manner that is both resource-aware and experimentally viable. Going forward, several
promising research directions emerge from our study. One natural extension is to explore adaptive or multi-basis
measurement strategies, where outcomes from previous measurements guide the choice of future ones. Such feedbackbased approaches could potentially enhance estimation accuracy or reduce sample requirements. Moreover, while
observational ergotropy provides a physically operational quantity, it would be valuable to extend similar estimation
techniques to other thermodynamic primitives such as free energy differences, non-equilibrium work distributions,
or coherence-based contributions to extractable work. These quantities are relevant in broader thermodynamic and
resource-theoretic frameworks, and their estimation in black-box settings remains largely unexplored.
Another promising direction is to develop protocols that integrate ergotropy estimation into broader thermodynamic
cycles, such as those governing the operation of quantum batteries, engines, or refrigerators. In such contexts, realtime estimation of work potential could serve as a feedback mechanism to control device operation, thereby enhancing
energy efficiency.


**Acknowledgments**


We thank Karen V. Hovhannisyan, Rick P. A. Simon, Janet Anders, Hamed Mohammady, and Riccardo Castellano for helpful discussions and comments. The authors acknowledge support from the Ministry of Electronics and
Information Technology (MeitY), Government of India, under Grant No. 4(3)/2024-ITEA. AG and SD acknowledge
support from the Science and Engineering Research Board, Department of Science and Technology (SERB-DST),
Government of India, under Grant No. SRG/2023/000217. SC and SH acknowledge funding from the Science and
Engineering Research Board, Department of Science and Technology (SERB-DST), Government of India under Grant
No. SRG/2022/000354. SC also acknowledges funding from Fujitsu Ltd, Japan. SC, SD, and US thank IIIT Hyderabad
for support via the Faculty Seed Grant.


**Data availability**


The python codes used in this study are publicly available in the GitHub repository [90].


17


**APPENDIX**


In the Appendix, we provide additional examples that (a) illustrate the sample complexity of our work extraction
algorithm (see Appendix A and Appendix B), and (b) shows the tightness of the bound we obtained for the robustness
of observational ergotropy (Appendix E). We also derive a non-trivial bound on the deviation between true ergotropy
and observational ergotropy in Appendix C. Finally, in Appendix D, an ancilla-assisted work extraction protocol is
also discussed, which, although interesting, results in a worse sample complexity than our protocol in the main text.


**Appendix A: Example of a** 3 **-qubit system**


Let us consider a 3-qubit system with the Hamiltonian

_H_ [(8)] = _H ⊗_ I2 _⊗_ I2 + I2 _⊗_ _H ⊗_ I2 + I2 _⊗_ I2 _⊗_ _H,_ (A1)

where _H_ = 21 [(][I][2] _[ −]_ _[Z]_ [).] Here _n_ = 3 and _N_ = 8. The spectral decomposition of this Hamiltonian is given by
_H_ [(8)] = [�][4] _a_ =1 _[E][a]_ - _gκ_ (=1 _Ea_ ) _Ea_ ; _κ_, where
_|_ _⟩_

_E_ 1 = 0 _, g_ ( _E_ 1) = 1 _, |E_ 1; 1 _⟩_ = _|_ 000 _⟩_ := _|ϕ_ 1 _⟩_ ;
_E_ 2 = 1 _, g_ ( _E_ 2) = 3 _, |E_ 2; 1 _⟩_ = _|_ 001 _⟩_ := _|ϕ_ 2 _⟩_ _, |E_ 2; 2 _⟩_ = _|_ 010 _⟩_ := _|ϕ_ 3 _⟩_ _, |E_ 2; 3 _⟩_ = _|_ 100 _⟩_ := _|ϕ_ 4 _⟩_ ;
_E_ 3 = 2 _, g_ ( _E_ 3) = 3 _, |E_ 3; 1 _⟩_ = _|_ 011 _⟩_ := _|ϕ_ 5 _⟩_ _, |E_ 3; 2 _⟩_ = _|_ 101 _⟩_ := _|ϕ_ 6 _⟩_ _, |E_ 3; 3 _⟩_ = _|_ 110 _⟩_ := _|ϕ_ 7 _⟩_ ;
_E_ 4 = 3 _, g_ ( _E_ 4) = 1 _, |E_ 4; 1 _⟩_ = _|_ 111 _⟩_ := _|ϕ_ 8 _⟩_ _._

Further let _Qa_ = [�] _[g]_ _κ_ [(] =1 _[E][a]_ [)] _|Ea_ ; _κ⟩⟨Ea_ ; _κ|_ with _a_ = 1 _, · · ·,_ 4. Consider the unknown state to be _ρ_ = (1 _/_ 3) [�][3] _i_ =1 _[ρ][i]_ [, where]



_ρ_ 1 := [1]

3



�3



_ϕi_ _ϕj_ ; _ρ_ 2 := [1]
_|_ _⟩⟨_ _|_ 3
_i,j_ =1



3



�6



( 1) _[i]_ [+] _[j]_ _ϕi_ _ϕj_ ; _ρ_ 3 := [1]

_−_ _|_ _⟩⟨_ _|_ 2
_i,j_ =4



2



�8

_ϕi_ _ϕi_ _._ (A2)
_|_ _⟩⟨_ _|_
_i_ =7




        -         The energy Tr _H_ [(8)] _ρ_ of state _ρ_ is given by 29 _/_ 18. A minimum energy state (such a state is not unique here) with
respect to _ρ_ is given by



�2

_ϕi_ _ϕi_ +
_|_ _⟩⟨_ _|_
_i_ =1



_._ (A3)



�4



_ϕi_ _ϕi_
_|_ _⟩⟨_ _|_
_i_ =3







_ρp_ = [1]

6






2




        -        The energy Tr _H_ [(8)] _ρp_ of state _ρp_ is given by 2 _/_ 3. The ergotropy of _ρ_ is given by

                      -                       Erg ( _ρ_ ) = Tr _H_ [(8)] ( _ρ_ _ρp_ ) = [29] _[ −]_ [12] 0 _._ 94 _._
_−_ 18 _≈_


**1.** **Measurement in entangled basis**


��
( _b_ )
Let the projective measurement be given by _Pi_ _i_ =1 [, where] _[ P][i]_ [ =][ �][2] _b_ =1 ��� _ψi_ _ψi_ [(] _[b]_ [)] ��� for _i_ [4], where
_{_ _}_ [4] _∈_




  (1) 1
��� _ψ_ 1 :=
~~_√_~~

  (1) 1
��� _ψ_ 2 :=
~~_√_~~

  (1) 1
��� _ψ_ 3 :=
~~_√_~~

  (1) 1
��� _ψ_ 4 :=
~~_√_~~




        (2) 1
��� _ψ_ 1 :=
2 [(] _[|][ϕ]_ [1] _[⟩]_ [+] _[ |][ϕ]_ [7] _[⟩]_ [) ;] ~~_√_~~

        (2) 1
��� _ψ_ 2 :=
2 [(] _[|][ϕ]_ [1] _[⟩−|][ϕ]_ [7] _[⟩]_ [) ;] ~~_√_~~

        (2) 1
��� _ψ_ 3 :=
2 [(] _[|][ϕ]_ [3] _[⟩]_ [+] _[ |][ϕ]_ [4] _[⟩]_ [) ;] ~~_√_~~

        (2) 1
��� _ψ_ 4 :=
2 [(] _[|][ϕ]_ [3] _[⟩−|][ϕ]_ [4] _[⟩]_ [) ;] ~~_√_~~



2 [(] _[|][ϕ]_ [2] _[⟩]_ [+] _[ |][ϕ]_ [8] _[⟩]_ [) ;] (A4)


2 [(] _[|][ϕ]_ [2] _[⟩−|][ϕ]_ [8] _[⟩]_ [) ;] (A5)


2 [(] _[|][ϕ]_ [5] _[⟩]_ [+] _[ |][ϕ]_ [6] _[⟩]_ [) ;] (A6)


2 [(] _[|][ϕ]_ [5] _[⟩−|][ϕ]_ [6] _[⟩]_ [) ;] (A7)



Indeed all _Pi_ ’s are two dimensional projectors and in fact _P_ 1 = Φ+ Φ+ I2, _P_ 2 = Φ _−_ Φ _−_ I2, _P_ 3 = Ψ+ Ψ+ I2,
and _P_ 4 = _|_ Ψ _−⟩⟨_ Ψ _−| ⊗_ I2, where _|_ Φ+ _⟩_ = ~~_√_~~ 12 [(] _[|]_ [00] _[⟩]_ [+] _[ |]_ [11] _[⟩]_ [),] _[ |]_ _|_ [Φ] _[−][⟩]_ _⟩⟨_ [=] ~~_√_~~ 1 _|⊗_ 2 [(] _[|]_ [00] _[⟩−|]_ [11] _|_ _[⟩]_ [),] _⟩⟨_ _[ |]_ [Ψ][+] _[⟩]_ _|⊗_ [=] ~~_√_~~ 12 [(] _[|]_ [01] _|_ _[⟩]_ [+] _[ |]_ _⟩⟨_ [10] _[⟩]_ [), and] _|⊗_



andΨ _− P_ =4 = ~~_√_~~ 1 _|_ Ψ _−⟩⟨_ Ψ _−| ⊗_ I2, where _|_ Φ+ _⟩_ = ~~_√_~~ 12 [(] _[|]_ [00] _[⟩]_ [+] _[ |]_ [11] _[⟩]_ [),] _[ |]_ [Φ] _[−][⟩]_ [=] ~~_√_~~ 12 [(] _[|]_ [00] _[⟩−|]_ [11] _[⟩]_ [),] _[ |]_ [Ψ][+] _[⟩]_ [=] ~~_√_~~ 12 [(] _[|]_ [01] _[⟩]_ [+] _[ |]_ [10] _[⟩]_ [), and]

_|_ _⟩_ 2 [(] _[|]_ [01] _[⟩−|]_ [10] _[⟩]_ [).]



2 [(] _[|]_ [01] _[⟩−|]_ [10] _[⟩]_ [).]



~~_√_~~ 1
2 [(] _[|]_ [00] _[⟩]_ [+] _[ |]_ [11] _[⟩]_ [),] _[ |]_ [Φ] _[−][⟩]_ [=]



1 ~~_√_~~ 1

2 [(] _[|]_ [00] _[⟩−|]_ [11] _[⟩]_ [),] _[ |]_ [Ψ][+] _[⟩]_ [=]


18





















Fig. 4. The schematic above shows the action of global unitary on measured state to yield a corresponding passive state
for _n_ = 3 ( _N_ = 8) and Hamiltonian _H_ [(8)] given by Eq. (A1). Let the projective measurement be given by _{Pi}_ [4] _i_ =1 [, where]

_Pi_ = [�] _b_ [2] =1 ��� _ψi_ ( _b_ )�� _ψi_ [(] _[b]_ [)] ��� and _i_ = 1 _, · · ·,_ 4. Let _ρ_ be the unknown state and _pi_ = Tr [ _Piρ_ ]. Let _π_ be the permutation on 4

                           -                           -                           -                           objects such that _pπ_ ( _i_ ) _≥_ _pπ_ ( _i_ +1) for all _i ∈_ [3]. Then we define _U_ gl = _|ϕ_ 1 _⟩_ _ψπ_ [(1)] (1)��� + _|ϕ_ 2 _⟩_ _ψπ_ [(2)] (1)��� + _|ϕ_ 3 _⟩_ _ψπ_ [(1)] (2)��� + _|ϕ_ 4 _⟩_ _ψπ_ [(2)] (2)��� +

  -  -  -  _|ϕ_ 5 _⟩_ _ψπ_ [(1)] (3)��� + _|ϕ_ 6 _⟩_ _ψπ_ [(2)] (3)��� + _|ϕ_ 7 _⟩_ _ψπ_ [(1)] (4)��� + _|ϕ_ 8 _⟩_ _ψπ_ [(2)] (4)���.



Let us now compute the probabilities Tr[ _Piρ_ ]. We have Tr[ _P_ 1 _ρ_ ] = 185 [, Tr[] _[P]_ [2] _[ρ]_ [] =] 185 [, Tr[] _[P]_ [3] _[ρ]_ [] =] [1] 9




[1] [1]

9 [, and Tr[] _[P]_ [4] _[ρ]_ [] =] 3



Let us now compute the probabilities Tr[ _Piρ_ ]. We have Tr[ _P_ 1 _ρ_ ] = 18 [, Tr[] _[P]_ [2] _[ρ]_ [] =] 18 [, Tr[] _[P]_ [3] _[ρ]_ [] =] 9 [, and Tr[] _[P]_ [4] _[ρ]_ [] =] 3 [.]

                                              -                                              The average state after the measurement is given by� - - _ρ_ = [�][4] _i_ �=1 _[P][i][ρP][i]_ ~~�~~ [. The energy Tr] _H_ [(8)] _ρ_ - is given by 3 _/_ 2. The
1
eigenvalues of � _ρ_ are given by 18 _√_ 5 + 3 _,_ 36 [7] _[,]_ 36 [7] _[,]_ [1] 9 _[,]_ 12 [1] _[,]_ 12 [1] _[,]_ 18 [1] 3 _√_ 5 _,_ 0. The minimum energy state corresponding




                -                - _i_ �=1 _[i]_ _[i]_ ~~�~~
1
eigenvalues of � _ρ_ are given by 18 _√_ 5 + 3 _,_ 36 [7] _[,]_ 36 [7] _[,]_ [1] 9 _[,]_ 12 [1] _[,]_ 12 [1] _[,]_ 18 [1] 3 _√_ 5 _,_ 0. The minimum energy state corresponding

_−_

to this state is given by




   5 + 3 _,_ [7]




[7] [1]

36 _[,]_ 9




[7] [7]

36 _[,]_




[1] [1]

9 _[,]_




[1] [1]

12 _[,]_




[1] [1]

12 _[,]_



18 [1] _i_ �=13 _[i]_ _√_
_−_




  5 + 3 _ϕ_ 1 _ϕ_ 1 + [7]
_|_ _⟩⟨_ _|_ 36



_ϕi_ _ϕi_ + [1]
_|_ _⟩⟨_ _|_ 9
_i_ =2



12




 5 _ϕ_ 7 _ϕ_ 7 _._ (A8)
_|_ _⟩⟨_ _|_




[1] [1]

9 12

_[|][ϕ]_ [4] _[⟩⟨][ϕ]_ [4] _[|]_ [ +]



_ρ_ - _p_ = [1]

18




- _√_



�3



�6



_ϕi_ _ϕi_ + [1]
_|_ _⟩⟨_ _|_ 18
_i_ =5



18



�3 _−_ _√_



The ergotropy of the state � _ρp_ is given by




       -       Erg ( _ρ_ - _p_ ) = Tr _H_ [(8)] ( _ρ_ - _ρ_ - _p_ ) = [3]
_−_ 2




[3]

2 18

_[−]_ [1]



18



�21 _−_ 2 _√_ 5� _≈_ 0 _._ 58 _._



After averaging � _ρ_ with respect to Haar measure, we get _ρ_ _[′]_ = 361 [(5] _[P]_ [1][ + 5] _[P]_ [2][ + 2] _[P]_ [3][ + 6] _[P]_ [4][). The energy of the state]
_ρ_ _[′]_ is given by 3 _/_ 2. The eigenvalues (in decreasing order) _{λi}i_ [8] =1 [and the corresponding set of eigenvectors] _[ {|][λ][i][⟩}]_ _i_ [8] =1
of _ρ_ _[′]_ are given by




      (1)
6 [1] _[,][ |][λ]_ [1] _[⟩]_ [=] ��� _ψ_ 4 ; _λ_ 2 = [1] 6




      (1)
18 [1] _[,][ |][λ]_ [7] _[⟩]_ [=] ��� _ψ_ 3 ; _λ_ 8 = [1]




      (2)
18 [1] _[,][ |][λ]_ [8] _[⟩]_ [=] ��� _ψ_ 3 _._



_λ_ 1 = [1]

6

_λ_ 5 = [5]




      (2)

[1] 6 _[,][ |][λ]_ [2] _[⟩]_ [=] ��� _ψ_ 4 ; _λ_ 3 = [5]




      (2)
36 [5] _[,][ |][λ]_ [6] _[⟩]_ [=] ��� _ψ_ 2 ; _λ_ 7 = [1]




      (1)
36 [5] _[,][ |][λ]_ [5] _[⟩]_ [=] ��� _ψ_ 2 _, λ_ 6 = [5]




      (1)
36 [5] _[,][ |][λ]_ [3] _[⟩]_ [=] ��� _ψ_ 1 ; _λ_ 4 = [5]




      (2)
36 [5] _[,][ |][λ]_ [4] _[⟩]_ [=] ��� _ψ_ 1 ;



Let us define permutation _π_ as (1 4 3 2), i.e., _π_ (1) = 4 _, π_ (4) = 3 _, π_ (3) = 2 _, π_ (2) = 1. Using this, let us consider a
global unitary (see Fig. 4)

    -    -    -    -    -    -    -    _U_ gl = _ϕ_ 1 _ψπ_ [(1)] (1)��� + _ϕ_ 2 _ψπ_ [(2)] (1)��� + _ϕ_ 3 _ψπ_ [(1)] (2)��� + _ϕ_ 4 _ψπ_ [(2)] (2)��� + _ϕ_ 5 _ψπ_ [(1)] (3)��� + _ϕ_ 6 _ψπ_ [(] _[i]_ (3) [)] ��� + _ϕ_ 7 _ψπ_ [(1)] (4)��� + _ϕ_ 8 _ψπ_ [(2)] (4)���
_|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_

    -    -    -    -    -    -    -    = _ϕ_ 1 _ψ_ 4 [(1)] ��� + _ϕ_ 2 _ψ_ 4 [(2)] ��� + _ϕ_ 3 _ψ_ 1 [(1)] ��� + _ϕ_ 4 _ψ_ 1 [(2)] ��� + _ϕ_ 5 _ψ_ 2 [(1)] ��� + _ϕ_ 6 _ψ_ 2 [(] _[i]_ [)] ��� + _ϕ_ 7 _ψ_ 3 [(1)] ��� + _ϕ_ 8 _ψ_ 3 [(2)] ��� _._
_|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_


19

|State|Energy|Ergotropy|Observational Ergotropy|Col5|
|---|---|---|---|---|
|State|Energy|Ergotropy|Entangled basis (Sec. A 1)|Product basis (Sec. A 2)|
|_ρ_|_≈_1_._61|_≈_0_._94|_≈_0_._33|_≈_0_._22|



Table 1. Ergotropy and observational ergotropy. For state _ρ_ = (1 _/_ 3) [�] _i_ [3] =1 _[ρ][i]_ [, where] _[ ρ]_ [1][,] _[ ρ]_ [2][, and] _[ ρ]_ [3][ are given in Eq. (][A2][), the]
table shows values of ergotropy and observational ergotropy for two different measurement settings.


The minimum energy state for _ρ_ _[′]_ = _U_ gl _ρ_ _[′]_ _U_ gl _[†]_ [is then given by]



�2

_ϕi_ _ϕi_ + 5
_|_ _⟩⟨_ _|_
_i_ =1



_._ (A9)



�6

_ϕi_ _ϕi_ + 2
_|_ _⟩⟨_ _|_
_i_ =3



�8



_ϕi_ _ϕi_
_|_ _⟩⟨_ _|_
_i_ =7







_ρ_ _[′]_ _p_ [=] [1]

36






6




                             - ��
The ergotropy of the state _ρ_ _[′]_ is given by Erg (� _ρ_ [ �] _[′]_ ) = Tr �� _H_ [(8)][ �] _ρ_ _[′]_ _−_ _ρ_ _[′]_ _p_ = [2] 9



The ergotropy of the stateof the state _ρ_ is given by Erg _ρ_ _[′]_ obsis given by Erg ( ( _ρ_ ) = Tr - _H_ [(8)] _ρ_ [ �] _[′]_ ) = Tr _ρ_ _ρ_ _[′]_ _p_ �� _H_ = [(8)][1] 3 _ρ_ _[′]_ _−_ _ρ_ _[′]_ _p_ = [2] 9 _[≈]_ [0] _[.]_ [22. while the observational ergotropy]

_−_ _[≈]_ [0] _[.]_ [33 (See Table][ 1][ and Fig.][ 5a][).]




[1]

3

_[≈]_ [0] _[.]_ [33 (See Table][ 1][ and Fig.][ 5a][).]



(a) Measurement in entangled basis (b) Measurement in product basis


Fig. 5. Observational ergotropy and sample complexity. Consider a state _ρ_ = (1 _/_ 3) [�] _i_ [3] =1 _[ρ][i]_ [, where] _[ ρ]_ [1][,] _[ ρ]_ [2][, and] _[ ρ]_ [3][ are given]
in Eq. (A2). Figs. (5a) and (5b) show the convergence of our protocol from main text to the exact value of observational
ergotropy, as we increase number of samples, with respect to measurements in entangled (Sec. A 1) and product (Sec. A 2)
bases, respectively.


**2.** **Measurement in product basis**



10Let the projective measurement be given by10 I2, and _K_ 4 = 11 11 I2. We have Tr[ _{KKi}_ 1 _i_ [4] _ρ_ =1] = 2 [, where] _/_ 9, Tr[ _[ K]_ _K_ [1][ =] 2 _ρ_ ] = 2 _[ |]_ [00] _[⟩⟨]_ _/_ 9, Tr[ [00] _[| ⊗]_ _K_ [I][2] 3 [,] _ρ_ _[ K]_ ] = 2 [2][ =] _/_ 9, and Tr[ _[ |]_ [01] _[⟩⟨]_ [01] _[| ⊗]_ _K_ 4 [I] _ρ_ [2] ] = 1 [,] _[ K]_ [3][ =] _/_ 3.
_|_ _⟩⟨_ _| ⊗_ _|_ _⟩⟨_ _| ⊗_ - The average state after the measurement is given by � _σ_ = [�][4] _i_ =1 _[K][i][ρK][i]_ [. The energy Tr] _H_ [(8)] _σ_ - is given by 29 _/_ 18. The
eigenvalues of � _σ_ are given by [2] _[,]_ [2] _[,]_ [1] _[,]_ [1] _[,]_ [1] _[,]_ [1] _[,]_ [ 0] _[,]_ [ 0. The minimum energy state corresponding to this state is given by]




[2] [2]

9 _[,]_ 9




[2] [1]

9 _[,]_ 6




[1] [1]

6 _[,]_ 6




[1] [1]

6 _[,]_ 9




[1] [1]

9 _[,]_ 9



9 _[,]_ [ 0] _[,]_ [ 0. The minimum energy state corresponding to this state is given by]



_σ_ - _p_ = [2]

9



�2



_ϕi_ _ϕi_ + [1]
_|_ _⟩⟨_ _|_ 6
_i_ =1



6



�4



_ϕi_ _ϕi_ + [1]
_|_ _⟩⟨_ _|_ 9
_i_ =3



9



�6

_ϕi_ _ϕi_ _._ (A10)
_|_ _⟩⟨_ _|_
_i_ =5




                            -                             The ergotropy of the state � _σ_ is given by Erg ( _σ_ �) = Tr _H_ [(8)] ( _σ_ - _σ_ - _p_ ) = [29] 18

measure, we get _−_ _[−]_ [1] _[ ≈]_ [0] _[.]_ [61. After averaging][ �] _[σ]_ [ wrt to Haar]



_σ_ _[′]_ = [1] (A11)

18 [(2] _[K]_ [1][ + 2] _[K]_ [2][ + 2] _[K]_ [3][ + 3] _[K]_ [4][)] _[ .]_


20



The energy of the state _σ_ _[′]_ is given by 29 _/_ 18. The minimum energy state for _σ_ _[′]_ is given by



_σp_ _[′]_ [=] [1]

6



�2



_ϕi_ _ϕi_ + [1]
_|_ _⟩⟨_ _|_ 9
_i_ =1



9



�8

_ϕi_ _ϕi_ (A12)
_|_ _⟩⟨_ _|_
_i_ =3




                       -                        The energy of the state� �� _σp_ _[′]_ [is given by Tr] _H_ [(8)] _σp_ _[′]_ = 1825 [.] The ergotropy of the state _σ_ _[′]_ is given by Erg (� _σ_ _[′]_ ) =��
Tr _H_ [(8)][ �] _σ_ _[′]_ _σp_ _[′]_ = 184 _H_ [(8)][ �] _ρ_ _σp_ _[′]_ =
2 _−_ _[≈]_ [0] _[.]_ [22. The observational ergotropy of the state] _[ ρ]_ [ is given by Erg][obs][ (] _[ρ]_ [) = Tr] _−_
9

_[≈]_ [0] _[.]_ [22 (See Table][ 1][ and Fig.][ 5b][).]


**Appendix B: Example of** 4 **qubit translationally invariant spin chain**


In this section we consider translationally invariant spin chain, in particular, one dimensional Heisenberg XXX
model, as an example. For _n_ spins such a spin chain is described by the Hamiltonian



_Hn_ = _−J_




- _n_

_σz_ [(] _[j]_ [)] _σz_ [(] _[j]_ [+1)] _h_
_⊗_ _−_
_j_ =1




- _n_

_σx_ [(] _[j]_ [)] _[,]_ (B1)
_j_ =1




- _n_



where _J_ is the spin coupling constant, _h_ is the transverse magnetic field and the periodic boundary condition is ensured
by identification _σz_ [(] _[n]_ [+1)] = _σz_ [(1)][. The sign of] _[ J]_ [ ensures whether the ground state is ferromagnetic or antiferromagnetic]


Fig. 6. _n_ = 4 Heisenberg XXX model. For the state in Eq. (B2), the exact observational ergotropy of _η_ 4 is equal to _≈_ 0 _._ 28.
The figure shows how our protocol for work extraction reaches to _≈_ 0 _._ 28 as we increase the number of samples in accordance
with the bound on the sample complexity.


[91–93]. Here we take _J_ = 1 and _h_ = 1. For the case of 4 spins, we consider the state



_η_ 4 = [1]




[1]

4 2

_[|][ϕ]_ [2] _[⟩⟨][ϕ]_ [2] _[|]_ [ + ][1]




[1]

4 4

_[|][ϕ]_ [1] _[⟩⟨][ϕ]_ [1] _[|]_ [ + ][1]



(B2)
2

_[|][ϕ]_ [3] _[⟩⟨][ϕ]_ [3] _[|][,]_



where _ϕ_ 1 = 0010, _ϕ_ 2 = 0111 and
_|_ _⟩_ _|_ _⟩_ _|_ _⟩_ _|_ _⟩_

_ϕ_ 3 = [1] (B3)
_|_ _⟩_ 2 [(] _[|]_ [0000] _[⟩]_ [+] _[ |]_ [0001] _[⟩]_ [+] _[ |]_ [1110] _[⟩]_ [+] _[ |]_ [1111] _[⟩]_ [)] _[ .]_

The ergotropy of _η_ 4 is computed to be _≈_ 2 _._ 86. Further, to obtain observational ergotropy, we perform the projective
measurement defined by the projectors _Li_ for _i_ = [4], where


_L_ 1 = _|_ 00 _⟩⟨_ 00 _| ⊗_ I4; _L_ 2 = _|_ 01 _⟩⟨_ 01 _| ⊗_ I4; _L_ 3 = _|_ 10 _⟩⟨_ 10 _| ⊗_ I4; _L_ 4 = _|_ 11 _⟩⟨_ 11 _| ⊗_ I4 _._ (B4)

With the above projectors, the observational ergotropy of _η_ 4 is given by _≈_ 0 _._ 28. In Fig. 6, we show how our protocol
reaches this value as we increase the number of samples.


21


**Appendix C: Deviation between true ergotropy and observational ergotropy**


Estimating the ergotropy of an unknown quantum state directly is notoriously resource-intensive, since it requires
complete spectral information about the state. Our protocol in Sec. II B (Protocol 1), on the other hand, circumvents
this by efficiently estimating the _observational ergotropy_, which depends only on coarse-grained information obtained
from a small number of samples. From a thermodynamic perspective, it is natural to expect that the true ergotropy
of a state _ρ_, the maximum work extractable under optimal global control, should always exceed its observational
counterpart, which is limited by the coarse description accessible in practice. Put differently, while ergotropy leverages
the full microscopic structure of _ρ_, observational ergotropy reflects the work one can certify from only a few samples
of the state. In this sub-section, we sharpen this intuition by establishing a non-trivial lower bound on the difference
between the two quantities.
Recall that to estimate observational ergotropy, we introduced a collection of _M_ orthogonal projectors _{Pi}i_ _[M]_ =1 [,]
each of dimension _d_ = 2 _[r]_, satisfying [�] _i_ _[P][i]_ [ =][ I] _[N]_ [. These projectors define the probabilities] _[ p][i]_ [ = Tr[] _[P][i][ρ]_ [], and specify]

the coarse-grained statenon-decreasing order, and counted with degeneracies. Then we have the following lemma. � _ρ_ . Let _E_ 1 _≤_ _E_ 2 _≤· · · EN_ denote the eigenvalues of the system Hamiltonian _H_, listed in


**Lemma A6.** _Let N_ = 2 _[n]_ _, and H be the total Hamiltonian of an n-qubit system in the state ρ, with eigenvalues_
_satisfyingE_ 1 _≤_ _E_ 2 _≤· · · ≤_ [�] _i_ _[P][i]_ [ =] _E_ [ I] _N_ _[N]_ _. Define the set of orthogonal projectors_ _[. Furthermore, let][ p][i]_ [ = Tr[] _[P][i][ρ]_ []] _[, and][ p]_ [max] _{_ [ = max] _Pi}i_ _[M]_ =1 _[i][, each of dimension][ p][i][. Then,]_ _[ d]_ [ = 2] _[r][, where][ M]_ [ =] _[ N/d][,]_




        -         _p_ max _S_
Erg ( _ρ_ ) Ergobs ( _ρ_ ) max 0 _,_ _·_
_−_ _≥_ _d_



_· S_

_d_ _−_ [Tr[] _N_ _[H]_ []]



��

_,_ (C1)



_N_



_where S_ = [�] _[d]_ _i_ =1 _[E][i][, is the sum of the][ d][ lowest energy eigenvalues of][ H][.]_


_Proof._ We first show that



Erg ( _ρ_ ) _−_ Ergobs ( _ρ_ ) _≥_ 0 _._



_j_ _[q][j][f][j]_ [(] _[x]_ [) =][ �]




                  Note that for non-negative weights _qj_ 0, and real valued functions _fj_ ( _x_ ), if min _x_
_≥_

_[∗]_



Note that for non-negative weights _qj ≥_ 0, and real valued functions _fj_ ( _x_ ), if min _x_ _j_ _[q][j][f][j]_ [(] _[x]_ [) =] _j_ _[q][j][f][j]_ [(] _[x][∗]_ [), then]

since _fj_ ( _x_ _[∗]_ ) _≥_ min _x fj_ ( _x_ ), we have







min
_x_




  _qjfj_ ( _x_ )
_≥_
_j_ _j_



_qj_ min
_x_ _[f][j]_ [(] _[x]_ [)] _[.]_
_j_



Applying the integral form of this inequality to the expression for observational ergotropy, we obtain



Ergobs ( _ρ_ ) = Tr [ _H ρ_ ] min
_−_ _V_





       _dµ_ ( _U_ ) Tr _H V_ ( _UρU_ _[†]_ ) _V_ _[†]_ [�]
_U_




     _≤_ Tr [ _H ρ_ ] _−_




         _dµ_ ( _U_ ) min Tr _H V_ ( _UρU_ _[†]_ ) _V_ _[†]_ [�]
_U_ _V_




           = Tr [ _H ρ_ ] min Tr _H V ρV_ _[†]_ [�] = Erg ( _ρ_ ) _._ (C2)
_−_ _V_



Thus, observational ergotropy of a state is at most the true ergotropy, i.e. Erg ( _ρ_ ) _−_ Ergobs ( _ρ_ ) _≥_ 0.
For the second part, we prove that



Erg ( _ρ_ ) Ergobs ( _ρ_ )
_−_ _≥_ _[p]_ [max] _d_ _[ ·][ S]_




_[ ·][ S]_

_d_ _−_ [Tr[] _N_ _[H]_ []]



_._
_N_



First observe that, without loss of generality, we can assume that the eigenvalues of _H_ are non-negative. This is
because, for any _c >_ 0, we can always add _c_ I _N_ to _H_, without changing the difference between ergotropies. In other
words, ergotropy differences are invariant under the shift _H_ _H_ + _c_ I _N_ .
_�→_ _·_
The coarse-grained state � _ρ_ is a block-diagonal state (see Eq. (3)) and has _M_ distinct eigenvalues _{pi/d}i_ _[M]_ =1 [, each]
with degeneracy _d_ . The maximum eigenvalue of � _ρ_ is given by _p_ max _/d_, where _p_ max = max _i pi_ . Let us reorder the block
probabilities such that


_p_ _[↓]_ 1 [=] _[ p]_ [max] _[ ≥· · · ≥]_ _[p]_ _M_ _[↓]_ _[.]_


22


Also, write the energy eigenvalues of _H_, denoted as _E_ 1 _E_ 2 _[n]_, in nondecreasing order. Define contagious block
sums _≤· · ·_


         - _jd_



_Sj_ =



_Ei,_ (C3)

_i_ =( _j−_ 1) _d_ +1



for _j ∈_ [1 _, M_ ]. Note that _S_ 1 = _S_ . Then, the minimum over unitaries that permute the eigenbasis of � _ρ_ is obtained by
pairing the largest eigenvalues of � _ρ_ with the smallest energy eigenvalues. Hence,




    min Tr _H V_ - _ρV_ _[†]_ [�] = [1]
_V_ _d_




- _M_

_p_ _[↓]_ _j_ _[S][j]_
_j_ =1



_,_

_≥_ _[p]_ [max] _d_ _[S]_



where the lower bound in the last line follows from the fact that each term in the sum is non-negative. On the other
hand, for any state _ρ_,

min Tr[ _HV ρV_ _[†]_ ] E _V_ Tr[ _HV ρV_ _[†]_ ] = Tr[ _H_ ] _/_ 2 _[n]_ _._
_V_ _≤_


Combining these, we conclude the proof of the lemma.


This bound shows that the gap between the ergotropy and the observational ergotropy is controlled by two competing
contributions: the probability weight _p_ max of the most likely projective measurement outcome, and the average energy
contained in the lowest-energy subspace of dimension _d_ = 2 _[r]_ . Whenever _p_ max is sufficiently larger than the uniform
outcome 1 _/N_, the state _ρ_ necessarily places more weight in the low-energy sector than the coarse-grained description
suggests, ensuring a strict positive lower bound on the gap. We emphasize, however, that Lemma A6 does not
guarantee absolute positivity in all cases; when the block probabilities are too evenly distributed, the bound may
vanish. Nonetheless, whenever it is positive, the lemma provides a concrete quantitative witness for the excess
ergotropy accessible through optimized global unitaries.


**Appendix D: Estimating observational ergotropy using Linear Combination of Unitaries**


In this section, we discuss a different approach for estimating observational ergotropy. It is, in principle, possible
to use a different sampling strategy to implement a direct sum of Haar random matrices in Protocol 1. For this,
we express this quantity (which is itself a unitary) as a Linear Combination of Unitaries (LCU) [88]. Observe that
_V_ = _⊕i_ _[M]_ =1 _[V]_ [�] _[i]_ [ can be expressed as as a linear combination of 2] _[M]_ [ unitaries as follows:]




- _M_


_i_ =1



�2 _M_

_cjWj,_

_j_ =1



_V_ = _i_ =1 _[V]_ [�] _[i]_ [=]
_⊕_ _[M]_




- _M_

_|i⟩⟨i| ⊗_ _V_ [�] _i_ =
_i_ =1



I _M_ + _I_ [�] _i_

_Vi_ =
2 _⊗_ [�]



where _I_ [�] _i_ = 2 _|i⟩⟨i| −_ I _M_ is a diagonal unitary matrix and _cj_ = 1 _/_ 2 for all _j ∈_ [2 _M_ ]. The matrices _Wj_ above are
unitaries and are defined as



_Wj_ =











I _M ⊗_ _V_ [�] _j_ if 1 _≤_ _j ≤_ _M_



(D1)
_I_ - _j−M ⊗_ _V_ - _j−M_ if _M < j ≤_ 2 _M._



Even though this framework has been central to the development of a number of near-optimal quantum algorithms

[88, 94–97], it is quite resource-demanding as it requires several ancilla qubits and multi-qubit controlled operations
to be implemented. However, recently, a randomized quantum algorithm for LCU was introduced [96], which requires
circuits of shorter depth and only a single ancilla qubit. So, instead of randomly sampling an element from the
_r_ -qubit Pauli group _P_ ( _r_ ) as described in Protocol 1, we can implement _V_ by using the Single-Ancilla LCU algorithm
of Ref. [96]. However, we prove that this leads to a substantial increase in the sample complexity.
Let us first consider a unitary 1-design _Q_ := _{R_ 1 _, · · ·, RL}_ of cardinality _L_ on the spaces _Hi_ whose dimensions are
the same for all _i ∈_ [ _M_ ]. Here _Ri_, for all _i ∈_ [ _L_ ], are unitaries acting on _Hj_ for all _j ∈_ [ _M_ ]. Further, let us define a
set S of cardinality _L_ _[M]_ as follows.

               -               S := _i_ =1 _[V]_ [�] _[i]_ _._ (D2)
_⊕_ _[M]_ _[|]_ [ �] _[V][i]_ _[∼]_ _[Q,][ ∀]_ _[i][ ∈]_ [[] _[M]_ []]

In the following lemma we prove that S is itself a unitary 1-design on _⊕i_ _[M]_ =1 _[H][i]_ [.]


23


**Lemma A7.** _The set_ S _, Eq._ (D2) _, of direct sums of unitaries_ _V_ [�] _i on Hilbert spaces Hi for i ∈_ [ _M_ ] _sampled from a_
_unitary_ 1 _-design constitute a unitary_ 1 _-design on ⊕i_ _[M]_ =1 _[H][i][ with respect to the product measure.]_

_Proof._ Note that averaging of an unknown state� - _ρ_ with respect to _i_ =1 _[V]_ [�] _[i]_ [ =] _[ V]_ [ sampled from the Haar measure]
_⊕_ _[M]_

d _µ_ ( _V_ ) = [�] _[M]_ _i_ =1 [d] _[µ]_ _V_ - _i_ produces


_̸_


_̸_


_̸_


_̸_






_̸_


_̸_


_̸_


_̸_




- _m_ - - 
d _µ_ _V_  - _i_ =

_i_ =1 _i_


_̸_


_̸_


_̸_


_̸_




  - _m_
_V ρV_ _[†]_
_V_


_̸_


_̸_


_̸_


_̸_



_Pi_
_pi_ (D3)
2 _[r]_ _[,]_
_i_


_̸_


_̸_


_̸_


_̸_



where _pi_ = Tr [ _ρPi_ ] and Tr [ _Pi_ ] = 2 _[r]_ is the dimension of the each block on which _Pi_ is the projector. Now consider
_∀i ∈_ [ _M_ ], _V_ [�] _i_ is sampled from a unitary 1-design _Q_ = _{R_ 1 _, · · ·, RL}_ of cardinality _L_ . Further, let the elements of _S_ be
given by _Vi_ with _i_ = 1 _, · · ·, L_ _[M]_ . Each _Vi_ is of the form _⊕i_ _[M]_ =1 _[V]_ [�] _[i]_ [. To prove the lemma, it is sufficient to prove that]


_̸_


_̸_


_̸_


_̸_






_̸_


_̸_


_̸_


_̸_




- _M_ - - 1

d _µ_ _V_  - _i_ =
_L_ _[M]_
_i_ =1


_̸_


_̸_


_̸_


_̸_




- _L_ _[M]_

_VkρVk_ _[†]_
_k_ =1


_̸_


_̸_


_̸_


_̸_




  - _M_
_V ρV_ _[†]_
_V_


_̸_


_̸_


_̸_


_̸_




- _M_


_i,j_ =1


_̸_


_̸_


_̸_


_̸_




- _L_ _[M]_

_VkPiρPjVk_ _[†][,]_ (D4)
_k_ =1


_̸_


_̸_


_̸_


_̸_



=


_̸_


_̸_


_̸_


_̸_



1
_L_ _[M]_


_̸_


_̸_


_̸_


_̸_



where _Pi_ is a projector for all _i ∈_ [ _M_ ] and [�] _[M]_ _i_ =1 _[P][i]_ [ =][ I] _[N]_ [. We analyze the cases] _[ i]_ [ =] _[ j]_ [ and] _[ i][ ̸]_ [=] _[ j]_ [ in Eq. (][D4][),]
separately.


_̸_


_̸_


_̸_


_̸_




                     -                     **For the i** = **j case** : In this case, the action of _Vk_ = _i_ =1 _[V]_ [�] _[i]_
_⊕_ _[M]_


_̸_


_̸_


_̸_


_̸_



**For the i** = **j case** : In this case, the action of _Vk_ = _i_ =1 _[V][i]_
_⊕_ _k_ [on] _[ P][i][ρP][i]_ [ corresponds to applying a unitary] _[ R][l]_

on the subspace defined by the projector _Pi_ . For each choice of _Rl_ in a given subspace _PiρPi_ we can have _L_ _[M]_ _[−]_ [1]


_̸_


_̸_


_̸_


_̸_



possible choices of _Rl_ in remaining _M_ 1 subspaces. This means that for each block we will have [�] _[L]_ _k_ _[M]_

[ �] _[L]_ _[†]_ _−_


_̸_


_̸_


_̸_


_̸_



possible choices of _Rl_ in remaining _M −_ 1 subspaces. This means that for each block we will have _[L]_ _k_ =1 _[V][k][P][i][ρP][i][V][ †]_ _k_ [=]

_L_ _[M]_ _[−]_ [1][ �] _[L]_ _l_ =1 _[R][l][P][i][ρP][i][R]_ _l_ _[†]_ [. Now we have]


_̸_


_̸_


_̸_


_̸_




- _M_ 1

_L_ _[M]_

_i_ =1


_̸_


_̸_


_̸_


_̸_




- _L_ _[M]_


_̸_


_̸_


_̸_


_̸_



_VkPiρPiVk_ _[†]_ [=]
_k_ =1


_̸_


_̸_


_̸_


_̸_




 =


_̸_


_̸_


_̸_


_̸_




- _L_


_̸_


_̸_


_̸_


_̸_



_RlPiρPiRl_ _[†]_
_l_ =1


_̸_


_̸_


_̸_


_̸_




- _M_


_̸_


_̸_


_̸_


_̸_



_i_ =1


_̸_


_̸_


_̸_


_̸_



1

_L_


_̸_


_̸_


_̸_


_̸_






_̸_


_̸_


_̸_


_̸_




      -       _V_  - _iPiρPi_  - _Vi_ _[†]_ [d] _[µ]_ _V_  - _i_ _,_ (D5)
_V_ - _i_


_̸_


_̸_


_̸_


_̸_



_i_


_̸_


_̸_


_̸_


_̸_



where _V_ [�] _i ≡_ _V_ [�] _i ⊕j̸_ = _i_ 0.


_̸_


_̸_


_̸_



_̸_

                   -                    **For the i** = **j case** : For _i_ = _j_, the action of _Vk_ = _i_ =1 _[V]_ [�] _[i]_
_̸_ _̸_ _⊕_ _[M]_


_̸_


_̸_


_̸_



_̸_


_k_ [on] _[ P][i][ρP][j]_ [ corresponds to applying two unitaries:] _[ R][l]_


_̸_


_̸_


_̸_



_̸_


from left on block _i_ and _Rl_ _[†][′]_ [ from right on block] _[ j]_ [. Given any two choices of] _[ R][l]_ [ and] _[ R]_ _l_ _[′]_ [ in the] _[ i][th]_ [ and] _[ j][th]_ [ block,]
respectively, of _⊕i_ _[M]_ =1 _[V]_ [�] _[i]_ [ we can have] _[ L][M]_ _[−]_ [2][ possible choices of] _[ V][l]_ [ in the remaining blocks of] _[ ⊕]_ _i_ _[M]_ =1 _[V]_ [�] _[i]_ [. In particular, we]
have


_̸_


_̸_


_̸_



_̸_




_i̸_ = _j_


_̸_


_̸_



_̸_


- _L_ _[M]_

_VkPiρPjVk_ _[†]_

_̸_ _k_ =1


_̸_


_̸_



_̸_


- _L_ _[M]_


_̸_


_̸_


_̸_



_̸_


1
_L_ _[M]_

_̸_


_̸_


_̸_



_̸_


_̸_


 =


_i̸_ = _j_

 =


_i̸_ = _j_



_̸_


_̸_


1
_L_ [2]

_̸_


_̸_



_̸_


_̸_


_RlPiρPjRl_ _[†][′]_

_̸_ _l,l_ _[′]_ =1


_̸_



_̸_


_̸_


- _L_


_̸_


_̸_



_̸_


_̸_


_̸_



_̸_



_̸_


_̸_


_̸_

       -        -        -        _V_   - _iPiρPj_   - _Vj_ _[†]_ [d] _[µ]_ _V_   - _i_ d _µ_ _V_   - _j_ _._ (D6)

_̸_ _V_ - _i,V_ - _j_



_̸_


_̸_


_̸_


_̸_


Now combining Eqs. (D5) and (D6), we get



_̸_


_̸_


_̸_


_̸_


  - _M_
_V ρV_ _[†]_
_V_



_̸_


_̸_


_̸_


_̸_


- _M_ - 
d _µ_ _V_  - _i_ _,_

_i_ =1



_̸_


_̸_


_̸_


_̸_


1
_L_ _[M]_



_̸_


_̸_


_̸_


_̸_


- _L_ _[M]_ 
_VkρVk_ _[†]_ [=]
_k_ =1



_̸_


_̸_


_̸_


_̸_


- _L_ _[M]_



_̸_


_̸_


_̸_


_̸_


where _V_ = _⊕i_ _[M]_ =1 _[V]_ [�] _[i]_ [. This concludes the proof of the lemma.]


24



**Protocol 3:** `Work Extraction using Single-Ancilla LCU`


1. With probability 1 _/_ 2, perform energy measurement on unknown state _ρ_ .


2. With probability 1 _/_ 2, execute steps 2( _a_ ) to 2( _e_ ).


(a) Prepare the state _ρ_ 1 = _|_ + _⟩⟨_ + _| ⊗_ _ρ_ .

(b) Sample an integer _ℓ_ uniformly at random from [1 _, L_ _[M]_ ] to select _Qℓ_ = _{Wj,ℓ}_ [2] _j_ =1 _[M]_ [.]


(c) Obtain i.i.d. samples _W_ 1 _, W_ 2 from the distribution _{Wj,ℓ,_ 1 _/_ (2 _M_ ) _}_ .

(d) Define _W_ [�] 1 = _|_ 0 _⟩⟨_ 0 _| ⊗_ I _N_ + _|_ 1 _⟩⟨_ 1 _| ⊗_ _W_ 1 and _W_ [�] 2 = _|_ 0 _⟩⟨_ 0 _| ⊗_ _W_ 2 + _|_ 1 _⟩⟨_ 1 _| ⊗_ I _N_ . Obtain the state _ρ_ _[′]_ from _ρ_ as


                             -                              _ρ_ _[′]_ = (I2 _⊗_ _U_ gl) _W_ [�] 2 _W_ [�] 1 _ρ_ 1 _W_ [�] 1 _[†]_ _W_ [�] 2 _[†]_ I2 _⊗_ _U_ gl _[†]_ _._


Perform measurement of _−X ⊗_ _H_ on the state _ρ_ _[′]_ .

(e) Multiply _M_ [2] to the measurement outcome.


3. For the _j_ [th] iteration, store the outcome _ζj_, which on an average (as Steps 1 and 2 occur with probability 1 _/_ 2 each)

takes value 2 [1]  - _λj_ + _M_ [2] _λ_ [�] _j_ �, where _λj ∈{E_ 1 _, · · ·, Es}_ and _λ_ [�] _j ∈{±E_ 1 _, · · ·, ±Es}_ .

4. Repeat Steps 1 to 3 for _T_ times to obtain values _{ζ_ 1 _, · · ·, ζT }_ and output _ζ_ := _T_ [2] - _Tj_ =1 _[ζ][j]_ [.]




              -              - _M_
_Integrated sampling strategy_ :–We sample _V_ - _i_



_i_ =1 [from the Pauli group of] _[ L]_ [ elements. This set then naturally induces]



the set - _Wi_ _i_ =1 [of 2] _[M]_ [ elements (see Eq. (][D1][)). There are] _[ L][M]_ [ such sets] _[ {][W][i][}]_ [, let us denote them by] - _[ Q][ℓ]_ [=] _[ {][W][i,ℓ][}]_ _i_ [2] =1 _[M]_
_{_ _}_ [2] _[M]_
for _ℓ_ _∈_ _L_ _[M]_ [�] . Thus, in Protocol 3, we can effectively do the following: sample an integer _ℓ_ _∈_ _L_ _[M]_ [�] uniformly at
random to select the set _Qℓ_ . Now, we can proceed by obtaining i.i.d. samples _W_ 1 _, W_ 2 according to the ensemble

- _Wi,ℓ,_ 2 _M_ 1 �2 _i_ =1 _M_ [. Then by following the steps of Protocol][ 3][, we output some] _[ µ][j]_ [ such that for any observable] _[ O]_ [,]












- _L_ _[M]_


_ℓ_ =1



 _,_ (D7)



E[ _µj_ ] = Tr



1
 _O_
_L_ _[M]_



_W ℓρW_ _[†]_ _ℓ_



where _W ℓ_ = [�][2] _j_ =1 _[M]_ _[W][j,ℓ][/]_ [(2] _[M]_ [). We can formally state the steps of Protocol][ 3][.]



**Remark 1.** _In step 1 of Protocol 3, the outcomes for the measurement of H are the eigenvalues of H. In step 2(d),_
_when we are measuring −X ⊗_ _H, for each eigenvalue of H, there are two possible outcomes of X, namely, {_ +1 _, −_ 1 _}._

**Theorem 2.** _Suppose ε, δ ∈_ (0 _,_ 1) _. Let H be an n-qubit Hamiltonian and ρ ∈DN be an N_ = 2 _[n]_ _-dimensional unknown_
_density matrix. Then Protocol 3 outputs ζ satisfying, |ζ −_ Ergobs ( _ρ_ ) _| ≤_ _ε with success probability at least_ 1 _−_ _δ for_



_δ_




- [�]



_T_ = _O_




_M_ [4] _∥H∥_ [2]




   
_H_ 1
_∥_ _∥_ [2] log

_ε_ [2] _δ_



_._ (D8)



_Further, if the unitary U_ gl _can be constructed with gate depth τg and τ_ max _is the upper bound on the gate depth of the_
_most expensive Wj,ℓ, the cost of each run is at most_ 2 _τ_ max + _τg._

_Proof._ In each run of the protocol, with probability 1 _/_ 2, protocol measures _H_ = [�] _[s]_ _a_ =1 _[E][a][Q][a]_ [ (see Eq. (][13][)) in the]
state _ρ_ . This results in an outcome _Ea_ with probability _qa_ = Tr [ _ρQa_ ], where _a ∈_ [ _s_ ]. Step 2, with probability 1 _/_ 2,
performs measurement of _−X ⊗_ _H_ on the state _ρ_ _[′]_, where

                         -                          _ρ_ _[′]_ = (I2 _⊗_ _U_ gl) _W_ [�] 2 _W_ [�] 1 _ρ_ 1 _W_ [�] 1 _[†]_ _W_ [�] 2 _[†]_ I2 _⊗_ _U_ gl _[†]_ _._

In the expression for _ρ_ _[′]_, _W_ [�] 1 and _W_ [�] 2 are unitaries sampled with probability 1 _/_ (2 _M_ ) each indirectly from _Ql_, which
itself is sampled with probability 1 _/L_ _[M]_ . Simplifying _ρ_ _[′]_, we have



_ρ_ _[′]_ := _ρ_ _[′]_ ( _W_ 1 _, W_ 2; _Qℓ_ )




      = (I2 _⊗_ _U_ gl) _|_ 0 _⟩⟨_ 0 _| ⊗_ _W_ 2 _ρW_ 2 _[†]_ [+] _[ |]_ [0] _[⟩⟨]_ [1] �� _[| ⊗]_ _[W]_ [2] _[ρW][ †]_ 1



��              + _|_ 1 _⟩⟨_ 0 _| ⊗_ _W_ 1 _ρW_ 2 _[†]_ [+] _[ |]_ [1] _[⟩⟨]_ [1] _[| ⊗]_ _[W]_ [1] _[ρW][ †]_ 1 I2 _⊗_ _U_ gl _[†]_ _._


25



We have _X_ = [�] _r∈{_ 1 _,−_ 1 _}_ _[r]_ [ Π] _[r]_ [, where Π][1][ =] _[ |]_ [+] _[⟩⟨]_ [+] _[|]_ [ and Π] _[−]_ [1][ =] _[ |−⟩⟨−|]_ [. Thus, measurement in step 2 results in]
outcomethe Protocol _−M_ 3 [2] results in an independent and identically distributed random variable. Let us call this random variable _r × Ea_ with probability Tr [ _ρ_ _[′]_ Π _r ⊗_ _Qa_ ] := _qra_ for fixed _W_ 1 _, W_ 2 and _Qℓ_ . Each run of steps 1 and 2 of
_Y_ and it takes values _Ea_ with probability _qa/_ 2 and _M_ [2] _r Ea_ with probability _qra/_ 2 for fixed _W_ 1 _, W_ 2 and _Qℓ_ . That
_−_                     -                     -                     - _T_
is, E [ _ζj_ ] = E [ _Y_ ] for all _j_ [ _T_ ]. This also implies that E _ζ_ = _T_ [2] _j_ =1 [E][ [] _[ζ][j]_ [] = 2][E][ [] _[Y]_ [ ]. The expectation value of] _[ Y]_ [ is]
_∈_




 - _a_
_ζ_ = [2]



_a_ _a_             -             - _a_             - _T_ _ra_ 1 2 _ℓ_
is, E [ _ζj_ ] = E [ _Y_ ] for all _j_ [ _T_ ]. This also implies that E _ζ_ = _T_ [2] _j_ =1 [E][ [] _[ζ][j]_ [] = 2][E][ [] _[Y]_ [ ]. The expectation value of] _[ Y]_ [ is]
_∈_

given by






_r∈{±_ 1 _}_




- _s_

_rEa_ Tr [ _ρ_ _[′]_ Π _r_ _Qa_ ]
_a_ =1 _⊗_




- _s_



E[ _Y_ ] = [1]

2




- _s_



_M_ [2]
_Ea_ Tr [ _ρQa_ ] _−_ E _W_ 1 _,W_ 2 _,Qℓ_ 2
_a_ =1



2




[1]

2 [Tr [] _[ρH]_ []] _[ −]_ _[M]_ 2 [ 2]



= [1]



2 [Tr [][E] _[W]_ [1] _[,W]_ [2] _[,Q][ℓ]_ [[] _[ρ][′]_ []] _[ X][ ⊗]_ _[H]_ []]



= [1]

2 [Tr [] _[H]_ [ (] _[ρ][ −]_ _[ρ][′′]_ [)]] _[,]_




                            where _ρ_ _[′′]_ = _M_ [2] _U_ glE _W_ 1 _,W_ 2 _,Qℓ_ Tr _[′]_ [ _ρ_ _[′]_ _X_ I _N_ ] _U_ gl _[†]_ [=] _[ M]_ [ 2] _[U]_ [gl][E] _[Q]_ _ℓ_
_⊗_                -                


1 2 _ℓ_               -               
first system. Further, _W ℓ_ = [�][2] _j_ =1 _[M]_ _[W][j,ℓ][/]_ [(2] _[M]_ [) =] _⊕j_ _[M]_ =1 _[V]_ [�] _[j]_




    _W ℓρW_ _[†]_ _ℓ_ _U_ gl _[†]_ [, and Tr] _[′]_ [ denotes the trace with respect to]



_l_ _[/M]_ [ = (] _[V]_ [ )] _[l][ /M]_ [. Thus, we have]




 -  E _ζ_ = 2E[ _Y_ ]






 _HU_ gl



_l_ _[U]_ gl _[ †]_



1
= Tr [ _Hρ_ ] _−_ _L_ _[M]_ [Tr]




- _L_ _[M]_











   -   - ��
= Tr _H_ _ρ_ _U_ gl _ρU_ - gl _[†]_
_−_

= Ergobs ( _ρ_ ) _,_




- _L_ _[M]_ 
( _V_ ) _l ρ_ _V_ _[†]_ [�]
_l_ =1



where _V_ = _⊕_ - _j_ _[M]_ �=1 _[V]_ [�] _[j]_ [ and][ �] _[ρ]_ [ is given by Eq. (][3][). But the protocol gives us the sample average, i.e,] - _[ ζ]_ [ = (2] _[/T]_ [)][ �] _j_ _[T]_ =1 _[ζ]_ - _[j]_
instead of E _ζ_ = Ergobs ( _ρ_ ). The random variable 2 _Y_ takes values in the interval _−_ 2(1 + _M_ [2] ) _∥H∥,_ 2(1 + _M_ [2] ) _∥H∥_ .

Now, applying Hoeffding’s inequality to _ζ_, we have



Pr ��� _ζ −_ Ergobs ( _ρ_ )�� _≥_ _ε_ - _≤_ 2 exp




_−Tε_ [2]

8 (1 + _M_ [2] ) [2] _∥H∥_ [2]







_._



Thus, taking


ensures that


Thus, it is sufficient to choose




   1 + _M_ [2][�][2] _H_
_T_ _∥_ _∥_ [2]
_≥_ [8] _ε_ [2]




    
[2][�][2] _H_ 2
_∥_ _∥_ [2] ln

_ε_ [2] _δ_







_δ_



Pr ��� _ζ −_ Ergobs ( _ρ_ )�� _< ε_ - _≥_ 1 _−_ _δ._



_δ_




- [�]



_T_ = _O_




_M_ [4] _∥H∥_ [2]




   
_H_ 1
_∥_ _∥_ [2] log

_ε_ [2] _δ_



to estimate the observational egrotropy with an additive error _ε_ and success probability at least 1 _−_ _δ_ for all _ε >_ 0
and 0 _< δ <_ 1.


As mentioned previously, the sample complexity is exponentially worse than Protocol 1 of the main article as the
factor _M_ [4] can scale as a polynomial in the dimension _N_ .


26



**Appendix E: Robustness of the observational ergotropy: A simple example**


Consider a 4-qubit system ( _N_ = 16) with the coarse-grained state



_ρ_ - =



�4


_i_ =1



_pi_
2 _[r]_ _[P][i][,]_ (E1)



where each block projector _Pi_ has _d_ = 2 _[r]_ = 4 dimensions and corresponds to a maximally mixed state in that
subspace. Let the actual measurement probabilities be given as


_p_ 1 = 0 _._ 40 _,_ _p_ 2 = 0 _._ 37 _,_ _p_ 3 = 0 _._ 15 _,_ _p_ 4 = 0 _._ 08 _._


Let the single qubit Hamiltonian be given by _|_ 1 _⟩⟨_ 1 _|_ . Then the total 4-qubit Hamiltonian has energy levels with
degeneracies _g_ 0 = 1, _g_ 1 = 4, _g_ 2 = 6, _g_ 3 = 4 and _g_ 4 = 1 corresponding to energy eigenvalues 0, 1, 2, 3, and 4,
respectively. Let us define the following sets


_A_ 1 = _{|_ 0000 _⟩_ _, |_ 0001 _⟩_ _, |_ 0010 _⟩_ _, |_ 0100 _⟩},_
_A_ 2 = _{|_ 1000 _⟩_ _, |_ 0011 _⟩_ _, |_ 0101 _⟩_ _, |_ 0110 _⟩},_
_A_ 3 = _{|_ 1001 _⟩_ _, |_ 1010 _⟩_ _, |_ 1100 _⟩_ _, |_ 0111 _⟩},_
_A_ 4 = _{|_ 1011 _⟩_ _, |_ 1101 _⟩_ _, |_ 1110 _⟩_ _, |_ 1111 _⟩}._

The global unitary _U_ gl, estimating the observational ergotropy, maps eigenstates in block _Pi_ to eigenstates in _Ai_ for
_i_ = 1 _,_ 2 _,_ 3 _,_ 4. Then the observational ergotropy is given by

Ergobs ( _ρ_ ) = Tr[ _ρH_ ] _−_ 4 [1] [[0] _[.]_ [4] _[ ×]_ [ 3 + 0] _[.]_ [37] _[ ×]_ [ (1 + 2] _[ ×]_ [ 3) + 0] _[.]_ [15] _[ ×]_ [ (2] _[ ×]_ [ 3 + 3) + 0] _[.]_ [08] _[ ×]_ [ (3] _[ ×]_ [ 3 + 4)]]

= Tr[ _ρH_ ] _−_ 4 [1] [[1] _[.]_ [20 + 2] _[.]_ [59 + 1] _[.]_ [35 + 1] _[.]_ [04]]

= Tr[ _ρH_ ] _−_ 1 _._ 545 _._ (E2)


Suppose the estimated probabilities have an error of order 0 _._ 05, i.e. _ε_ = 0 _._ 05, and the estimated probabilities are
obtained as


_p_ ˜1 = 0 _._ 36 _,_ _p_ ˜2 = 0 _._ 39 _,_ _p_ ˜3 = 0 _._ 18 _,_ _p_ ˜4 = 0 _._ 07 _._


Here ˜ _p_ 2 _>_ ˜ _p_ 1, so the changed global unitary _U_ [�] gl, determining the guessed observational ergotropy, and the global
unitary _U_ gl differ by a swap of blocks _P_ 1 and _P_ 2. _U_ �gl maps eigenstates in block _Pπ_ ( _i_ ) to eigenstates in _Ai_ for
_i_ = 1 _,_ 2 _,_ 3 _,_ 4. Here _π_ is a permutation of four objects defined as _π_ (1) = 2, _π_ (2) = 1, _π_ (3) = 3 and _π_ (4) = 4. Then the
guessed observational ergotropy is given by


Erg� obs( _ρ_ ) = Tr[ _ρH_ ]
_−_ 4 [1] [[0] _[.]_ [37] _[ ×]_ [ 3 + 0] _[.]_ [4] _[ ×]_ [ (1 + 2] _[ ×]_ [ 3) + 0] _[.]_ [15] _[ ×]_ [ (2] _[ ×]_ [ 3 + 3) + 0] _[.]_ [08] _[ ×]_ [ (3] _[ ×]_ [ 3 + 4)]]

= Tr[ _ρH_ ] _−_ 4 [1] [[1] _[.]_ [11 + 2] _[.]_ [8 + 1] _[.]_ [35 + 1] _[.]_ [04]]



= Tr[ _ρH_ ] _−_ 1 _._ 575 _,_ (E3)



�4
Thus, ����Ergobs( _ρ_ ) _−_ Ergobs ( _ρ_ )��� = 0 _._ 03. Now the upper bound in Eq. (12) of Lemma 2 is given by _∥H∥_ _i_ =1 �� _pi −_ _pπ_ ( _i_ )�� =



4 2 _p_ 1 _p_ 2 = 0 _._ 24.
_×_ _|_ _−_ _|_




[1] J. Goold, M. Huber, A. Riera, L. del Rio, and P. Skrzypczyk, The role of quantum information in thermodynamics—a
[topical review, J. Phys. A: Math. Theor.](https://doi.org/10.1088/1751-8113/49/14/143001) **49**, 143001 (2016).

[[2] S. Vinjanampathy and J. Anders, Quantum thermodynamics, Contemp. Phys.](https://doi.org/10.1080/00107514.2016.1201896) **57**, 545 (2016).

[3] F. Binder, L. A. Correa, C. Gogolin, J. Anders, and G. Adesso, eds., _[Thermodynamics in the Quantum Regime](https://doi.org/https://doi.org/10.1007/978-3-319-99046-0)_, Fundamental
Theories of Physics (Springer, Cham, Switzerland, 2018).

[4] S. Deffner and S. Campbell, _[Quantum Thermodynamics](https://doi.org/10.1088/2053-2571/ab21c6)_, 2053-2571 (Morgan & Claypool, Kentfield, CA, 2019).


27


[5] M. N. Bera, A. Riera, M. Lewenstein, Z. B. Khanian, and A. Winter, Thermodynamics as a Consequence of Information
Conservation, Quantum **3** [, 121 (2019).](https://doi.org/10.22331/q-2019-02-14-121)

[[6] P. P. Potts, Quantum Thermodynamics (2024), arXiv:2406.19206 [quant-ph].](https://arxiv.org/abs/2406.19206)

[7] A. Auff`eves, Quantum Technologies Need a Quantum Energy Initiative, PRX Quantum **[3](https://doi.org/10.1103/PRXQuantum.3.020101)**, 020101 (2022).

[[8] F. Cleri, Quantum computers, quantum computing and quantum thermodynamics (2024), arXiv:2404.09663 [quant-ph].](https://arxiv.org/abs/2404.09663)

[[9] N. Arora and P. Kumar, Sustainable quantum computing: Opportunities and challenges of benchmarking carbon in the](https://arxiv.org/abs/2408.05679)
[quantum computing lifecycle (2024), arXiv:2408.05679 [quant-ph].](https://arxiv.org/abs/2408.05679)

[[10] R. Alicki, The quantum open system as a model of the heat engine, J. Phys. A: Math. Gen.](https://dx.doi.org/10.1088/0305-4470/12/5/007) **12**, L103 (1979).

[11] M. O. Scully, Quantum Afterburner: Improving the efficiency of an ideal heat engine, Phys. Rev. Lett. **[88](https://doi.org/10.1103/PhysRevLett.88.050602)**, 050602 (2002).

[12] A. Dechant, N. Kiesel, and E. Lutz, All-Optical Nanomechanical Heat Engine, Phys. Rev. Lett. **[114](https://doi.org/10.1103/PhysRevLett.114.183602)**, 183602 (2015).

[13] J. Roßnagel, S. T. Dawkins, K. N. Tolazzi, O. Abah, E. Lutz, F. Schmidt-Kaler, and K. Singer, A single-atom heat engine,

Science **[352](https://doi.org/10.1126/science.aad6320)**, 325 (2016).

[14] G. Maslennikov, S. Ding, R. Habl¨utzel, J. Gan, A. Roulet, S. Nimmrichter, J. Dai, V. Scarani, and D. Matsukevich,
Quantum absorption refrigerator with trapped ions, Nat. Commun. **[10](https://doi.org/10.1038/s41467-018-08090-0)**, 202 (2019).

[15] J. Klatzow, J. N. Becker, P. M. Ledingham, C. Weinzetl, K. T. Kaczmarek, D. J. Saunders, J. Nunn, I. A. Walmsley,
R. Uzdin, and E. Poem, Experimental demonstration of quantum effects in the operation of microscopic heat engines,
Phys. Rev. Lett. **[122](https://doi.org/10.1103/PhysRevLett.122.110601)**, 110601 (2019).

[16] D. Ferraro, M. Campisi, G. M. Andolina, V. Pellegrini, and M. Polini, High-power collective charging of a solid-state
quantum battery, Phys. Rev. Lett. **[120](https://doi.org/10.1103/PhysRevLett.120.117702)**, 117702 (2018).

[17] X. Yang, Y.-H. Yang, M. Alimuddin, R. Salvia, S.-M. Fei, L.-M. Zhao, S. Nimmrichter, and M.-X. Luo, Battery capacity
of energy-storing quantum systems, Phys. Rev. Lett. **[131](https://doi.org/10.1103/PhysRevLett.131.030402)**, 030402 (2023).

[[18] F. Campaioli, S. Gherardini, J. Q. Quach, M. Polini, and G. M. Andolina, Colloquium: Quantum batteries, Rev. Mod.](https://doi.org/10.1103/RevModPhys.96.031001)
Phys. **96** [, 031001 (2024).](https://doi.org/10.1103/RevModPhys.96.031001)

[19] Y. Chu and J. Cai, Thermodynamic principle for quantum metrology, Phys. Rev. Lett. **[128](https://doi.org/10.1103/PhysRevLett.128.200501)**, 200501 (2022).

[[20] I. K. Kominis, Quantum thermodynamic derivation of the energy resolution limit in magnetometry (2024), arXiv:2405.14687](https://arxiv.org/abs/2405.14687)

[[quant-ph].](https://arxiv.org/abs/2405.14687)

[21] M. O. Scully, M. S. Zubairy, G. S. Agarwal, and H. Walther, Extracting work from a single heat bath via vanishing
quantum coherence, Science **[299](https://doi.org/10.1126/science.1078955)**, 862 (2003).

[[22] M. Horodecki and J. Oppenheim, Fundamental limitations for quantum and nanoscale thermodynamics, Nat. Commun.](https://doi.org/10.1038/ncomms3059)
**4** [, 2059 (2013).](https://doi.org/10.1038/ncomms3059)

[[23] F. Brand˜ao, M. Horodecki, N. Ng, J. Oppenheim, and S. Wehner, The second laws of quantum thermodynamics, Proc.](https://doi.org/10.1073/pnas.1411728112)
[Natl. Acad. Sci. U.S.A.](https://doi.org/10.1073/pnas.1411728112) **112**, 3275 (2015).

[[24] P. Skrzypczyk, A. J. Short, and S. Popescu, Work extraction and thermodynamics for individual quantum systems, Nat.](https://doi.org/10.1038/ncomms5185)
Commun. **5** [, 4185 (2014).](https://doi.org/10.1038/ncomms5185)

[25] U. Singh, M. G. Jabbour, Z. Van Herstraeten, and N. J. Cerf, Quantum thermodynamics in a multipartite setting: A
resource theory of local Gaussian work extraction for multimode bosonic systems, Phys. Rev. A **[100](https://doi.org/10.1103/PhysRevA.100.042104)**, 042104 (2019).

[26] T. A. B. Pinto Silva and D. Gelbwaser-Klimovsky, Quantum work: Reconciling quantum mechanics and thermodynamics,

Phys. Rev. Res. **[6](https://doi.org/10.1103/PhysRevResearch.6.L022036)**, L022036 (2024).

[27] A. Ac´ın, I. Bloch, H. Buhrman, T. Calarco, C. Eichler, J. Eisert, D. Esteve, N. Gisin, S. J. Glaser, F. Jelezko, S. Kuhr,
M. Lewenstein, M. F. Riedel, P. O. Schmidt, R. Thew, A. Wallraff, I. Walmsley, and F. K. Wilhelm, The quantum
technologies roadmap: a european community view, New J. Phys. **[20](https://doi.org/10.1088/1367-2630/aad1ea)**, 080201 (2018).

[28] L. Buffoni, S. Gherardini, E. Zambrini Cruzeiro, and Y. Omar, Third law of thermodynamics and the scaling of quantum
computers, Phys. Rev. Lett. **[129](https://doi.org/10.1103/PhysRevLett.129.150602)**, 150602 (2022).

[29] N. M. Myers, O. Abah, and S. Deffner, Quantum thermodynamic devices: From theoretical proposals to experimental
[reality, AVS Quantum Science](https://doi.org/10.1116/5.0083192) **4**, 027101 (2022).

[30] M. Fellous-Asiani, J. H. Chai, Y. Thonnart, H. K. Ng, R. S. Whitney, and A. Auff`eves, Optimizing resource efficiencies
for scalable full-stack quantum computers, PRX Quantum **[4](https://doi.org/10.1103/PRXQuantum.4.040319)**, 040319 (2023).

[31] I. Maillette de Buy Wenniger, S. E. Thomas, M. Maffei, S. C. Wein, M. Pont, N. Belabas, S. Prasad, A. Harouri,
A. Lemaˆıtre, I. Sagnes, N. Somaschi, A. Auff`eves, and P. Senellart, Experimental analysis of energy transfers between a
quantum emitter and light fields, Phys. Rev. Lett. **[131](https://doi.org/10.1103/PhysRevLett.131.260401)**, 260401 (2023).

[32] J. P. Moutinho, M. Pezzutto, S. S. Pratapsi, F. F. da Silva, S. De Franceschi, S. Bose, A. T. Costa, and Y. Omar, Quantum
dynamics for energetic advantage in a charge-based classical full adder, PRX Energy **2** [, 033002 (2023).](https://doi.org/10.1103/PRXEnergy.2.033002)

[33] L. Arrachea, Energy dynamics, heat production and heat–work conversion with qubits: toward the development of quantum
[machines, Reports on Progress in Physics](https://doi.org/10.1088/1361-6633/acb06b) **86**, 036501 (2023).

[34] D. Jaschke and S. Montangero, Is quantum computing green? an estimate for an energy-efficiency quantum advantage,

[Quantum Science and Technology](https://doi.org/10.1088/2058-9565/acae3e) **8**, 025001 (2023).

[35] T. Van Vu, T. Kuwahara, and K. Saito, Fidelity-dissipation relations in quantum gates, Phys. Rev. Res. **[6](https://doi.org/10.1103/PhysRevResearch.6.033225)**, 033225 (2024).

[36] D. Majidi, J. P. Bergfield, V. Maisi, J. H¨ofer, H. Courtois, and C. B. Winkelmann, Heat transport at the nanoscale and
[ultralow temperatures—implications for quantum technologies, Applied Physics Letters](https://doi.org/10.1063/5.0204207) **124**, 140504 (2024).

[37] P. Lipka-Bartosik, M. Perarnau-Llobet, and N. Brunner, Thermodynamic computing via autonomous quantum thermal
machines, Science Advances **[10](https://doi.org/10.1126/sciadv.adm8792)**, eadm8792 (2024).

[38] A. Lenard, Thermodynamical proof of the Gibbs formula for elementary quantum systems, J. Stat. Phys. **[19](https://doi.org/10.1007/BF01011769)**, 575 (1978).

[[39] W. Pusz and S. L. Woronowicz, Passive states and kms states for general quantum systems, Commun. Math. Phys.](https://doi.org/10.1007/BF01614224) **58**,
[273 (1978).](https://doi.org/10.1007/BF01614224)


28


[[40] A. E. Allahverdyan, R. Balian, and T. M. Nieuwenhuizen, Maximal work extraction from finite quantum systems, Euro-](https://doi.org/10.1209/epl/i2004-10101-2)
physics Letters **[67](https://doi.org/10.1209/epl/i2004-10101-2)**, 565 (2004).

[41] D. Farina, G. M. Andolina, A. Mari, M. Polini, and V. Giovannetti, Charger-mediated energy transfer for quantum
batteries: An open-system approach, Phys. Rev. B **[99](https://doi.org/10.1103/PhysRevB.99.035421)**, 035421 (2019).

[42] U. Singh, S. Das, and N. J. Cerf, Partial order on passive states and Hoffman majorization in quantum thermodynamics,

[Phys. Rev. Research](https://doi.org/10.1103/PhysRevResearch.3.033091) **3**, 033091 (2021).

[43] K. Sen and U. Sen, Local passivity and entanglement in shared quantum batteries, Phys. Rev. A **[104](https://doi.org/10.1103/PhysRevA.104.L030402)**, L030402 (2021).

[[44] Swati, U. Singh, and G. Chiribella, A resource theory of activity for quantum thermodynamics in the absence of heat baths](https://arxiv.org/abs/2304.08926)

[(2023), arXiv:2304.08926 [quant-ph].](https://arxiv.org/abs/2304.08926)

[[45] R. P. A. Simon, J. Anders, and K. V. Hovhannisyan, Correlations enable lossless ergotropy transport, Phys. Rev. Lett.](https://doi.org/10.1103/PhysRevLett.134.010408)
**134** [, 010408 (2025).](https://doi.org/10.1103/PhysRevLett.134.010408)

[46] R. Castellano, D. Farina, V. Giovannetti, and A. Acin, Extended local ergotropy, Phys. Rev. Lett. **[133](https://doi.org/10.1103/PhysRevLett.133.150402)**, 150402 (2024).

[47] A. Bhattacharyya, K. Sen, and U. Sen, Noncompletely positive quantum maps enable efficient local energy extraction in
batteries, Phys. Rev. Lett. **[132](https://doi.org/10.1103/PhysRevLett.132.240401)**, 240401 (2024).

[[48] J. Joshi and T. S. Mahesh, Maximal work extraction unitarily from an unknown quantum state: Ergotropy estimation via](https://arxiv.org/abs/2409.04087)
[feedback experiments (2024), arXiv:2409.04087 [quant-ph].](https://arxiv.org/abs/2409.04087)

[[49] J. Xuereb, A. de Oliveira Junior, F. Clivaz, P. Bakhshinezhad, and M. Huber, What resources do agents need to acquire](https://arxiv.org/abs/2410.18167)
[knowledge in quantum thermodynamics? (2024), arXiv:2410.18167 [quant-ph].](https://arxiv.org/abs/2410.18167)

[50] R. Castellano, R. Nery, K. Simonov, and D. Farina, Parallel ergotropy: Maximum work extraction via parallel local unitary
operations, Phys. Rev. A **[111](https://doi.org/10.1103/PhysRevA.111.012212)**, 012212 (2025).

[[51] C. M. Caves, C. A. Fuchs, and R. Schack, Unknown quantum states: The quantum de Finetti representation, J. Math.](https://doi.org/10.1063/1.1494475)
Phys. **43** [, 4537 (2002).](https://doi.org/10.1063/1.1494475)

[52] U. Alvarez-Rodriguez, M. Sanz, L. Lamata, and E. Solano, The forbidden quantum adder, Sci. Rep. **5** [, 11983 (2015).](https://doi.org/10.1038/srep11983)

[53] J. Szangolies, H. Kampermann, and D. Bruß, Detecting entanglement of unknown quantum states with random measurements, New J. Phys. **[17](https://doi.org/10.1088/1367-2630/17/11/113051)**, 113051 (2015).

[[54] M. Oszmaniec, A. Grudka, M. Horodecki, and A. W´ojcik, Creating a superposition of unknown quantum states, Phys.](https://doi.org/10.1103/PhysRevLett.116.110403)
Rev. Lett. **116** [, 110403 (2016).](https://doi.org/10.1103/PhysRevLett.116.110403)

[[55] Z.-H. Li, M. Al-Amri, X.-H. Yang, and M. S. Zubairy, Counterfactual exchange of unknown quantum states, Phys. Rev.](https://doi.org/10.1103/PhysRevA.100.022110)
A **100** [, 022110 (2019).](https://doi.org/10.1103/PhysRevA.100.022110)

[[56] A. V. Lebedev and V. M. Vinokur, Time-reversal of an unknown quantum state, Commun. Phys.](https://doi.org/10.1038/s42005-020-00396-0) **3**, 129 (2020).

[[57] H.-C. Cheng, N. Datta, N. Liu, T. Nuradha, R. Salzmann, and M. M. Wilde, An invitation to the sample complexity of](https://arxiv.org/abs/2403.17868)
[quantum hypothesis testing (2024), arXiv:2403.17868 [quant-ph].](https://arxiv.org/abs/2403.17868)

[[58] A. Pensia, V. Jog, and P.-L. Loh, The sample complexity of simple binary hypothesis testing (2024), arXiv:2403.16981](https://arxiv.org/abs/2403.16981)

[[math.ST].](https://arxiv.org/abs/2403.16981)

[[59] Y. Zhu, T. Xiao, G. Zeng, G. Chiribella, and Y.-D. Wu, Controlling unknown quantum states via data-driven state](https://arxiv.org/abs/2406.05711)
[representations (2024), arXiv:2406.05711 [quant-ph].](https://arxiv.org/abs/2406.05711)

[[60] K. Watanabe and R. Takagi, Black box work extraction and composite hypothesis testing (2024), arXiv:2407.03400 [quant-](https://arxiv.org/abs/2407.03400)
[ph].](https://arxiv.org/abs/2407.03400)

[61] L. Zambrano, D. Farina, E. Pagliaro, M. M. Taddei, and A. Acin, Certification of quantum state functions under partial
information, Quantum **8** [, 1442 (2024).](https://doi.org/10.22331/q-2024-08-16-1442)

[62] M. Cramer, M. B. Plenio, S. T. Flammia, R. Somma, D. Gross, S. D. Bartlett, O. Landon-Cardinal, D. Poulin, and Y.-K.
[Liu, Efficient quantum state tomography, Nat. Commun.](https://doi.org/10.1038/ncomms1147) **1**, 149 (2010).

[63] R. O’Donnell and J. Wright, Efficient quantum tomography, in _[Proceedings of the Forty-Eighth Annual ACM Symposium](https://doi.org/10.1145/2897518.2897544)_
_[on Theory of Computing](https://doi.org/10.1145/2897518.2897544)_, STOC ’16 (Association for Computing Machinery, New York, NY, USA, 2016) p. 899–912.

[64] M. Ledoux, _[The Concentration of Measure Phenomenon](https://bookstore.ams.org/surv-89-s)_, Mathematical Surveys and Monographs, Vol. 89 (American
Mathematical Society, Providence, RI, 2005).

[65] D. Safr´anek, D. Rosa, and F. C. Binder, Work extraction from unknown quantum sources, [ˇ] [Phys. Rev. Lett.](https://doi.org/10.1103/PhysRevLett.130.210401) **130**, 210401
[(2023).](https://doi.org/10.1103/PhysRevLett.130.210401)

[[66] K. V. Hovhannisyan, R. P. A. Simon, and J. Anders, Concentration of ergotropy in many-body systems (2024),](https://doi.org/10.48550/arXiv.2412.19801)

[arXiv:2412.19801 [quant-ph].](https://arxiv.org/abs/2412.19801)

[67] D. Safr´anek, J. M. Deutsch, and A. Aguirre, Quantum coarse-grained entropy and thermalization in closed systems, [ˇ] [Phys.](https://doi.org/10.1103/PhysRevA.99.012103)
Rev. A **99** [, 012103 (2019).](https://doi.org/10.1103/PhysRevA.99.012103)

[68] D. Safr´anek, A. Aguirre, J. Schindler, and J. M. Deutsch, A brief introduction to observational entropy, [ˇ] [Foundations of](https://doi.org/10.1007/s10701-021-00498-x)
Physics **51** [, 101 (2021).](https://doi.org/10.1007/s10701-021-00498-x)

[[69] W. Hoeffding, Probability inequalities for sums of bounded random variables, Journal of the American Statistical Associ-](https://doi.org/10.1080/01621459.1963.10500830)
ation **58** [, 13 (1963).](https://doi.org/10.1080/01621459.1963.10500830)

[70] One could have also sampled from the _r_ -qubit Clifford group which is an exact 3-design [98, 99].

[71] S. Sachdev, _[Quantum Phase Transitions](https://doi.org/10.1017/CBO9780511973765)_, 2nd ed. (Cambridge University Press, 2011).

[72] Y. Quek, E. Kaur, and M. M. Wilde, Multivariate trace estimation in constant quantum depth, Quantum **8** [, 1220 (2024).](https://doi.org/10.22331/q-2024-01-10-1220)

[[73] V. Narasimhachar and G. Gour, Low-temperature thermodynamics with quantum coherence, Nature Communications](https://doi.org/10.1038/ncomms8689) **6**,
[7689 (2015).](https://doi.org/10.1038/ncomms8689)

[[74] K. R. W. Jones, Entropy of random quantum states, J. Phys. A: Math. Gen.](https://doi.org/10.1088/0305-4470/23/23/011) **23**, L1247 (1990).

[[75] K. Zyczkowski and H.-J. Sommers, Induced measures in the space of mixed quantum states, J. Phys. A: Math. Gen.](https://doi.org/10.1088/0305-4470/34/35/335) **34**,
[7111 (2001).](https://doi.org/10.1088/0305-4470/34/35/335)


29


[[76] K. Zyczkowski and H.-J. Sommers, Hilbert–Schmidt volume of the set of mixed quantum states, J. Phys. A: Math. Gen.](https://doi.org/10.1088/0305-4470/36/39/310)
**36** [, 10115 (2003).](https://doi.org/10.1088/0305-4470/36/39/310)

[77] M. J. W. Hall, Random quantum correlations and density operator distributions, Phys. Lett. A **[242](https://doi.org/https://doi.org/10.1016/S0375-9601(98)00190-X)**, 123 (1998).

[[78] P. B. Slater, A priori probabilities of separable quantum states, J. Phys. A: Math. Gen.](https://doi.org/10.1088/0305-4470/32/28/306) **32**, 5261 (1999).

[79] V. D. Milman and G. Schechtman, _[Asymptotic Theory of Finite Dimensional Normed Spaces](https://doi.org/https://doi.org/10.1007/978-3-540-38822-7)_ (Springer Berlin, Heidelberg,
1986).

[80] M. OSearc´oid, [´] _[Metric Spaces](https://doi.org/10.1007/978-1-84628-627-8)_ (Springer-Verlag London, 2007).

[81] M. Raginsky and I. Sason, Concentration of measure inequalities in information theory, communications, and coding,

[Found. Trends Commun. Inf. Theory](https://doi.org/10.1561/0100000064) **10**, 1 (2013).

[[82] P. Hayden, D. W. Leung, and A. Winter, Aspects of generic entanglement, Commun. Math. Phys.](https://doi.org/10.1007/s00220-006-1535-6) **265**, 95 (2006).

[[83] E. Meckes and M. Meckes, Spectral measures of powers of random matrices, Electron. Commun. Probab.](https://doi.org/10.1214/ECP.v18-2551) **18**, 1 (2013).

[84] R. Bhatia, _[Matrix Analysis](https://doi.org/10.1007/978-1-4612-0653-8)_, Graduate Texts in Mathematics (Springer-Verlag New York, 1997).

[85] S. Boucheron, G. Lugosi, and P. Massart, _[Concentration Inequalities: A Nonasymptotic Theory of Independence](https://doi.org/10.1093/acprof:oso/9780199535255.001.0001)_ (Oxford
University Press, 2013).

[86] G. M. Andolina, D. Farina, A. Mari, V. Pellegrini, V. Giovannetti, and M. Polini, Charger-mediated energy transfer in
exactly solvable models for quantum batteries, Phys. Rev. B **[98](https://doi.org/10.1103/PhysRevB.98.205423)**, 205423 (2018).

[[87] G. Chiribella, Y. Yang, and R. Renner, Fundamental energy requirement of reversible quantum operations, Phys. Rev. X](https://doi.org/10.1103/PhysRevX.11.021014)
**11** [, 021014 (2021).](https://doi.org/10.1103/PhysRevX.11.021014)

[[88] A. M. Childs and N. Wiebe, Hamiltonian simulation using linear combinations of unitary operations, Quantum Information](https://dl.acm.org/doi/10.5555/2481569.2481570)
[& Computation](https://dl.acm.org/doi/10.5555/2481569.2481570) **12**, 901 (2012).

[[89] S. Chakraborty, Implementing any Linear Combination of Unitaries on Intermediate-term Quantum Computers, Quantum](https://doi.org/10.22331/q-2024-10-10-1496)
**8** [, 1496 (2024).](https://doi.org/10.22331/q-2024-10-10-1496)

[90] `[https://github.com/uttamcft/Sample-Complexity-of-Work-Extraction](https://github.com/uttamcft/Sample-Complexity-of-Work-Extraction)` .

[91] P. W. Anderson, New approach to the theory of superexchange interactions, Phys. Rev. **[115](https://doi.org/10.1103/PhysRev.115.2)**, 2 (1959).

[92] A. Auerbach, _[Interacting Electrons and Quantum Magnetism](https://doi.org/10.1007/978-1-4612-0869-3)_ (Springer, New York, 1994).

[93] C. Kittel, _[Introduction to Solid State Physics](https://www.wiley.com/en-us/Introduction+to+Solid+State+Physics%2C+8th+Edition-p-9780471415268)_ (Wiley, 2004).

[94] D. W. Berry, A. M. Childs, R. Cleve, R. Kothari, and R. D. Somma, Simulating hamiltonian dynamics with a truncated
taylor series, Phys. Rev. Lett. **[114](https://doi.org/10.1103/PhysRevLett.114.090502)**, 090502 (2015).

[95] A. M. Childs, R. Kothari, and R. D. Somma, Quantum algorithm for systems of linear equations with exponentially
[improved dependence on precision, SIAM Journal on Computing](https://doi.org/10.1137/16M1087072) **46**, 1920 (2017).

[96] S. Chakraborty, A. Gily´en, and S. Jeffery, The Power of Block-Encoded Matrix Powers: Improved Regression Techniques
via Faster Hamiltonian Simulation, in _[46th International Colloquium on Automata, Languages, and Programming (ICALP](https://doi.org/10.4230/LIPIcs.ICALP.2019.33)_
_[2019)](https://doi.org/10.4230/LIPIcs.ICALP.2019.33)_, Leibniz International Proceedings in Informatics (LIPIcs), Vol. 132, edited by C. Baier, I. Chatzigiannakis, P. Flocchini, and S. Leonardi (Schloss Dagstuhl – Leibniz-Zentrum f¨ur Informatik, Dagstuhl, Germany, 2019) pp. 33:1–33:14.

[[97] J. van Apeldoorn, A. Gily´en, S. Gribling, and R. de Wolf, Quantum SDP-Solvers: Better upper and lower bounds, Quantum](https://doi.org/10.22331/q-2020-02-14-230)
**4** [, 230 (2020).](https://doi.org/10.22331/q-2020-02-14-230)

[[98] Z. Webb, The Clifford group forms a unitary 3-design, Quantum Info. Comput.](https://dl.acm.org/doi/abs/10.5555/3179439.3179447) **16**, 1379–1400 (2016).

[99] A. A. Mele, Introduction to Haar Measure Tools in Quantum Information: A Beginner’s Tutorial, Quantum **8** [, 1340 (2024).](https://doi.org/10.22331/q-2024-05-08-1340)


