**Fast computational deep thermalization**


Shantanav Chakraborty, [1,] _[ ∗]_ Soonwon Choi, [2,][ †] Soumik Ghosh, [3,][ ‡] and Tudor Giurgic˘a-Tiron [4,][ §]

1 _CQST and CSTAR, International Institute of Information Technology Hyderabad, Telangana 500032, India_
2 _Department of Physics, Massachusetts Institute of Technology, Cambridge, MA 02139, USA_
3 _Department of Computer Science, University of Chicago, Chicago, Illinois 60637, USA_
4 _QuICS, University of Maryland, College Park, Maryland 20742, USA_


Deep thermalization refers to the emergence of Haar-like randomness from quantum systems upon
partial measurements. As a generalization of quantum thermalization, it is often associated with high
complexity and entanglement. Here, we introduce _computational deep thermalization_ and construct the
fastest possible dynamics exhibiting it at infinite effective temperature. Our circuit dynamics produce
quantum states with low entanglement in polylogarithmic depth that are indistinguishable from Haar
random states to any computationally bounded observer. Importantly, the observer is allowed to request many copies of the same residual state obtained from partial projective measurements on the
state — this condition is beyond the standard settings of quantum pseudorandomness, but natural
for deep thermalization. In cryptographic terms, these states are pseudorandom, pseudoentangled,
and crucially, retain these properties under local measurements. Our results demonstrate a new form
of computational thermalization, where thermal-like behavior arises from structured quantum states
endowed with cryptographic properties, instead of from highly unstructured ensembles. The low
resource complexity of preparing these states suggests scalable simulations of deep thermalization
using quantum computers. Our work also motivates the study of computational quantum pseudorandomness beyond BQP observers.



Quantum thermalization is a universal phenomenon
occurring in generic interacting systems and underlies
the foundation of quantum statistical physics. Its key
feature is the emergence of universal randomness; despite being in pure states with no entropy, quantum systems may locally appear as if they are in maximally entropic thermal states [1–4].
Recent experiments enabled by a high-fidelity Rydberg quantum simulator discovered an intriguing possibility: in fact, quantum thermalization might be a special consequence of a stronger form of universal phenomena [5, 6]. _Deep thermalization_ refers to the behavior of highly entangled pure states that remain Haarlike even under partial projective measurements [6–10].
Specifically, when one subsystem is measured in some
fixed local basis, the resulting ensemble of conditional
states on the remaining qubits still looks maximal entropic, forming approximate _t_ -designs [11, 12]. That
is, _t_ -moments of these projected ensembles are indistinguishable from _t_ -moments of a Haar-random state,
also referred to as a _projected t-design_ . In this viewpoint, quantum thermalization reduces to the special
case _t_ = 1. Better understanding deep thermalization is an important problem with immediate implications in the study of quantum statistical physics as well
as practical applications in benchmarking [5], certifying state preparation [13, 14], and generating random
states [15, 16].


_∗_ [shchakra@iiit.ac.in](mailto:shchakra@iiit.ac.in)

[† soonwon@mit.edu](mailto:soonwon@mit.edu)

[‡ soumikghosh@uchicago.edu](mailto:soumikghosh@uchicago.edu)
[§ tudorgt@umd.edu](mailto:tudorgt@umd.edu)



While the conjectured behavior of deep thermalization has been explored through numerical simulations,
rigorous theoretical results remain scarce. Existing analyses apply only in highly restricted regimes, such as
when the bath (i.e. the measured sub-system) size is
infinite-dimensional [5, 8, 15], or for fixed, low values
of _t_ [6]. Meanwhile, both numerical and experimental observations suggest that projected designs emerge
far more quickly (at shallower depth circuits) than what
current mathematical proofs account for [5–7]. These
observations motivate a fundamental open question:
_What is the fastest route to generating quantum states that_
_appear deeply thermal to any physically reasonable observer?_
We leverage quantum complexity theory to provide
new perspectives on this question. The key insight is
that, in realistic settings, observers do not have unrestricted access to all properties of a quantum state, but
are instead constrained by the limits of efficient computation. A computationally bounded observer is one that
can perform only polynomial-time quantum computations. In this context, two ensembles of quantum states
are said to be _computationally indistinguishable_ if no such
observer can efficiently tell them apart, even though
they may be statistically distinct. Often, it turns out that
these limitations help us in mimicking Haar randomness very fast [17], with very low quantities of entanglement and other resources [18–23]. This raises a compelling possibility: perhaps the fastest route to prepare
deeply thermalized states is not via chaotic dynamics,
maximal entropy production, or exact unitary designs,
but rather through computational pseudorandomness.
However, it remains open whether existing constructions of pseudorandom states achieve the stronger notion of quantum randomness required for deep thermalization.


In this work, we construct an ensemble of _n_ -qubit
states using only polylogarithmic-depth circuits and
minimal entanglement, which are nevertheless _computa-_
_tionally indistinguishable_ from deeply thermalized states
at infinite temperatures. Specifically, our construction
satisfies the following three properties:


(i) The states are _computationally indistinguishable_
from Haar random states, upto _t_ copies, for _any_
_t_ = poly( _n_ ) (arbitrary polynomial in _n_ ).


(ii) The states need 1D geometrically local circuits of
depth _∼_ log [2] _n_ . The states have low entanglement
across geometric cuts, of the order _∼_ log [2] _n_ .


(iii) Across almost all bipartitions of the system, the
projected ensemble, obtained by measuring a part
of the system in the computational basis, is _also_
computationally indistinguishable from Haar random states upto _t_ = poly( _n_ ) copies and have a
similar entanglement profile to that of the premeasurement state.


We note that these conditions are chosen to be
as stringent as possible. Condition (i) ensures that
the global state looks (pseudo-)thermal at infinite
temperature. The logarithmic circuit depth and low
entanglement requirement in Condition (ii) saturate
the known lower bound for pseudorandom states [17].
Condition (iii) describes an additional requirement
specific to deep thermalization: the projected ensemble
must also appear pseudorandom while retaining low
entanglement. Crucially, this holds even when the bath
(i.e., the measured subsystem) is finite-sized (as small as
log [2] _n_ qubits). Therefore, Conditions (i) - (iii) combined
together ask for quantum circuits that make the most
drastic departure from all known analytical models
of deep thermalization [5–9], and instead aligns more
closely with what has been experimentally and numerically observed [5, 6]. Indeed, existing solvable models
for deep thermalization or preparing pseudorandom
states only partially satisfy these conditions, but to the
best of our knowledge, no known construction satisfies
all three conditions [24].


**Deep thermalization:** Consider a composite quantum system in an _N_ -dimensional Hilbert space
_HAB_ = _HA ⊗HB_, prepared in a pure state _|ψ⟩AB_,
where subsystems _A_ and _B_ have dimensions _NA_ and
_NB_, respectively. The phenomenon of _deep thermaliza-_
_tion_ refers to the emergence of approximate _projected_
_designs_ in subsystem _A_ upon performing a projective
measurement on subsystem _B_ in a fixed local basis (e.g.,
the computational basis _{|zk⟩}k∈{_ 0,1 _}NB_ ).
For instance, conditioned on outcome _k_, the postmeasurement state on subsystem _A_ is given by


( _k_ )� 1
��� _ψA_ := ~~_√p_~~ _k_ ( _I ⊗|zk⟩⟨zk|B_ ) _|ψ⟩AB_,



2


where _pk_ = _∥_ ( _I ⊗|zk⟩⟨zk|_ ) _|ψ⟩AB∥_ [2] . This defines an en
( _k_ )�
semble _{pk_, ��� _ψA_ _}_ on subsystem _A_ . The principle of
deep thermalization posits that this ensemble behaves,
in a precise sense, like an ensemble of Haar-random
states. Specifically, the _t_ -th moment operator of the
projected ensemble on _A_ approximates that of a Haarrandom pure state _|ϕ⟩_ on **C** _[N][A]_ :

**E** _k_ ��� _ψ_ ( _Ak_ )�� _ψ_ [(] _A_ _[k]_ [)] ��� _⊗t_ _−_ **E** _|ϕ⟩⟨ϕ|_ _[⊗][t]_ _≤_ negl( _n_ ),
����� _ϕ∼_ Haar( **C** _[NA]_ ) �����1


where negl( _n_ ) is a function that decays with the number
of qubits _n_, and _∥_ . _∥_ 1 is the 1-norm.


**Our work in context:** Deep thermalization has been
primarily explored through numerical simulations, especially in chaotic many-body systems, while rigorous
theoretical results exist only in restricted settings. In
particular, Haar randomness of the projected ensemble
has been proven in certain special models of shallow
1D circuits, but only in the asymptotic limit _NB →_ ∞

[8, 9]. For finite _NB_, sufficient conditions for deep
thermalization were established in [6]. The authors
prove that if a global state _|ψ⟩AB_ is drawn from an
approximate _t_ -design, then the projected ensemble in
_A_ forms an approximate _t_ _[′]_ -design, provided _t_ _[′]_ _< t_ / _NB_
and _NB ≫_ _NA_ . Thus, the projected ensemble inherits
only “lower order" designs, with _t_ _[′]_ _≪_ _t_ . Moreover, the
proof only works for a fixed _t_, and not for arbitrary
polynomially large moments. The infusion of classical
randomness can, in principle, increase _t_ _[′]_, but only by a
constant factor [15].
In contrast, a Haar random state remains Haar-like,
with high probability, under projective measurements,
even when _NB_ is finite. In this sense, _t_ -designs do not
serve as faithful models of deep thermalization beyond
extremely low-order moments, underscoring the need
for new frameworks to capture this phenomenon. Importantly, the existence of bounded-depth state ensembles exhibiting deep thermalization was posed as an
open question in [6], where preliminary numerical evidence suggested that shallow brickwork circuits might
suffice. Our work resolves this question affirmatively:
we provide the first rigorous construction showing that
deep thermalization can emerge from ensembles generated by polylogarithmic-depth circuits, even when the
underlying states have minimal entanglement and arise
from highly structured, pseudorandom phase patterns.
Prior constructions of pseudorandom or pseudoentangled states also do not exhibit deep thermalization,
a fact also observed in [25]. Consider the following _n_
qubit state, known as a subset phase state, defined as

       - 1
��� _ψ_ _f_, _S_ = ~~_√_~~ ( _−_ 1) _[f]_ [ (] _[x]_ [)] _|x⟩_, (1)
## M x [∑] ∈S


where _f_ is a pseudorandom function and _S ⊂{_ 0, 1 _}_ _[n]_

is a (pseudo-)randomly chosen subset of size _M_ . These


states are pseudorandom and have very low entanglement (pseudoentangled) across any cut [18]. However,
the corresponding projected ensemble leads to trivial
standard basis states and not a _t_ -design, violating
property (iii), as sketched in Sec. S2 of the Supplemental
Material (SM) [26]. The same argument also holds for
the so-called subset states [19, 20], which are of the
same form as Eq. (1), with the phase function removed.
On the other hand, phase states can be obtained when
_S_ = _{_ 0, 1 _}_ _[n]_, i.e. _M_ = 2 _[n]_ [17, 18]. Measuring such a state
across any bipartition of qubits yields another phase
state that retains its pseudorandomness. However,
phase states exhibit maximal entanglement both before
and after measurement, thereby violating Conditions
(ii) and (iii).


**Projected** **designs** **across** **a** **fixed** **bipartition** **of**
**qubits:** Note that even though subset phase states
do not satisfy deep thermalization, it is possible to
“patch" two subset phase states (or two subset states)
together so that the resulting state forms a projected
design across a specific bipartition of qubits. While
this property is significantly weaker than full deep
thermalization, which requires such behavior across
most bipartitions, it serves as a useful intermediate step
toward our final construction. Furthermore, this illustrates the limitations of using existing pseudoentangled
state constructions in simulating deep thermalization.
Indeed, we can “glue" two subset phase states of
_n_ /2 qubits, assigning the first _n_ /2 qubits to subsystem
_A_, and the last _n_ /2 qubits to subsystem _B_ . Consider
two sequences of disjoint subsets: _A_ 1, _A_ 2, _· · · AR_ and
_B_ 1, _B_ 2, _· · ·_, _BR_, such that each _Ai_, _Bi ⊂{_ 0, 1 _}_ _[n]_ [/2] of size
_M_ . Define the _Schmidt-patch subset phase states_ as:



3


       global state ��� _ψM_, _R_, _f_ is computationally indistinguishable from a Haar-random pure state on _n_ -qubits. This is
formalized as follows:


**Theorem 1.** _Suppose M_ [3/2] _R_ / _N <_ 1 _, where N_ = 2 _[n]_ _. Then_
_for any t_ = poly( _n_ ) _,_

�� _⊗t_
**E** _A_, _B_, _f_ ��� _ψM_, _R_, _f_ _ψM_, _R_, _f_ ��� _−_ **E**
����� _ϕ∼_ Haar( **C** _[N]_ ) _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_ �����1




  - _t_ 3
_≤_ _O_

_M_




- - _t_ 2
+ _O_ ~~_√_~~



~~_√_~~



_N_




.




   - 1
��� _ψM_, _R_, _f_ = ~~_√_~~

_M_



_R_



_R_
## ∑ ∑ ( − 1) [f] [ (] [x] [,] [y] [)] |x⟩A |y⟩B,

_j_ =1 _x∈Aj_, _y∈Bj_



(2)
where _f_ : _{_ 0, 1 _}_ _[n]_ _�→{_ 0, 1 _}_ is a global pseudorandom
function. Omitting the phase yields the corresponding
Schmidt-patch subset state.
These states can be efficiently prepared from the allzero state _|_ 0 _⟩_ _[⊗][n]_ by (1) preparing _r_ = log2 _R_ Bell pairs
between qubits (1, _n_ /2 + 1), (2, _n_ /2 + 2), _· · ·_ ( _r_, _n_ /2 + _r_ ),
thus entangling subsystems _A_ and _B_ with _r_ bits of entanglement across the A-B cut, and (2) applying subset
phase circuits on both halves (see Sec. S4 A of the SM

[26]). For _r ∼_ log [2] _n_, the Schmidt patch construction
ensures that the global state has very low entanglement
across the fixed cut, while all other cuts inherit low entanglement from the underlying subset phase states.
By construction, a projective measurement on one half
(say, subsystem _B_ ) in the computational basis collapses
the global state on to a subset phase state on _A_ . Since
subset phase states are known to be pseudoentangled
for _M_ = 2 [Ω][(][log][2] _[ n]_ [)], this projected ensemble is trivially
pseudoentangled [27]. The non-trivial claim is that the



The proof is given in Sec. S4 B of the SM [26]. An
analogous result also holds for subset states. Thus,
even when log2 _M_ and _r_ are low ( _∼_ log [2] _n_ ), the global
Schmidt-patch ensemble is pseudorandom in a strong
sense: its _t_ -fold moments match Haar up to negligible
error while its entanglement is minimal across all cuts.
The proof follows from careful combinatorial analysis of
the coverage properties of the special family of sets that
correspond to Schmidt-patched states. We also extend
this construction to variants with unequal patch sizes
and other, possibly asymmetric (but still specific) bipartitions.
To spoof deep thermalization across most cuts, a
natural place to gain intuition from is the glued unitary
construction of [28], which shows how to prepare
PRUs (unitaries that take any state to a pseudorandom
state) in low depth with low entanglement. However,
analyzing the projected design properties of states
prepared by such circuits is technically challenging.
The complication arises because projected ensembles
are dependent on the choice of measurement basis. A
more direct approach is to design a minimal family of
states which are tailored to computational basis measurements. The idea is to modify the standard binary
phase state such that the Boolean function is structured
according to a two-layer large-brick brickwork circuit,
taking inspiration from the glued brickwork model
introduced in [28].


**Large-brick** **phase** **states:** We consider a “glued
brickwork” quantum circuit made from two staggered
layers of local phase gates, where each gate (or “brick”),
acts on a small block of 2 _b_ adjacent qubits, as shown
in Figure 1. Within each layer, the bricks are nonoverlapping and tile the qubit chain uniformly. The
second layer is shifted by exactly _b_ qubits relative to
the first, so that every brick overlaps with bricks from
the other layer on exactly half of its qubits. The circuit
wraps around the ends of the chain, forming a ring-like
structure with periodic boundary conditions.
Each brick applies a local phase gate to its input, determined by a pseudorandom function sampled independently for each brick: either _fi_ : _{_ 0, 1 _}_ [2] _[b]_ _�→{_ 0, 1 _}_
for bricks in the first layer or _gi_ : _{_ 0, 1 _}_ [2] _[b]_ _�→{_ 0, 1 _}_, for
the second. These act as _U_ _fj_ _|x⟩_ = ( _−_ 1) _[f][j]_ [(] _[x]_ [)] _|x⟩_, on any


4



_x_ 1


_x_ 2


_x_ 3


_x_ 4


_x_ 5


_x_ 6





_g_ 1, . . ., _gm are chosen to be genuinely random. Then the en-_
_semble moments match the moments of the Haar measure up_
_to a negligible difference:_


�� _⊗t_

����� _f_ 1: _m_ **E**, _g_ 1: _m_ ��� _ψ_ _f_ 1: _m_, _g_ 1: _m_ _ψ_ _f_ 1: _m_, _g_ 1: _m_ ��� _−_ _ϕ∼_ Haar **E** ( **C** _[N]_ ) _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_ �����







��
��� _ψ_ _f_ 1: _m_, _g_ 1: _m_ _ψ_ _f_ 1: _m_, _g_ 1: _m_



_⊗t_

_−_ **E**
���
_ϕ∼_ Haar( **C** _[N]_ ) _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_ �����1




  - _t_ 2 _n_ 2
_≤_ _O_

2 _[b]_




.


|Col1|⊗b|Col3|Col4|Col5|g|Col7|
|---|---|---|---|---|---|---|
|_H_<br>_⊗b_|_H_|_H_|_f_1||1||
|_H_<br>_⊗b_|_⊗b_|_⊗b_|_⊗b_|_⊗b_|||
|_H_<br>_⊗b_|_H_|_H_|||_g_2||
|_H_<br>_⊗b_|_H_|_H_|||||
|_H_<br>_⊗b_|_H_<br>_⊗b_|_H_<br>_⊗b_|_f_2||||
|_H_<br>_⊗b_|_H_<br>_⊗b_|_H_<br>_⊗b_|_f_2||||
|_H_<br>_⊗b_|_H_<br>_⊗b_|_H_<br>_⊗b_|||_g_3||
|_H_<br>_⊗b_|_H_<br>_⊗b_|_H_<br>_⊗b_|||||
|_H_<br>_⊗b_|_H_<br>_⊗b_|_H_<br>_⊗b_|_f_3|_g_|||
|_H_<br>_⊗b_|_⊗b_|_⊗b_|_⊗b_|_⊗b_|_g_|_g_|
||_H_||||1||



Figure 1. Two-layered brickwork circuit for preparing a large-brick phase
state. The circuit applies _m_ bricks to the equal superposition state of _n_
qubits. Each brick is of size 2 _b_ and applies a phase gate in the computational basis, constructed out of pseudorandom functions _fi_, _gi ∈{_ 0, 1 _}_ [2] _[b]_ _�→_
_{_ 0, 1 _}_, such that each _xi ∈{_ 0, 1 _}_ _[b]_ . In this figure, _m_ = 3 and the final state
is of _n_ = 2 _mb_ = 6 _b_ qubits.


2 _b_ -bit string _x_ . Here _j ∈_ [1, _m_ ], as each layer contains exactly _m_ = _n_ /(2 _b_ ) bricks [29]. Starting from the uniform
superposition state of _n_ -qubits, this circuit prepares a binary phase state on each basis string, built from a structured sum of local, pseudorandom contributions. For
_b_ = Ω(log [2] _n_ ), we call these states _large-brick phase states_,
formally define as


    - 1
## ��� ψ f 1: m, g 1: m = ∑ ( − 1) [Φ][(] [x] [)] |x 1. x 2. · · · . x 2 m⟩,
2 _[n]_ [/2]
_x_ 1,..., _x_ 2 _m∈{_ 0,1 _}_ _[b]_

(3)
where the phase function,


Φ( _x_ ) = ∑ _fj_ ( _x_ 2 _j−_ 1. _x_ 2 _j_ ) + ∑ _gj_ ( _x_ 2 _j−_ 2. _x_ 2 _j−_ 1).
_j∈_ [1, _m_ ] _j∈_ [1, _m_ ]


Here, each _xi ∈{_ 0, 1 _}_ _[b]_ with _x_ 0 := _x_ 2 _m_ (periodic boundary conditions), and _x_ . _y_ denotes the concatenation of the
two bit strings _x_ and _y_ . Each brick acting on 2 _b ∼_ log [2] _n_
qubits can be efficiently compiled into a quantum circuit of depth approximately _∼_ log log _n_, using gates
of constant locality. While these gates may be geometrically non-local, the overall circuit remains sparse
and efficient to implement. The pseudorandom functions used to define the bricks are constructed using
standard techniques from cryptographic hardness assumptions—such as the presumed difficulty of lattice
problems—and can be instantiated from any quantumsecure one-way function [30]. In particular, the existence
of quantum-secure one-way functions implies the existence of pseudorandom functions that we use in the circuit in Fig. 1. We now prove that large-brick phase states
satisfy Conditions (i)-(iii).
We first show that these states are computationally indistinguishable from Haar-random states and are pseudoentangled. Formally, we prove Theorem 2.


**Theorem 2** (Large-brick phase states are pseudorandom and pseudoentangled) **.** _Suppose, for large-brick phase_
_states defined in Eq._ (3) _, the functions f_ 1, . . ., _fm and_



_Moreover, the states are pseudoentangled, having entropy_
_O_ ( _b_ ) _along 1D geometric cuts._


While the detailed proof of Theorem 2 can be found
in Sec. S5 A of the SM [26], we provide a sketch here.
Note that for these states, the global phase is generated by local functions acting on bricks of 2 _b_ bits. For
genuinely random functions _f_, _g_, we analyze the expected _t_ -moment operator and show that it matches
the Haar moment on the _birthday subspace_ —the set of
_t_ -tuples where no _b_ -bit substring repeats (collision-free
subspace). This relies on the key observation that random phases contributed by each brick average to zero
unless the local inputs match pairwise, which only occurs when the _t_ -tuples are globally related by a permutation. Thus, the moment operator reproduces Haar
structure on most of its weight, yielding trace distance
closeness with error _O_ ( _t_ [2] _n_ [2] /2 _[b]_ ). This is negl( _n_ ) for large
bricks, i.e. _b ∼_ log [2] _n_ .
To achieve computational pseudorandomness, we replace the truly random local functions with quantumsecure pseudorandom functions (PRFs). Since PRFs are
indistinguishable from random functions to any efficient quantum algorithm, large-brick phase states are
computationally indistinguishable from Haar random
states. The existence of quantum-secure PRFs can be
based on a variety of conjectures, for instance, Learning
With Errors (LWE) or Learning Parity with Noise (LPN)

[31].
Furthermore, these states satisfy a (quasi) area-law for
entanglement. Specifically, the entanglement entropy
across any cut is upper bounded by _O_ ( _|B| · b_ ), where
_|B|_ is the number of bricks intersected by the cut (i.e.,
the “area” of the boundary), and _b_ is the brick size. This
bound follows from a simple geometric observation:
only bricks that straddle the cut can contribute to the
entanglement, and each such brick adds at most _O_ ( _b_ )
entropy. So, the entanglement entropy across any 1D
geometric cut is _O_ ( _b_ ), which is _∼_ log [2] _n_, for large-brick
phase states.


**Projected** **designs** **across** **almost** **all** **cuts:** Largebrick phase states yield projected designs across all
but a negligible fraction of the cuts of the state. The
formal proof is given in Sec. S5 B of the SM [26] while
we outline the central ideas here.
We show that for a typical bipartition of the _n_ qubits,
each _b_ -qubit brick is split into two segments of lengths
_kj_ and _b −_ _kj_, where _kj_ is sharply concentrated around


_b_ /2 by a standard binomial tail bound. A union
bound shows that, with high probability, _all_ bricks are
(roughly) evenly split up, i.e. each segment has length

[ _b_ /4, 3 _b_ /4]. We then consider a computational basis measurement on one side of the cut. The postmeasurement state on the remaining qubits has a phase
determined by the measurement outcome, resulting in a
new ensemble of states.
Crucially, the post-measurement phase retains the
brickwork structure, and the resulting state is still a
large-brick phase state: the effective phase functions are
obtained by fixing part of the input bits (those on the
measured side) in the original pseudorandom functions.
As long as the remaining brick sizes are _≥_ Ω(log [2] _n_ ),
which holds with high probability (from the binomial
concentration bounds), these functions remain pseudorandom. So, following Theorem 2, the projected
ensemble continues to satisfy pseudorandomness (i.e.,
Haar indistinguishability) and low entanglement (i.e.,
pseudoentanglement) properties. Interestingly, this also
includes all but a 1/ log [2] _n_ fraction of the 1D geometric
cuts. Since the entanglement entropy is low across
precisely these cuts, we conclude that large-brick phase
states continue to exhibit the projected design property
even across most of the “pesudoentangled" cuts.


**Towards pseudorandomness beyond BQP:** We note
that the ensemble constructed in this work may potentially remain pseudorandom and pseudoentangled
against a qualitatively different adversary than what is
usually considered. Standard computational pseudorandomness is defined against distinguishers equipped
with polynomial-time quantum computers, i.e., those
in BQP. It is also known that any ensemble becomes
distinguishable from Haar when BQP is augmented
with a PP oracle [32], which can postselect on exponentially rare events. This raises a natural question: can
pseudorandomness and pseudoentanglement persist
in the large complexity landscape between BQP and
BQP [PP] ?
Our work takes a first step in this direction by considering BQP distinguishers equipped with the power
of non-collapsing measurements. The key insight is that
projected designs appear to be robust against such adversaries. However, prior constructions of pseudoentangled states, which are not projected designs, such as
subset [19] and subset-phase states [18], are distinguishable by adversaries capable of performing poly( _n_ ) noncollapsing measurements.
In contrast, pseudorandom phase states [17, 18, 33]
can be shown to form projected designs across every
cut, and remain indistinguishable from Haar even under
such measurements—though they are not pseudoentangled due to high entanglement. Our large-brick phase
states (Fig.1) achieve both: they maintain low entanglement while forming projected designs across almost all
bipartitions. Thus, an adversary that selects a random
cut and performs non-collapsing measurements will,



5


with high probability, observe pseudoentangled residual states (see Sec. S6 of the SM [26]). However, any
such robustness claim relies on the cryptographic assumption that pseudorandom functions remain secure
against such adversaries, and we leave open the plausibility of this conjecture for future investigation.
Finally, our model of the adversary, making noncollapsing measurements, is a special case of the
complexity class PDQP (Product Dynamical Quantum
Polynomial time) [34, 35], defined as the class “just
above BQP”. Our results suggest that pseudoentanglement may persist even against PDQP-like adversaries,
providing a new physical motivation—from the
perspective of deep thermalization—for exploring
pseudorandomness beyond BQP.


**Discussion:** Experimental and numerical studies
have shown that many-body quantum systems thermalize rapidly and with surprisingly low resource
overhead [5, 6]. Since computation is ultimately a
physical process, and nature itself can be viewed as a
quantum computer, these observations call for theoretical explanations from the perspective of quantum
computation. Our findings provide such a foundation,
showing that deep thermalization can indeed be simulated by quantum computers using minimal resources.
Unlike prior theoretical results, which require highly
idealized conditions (e.g., infinite bath size or constantcopy distinguishers), our construction accommodates
finite baths and allows an efficient observer to request
polynomially many copies of the post-measurement
state.
The circuits required to prepare our states have depth
log [2] _n_, which exceeds what polynomial-time classical
algorithms can efficiently simulate. This implies that
classically reproducing computational deep thermalization would require circuits of at least quasi-polynomial
depth ( _∼_ 2 [log][2] _[ n]_ ).
From the perspective of computational pseudorandomness, our results provide one of the final pieces in
the broader program to derandomize the Haar measure
under computational assumptions [17, 18, 28, 36]. They
also highlight how computational indistinguishability
can reconcile low-complexity states with emergent thermal behavior, offering new insights at the intersection of
complexity theory and physics.
A natural next step is to generalize these ideas to deep
thermalization at finite temperatures. In this regime,
the projected ensemble becomes the so-called Scrooge
ensemble—a “thermally shifted” Haar distribution [37].
Even reproducing its second moments using shallow
quantum circuits remains an open problem.


_Note added:_ Concurrently and independently, Ref. [38]
uses a construction similar to large brick phase states
to prepare fast _t_ -designs and pseudorandom states.
As noted in [38], if the pseudorandom functions are
replaced by _t_ -wise independent functions, then the


construction in Theorem 2 gives _t_ -designs that are
optimal in certain parameters. However, Ref. [38] does
not discuss implications to deep thermalization.


We thank Bill Fefferman, Adam Bouland, Thomas
Schuster, Robert Huang, Manuel Endres, Matteo
Ippoliti, Tobias Haug, Supartha Podder, and David


[1] J. M. Deutsch, Phys. Rev. A **[43](https://doi.org/10.1103/PhysRevA.43.2046)**, 2046 (1991).

[2] M. Srednicki, Phys. Rev. E **[50](https://doi.org/10.1103/PhysRevE.50.888)**, 888 (1994).

[3] M. Rigol, V. Dunjko, and M. Olshanii, Nature **[452](https://doi.org/doi.org/10.1038/nature06838)**, 854
[(2008).](https://doi.org/doi.org/10.1038/nature06838)

[[4] R. Nandkishore and D. A. Huse, Annual Review of Con-](https://doi.org/https://doi.org/10.1146/annurev-conmatphys-031214-014726)
[densed Matter Physics](https://doi.org/https://doi.org/10.1146/annurev-conmatphys-031214-014726) **6**, 15 (2015).

[5] J. Choi, A. L. Shaw, I. S. Madjarov, X. Xie, R. Finkelstein,
J. P. Covey, J. S. Cotler, D. K. Mark, H.-Y. Huang, A. Kale,
H. Pichler, F. G. S. L. Brandão, S. Choi, and M. Endres,
Nature **613** [, 468 (2023).](https://doi.org/10.1038/s41586-022-05442-1)

[6] J. S. Cotler, D. K. Mark, H.-Y. Huang, F. Hernandez,
[J. Choi, A. L. Shaw, M. Endres, and S. Choi, PRX Quan-](https://arxiv.org/abs/2103.03536)
tum **4** [, 010311 (2023).](https://arxiv.org/abs/2103.03536)

[7] M. Ippoliti and W. W. Ho, Quantum **[6](https://doi.org/10.22331/q-2022-12-29-886)**, 886 (2022).

[8] W. W. Ho and S. Choi, Phys. Rev. Lett. **[128](https://doi.org/10.1103/PhysRevLett.128.060601)**, 060601 (2022).

[9] M. Ippoliti and W. W. Ho, PRX Quantum **[4](https://doi.org/10.1103/PRXQuantum.4.030322)**, 030322 (2023).

[[10] X.-H. Yu, W. W. Ho, and P. Kos, Mixed state deep thermal-](https://arxiv.org/abs/2505.07795)
[ization (2025), arXiv:2505.07795 [quant-ph].](https://arxiv.org/abs/2505.07795)

[11] J. M. Renes, R. Blume-Kohout, A. J. Scott, and C. M.
[Caves, Journal of Mathematical Physics](https://doi.org/10.1063/1.1737053) **45**, 2171 (2004).

[12] A. Ambainis and J. Emerson, in _[Proceedings of the Twenty-](https://doi.org/10.1109/CCC.2007.26)_
_[Second Annual IEEE Conference on Computational Com-](https://doi.org/10.1109/CCC.2007.26)_
_[plexity](https://doi.org/10.1109/CCC.2007.26)_, CCC ’07 (IEEE Computer Society, USA, 2007) p.
129–140.

[[13] M. McGinley and M. Fava, Phys. Rev. Lett.](https://doi.org/10.1103/PhysRevLett.131.160601) **131**, 160601
[(2023).](https://doi.org/10.1103/PhysRevLett.131.160601)

[14] H.-Y. Huang, J. Preskill, and M. Soleimanifar, in _[2024 IEEE](https://doi.org/10.1109/FOCS61266.2024.00079)_
_[65th Annual Symposium on Foundations of Computer Science](https://doi.org/10.1109/FOCS61266.2024.00079)_
_[(FOCS)](https://doi.org/10.1109/FOCS61266.2024.00079)_ (2024) pp. 1202–1206.

[15] W.-K. Mok, T. Haug, A. L. Shaw, M. Endres, and
J. Preskill, Phys. Rev. Lett. **[134](https://doi.org/10.1103/PhysRevLett.134.180403)**, 180403 (2025).

[[16] B. Zhang, P. Xu, X. Chen, and Q. Zhuang, Nature Com-](https://doi.org/10.1038/s41467-025-61546-y)
[munications](https://doi.org/10.1038/s41467-025-61546-y) **16**, 6341 (2025).

[17] Z. Ji, Y.-K. Liu, and F. Song, in _[Advances in Cryptology –](https://doi.org/10.1007/978-3-319-96878-0_5)_
_[CRYPTO 2018](https://doi.org/10.1007/978-3-319-96878-0_5)_, Lecture Notes in Computer Science, Vol.
10993, edited by H. Shacham and A. Boldyreva (Springer,
Cham, Switzerland, 2018) pp. 126–152.

[18] S. Aaronson, A. Bouland, B. Fefferman, S. Ghosh, U. Vazirani, C. Zhang, and Z. Zhou, in _[15th Innovations in Theo-](https://doi.org/10.4230/LIPIcs.ITCS.2024.2)_
_[retical Computer Science Conference (ITCS 2024)](https://doi.org/10.4230/LIPIcs.ITCS.2024.2)_, Leibniz International Proceedings in Informatics (LIPIcs), Vol. 287,
edited by V. Guruswami (Schloss Dagstuhl – LeibnizZentrum für Informatik, Dagstuhl, Germany, 2024) pp.
2:1–2:21.

[[19] T. Giurgica-Tiron and A. Bouland, Pseudorandomness](https://arxiv.org/abs/2312.09206)
[from subset states (2023), arXiv:2312.09206 [quant-ph].](https://arxiv.org/abs/2312.09206)

[[20] F. G. Jeronimo, N. Magrafta, and P. Wu, Pseudorandom](https://arxiv.org/abs/2312.15285)
[and pseudoentangled states from subset states (2024),](https://arxiv.org/abs/2312.15285)
[arXiv:2312.15285 [quant-ph].](https://arxiv.org/abs/2312.15285)

[21] A. Bouland, B. Fefferman, S. Ghosh, T. Metger, U. Vazirani, C. Zhang, and Z. Zhou, in _[39th Computational Com-](https://doi.org/10.4230/LIPIcs.CCC.2024.21)_



6


Miloschewskya for helpful comments. Shantanav
Chakraborty acknowledges funding from the Ministry
of Electronics and Information Technology (MeitY),
Government of India, under Grant No. 4(3)/2024-ITEA.
Shantanav Chakraborty also acknowledges support
from Fujitsu Ltd, Japan, and IIIT Hyderabad. Soonwon
Choi acknowledges funding from the NSF CAREER
award 2237244.


_[plexity Conference (CCC 2024)](https://doi.org/10.4230/LIPIcs.CCC.2024.21)_, Leibniz International Proceedings in Informatics (LIPIcs), Vol. 300, edited by
R. Santhanam (Schloss Dagstuhl – Leibniz-Zentrum für
Informatik, Dagstuhl, Germany, 2024) pp. 21:1–21:23.

[22] A. Gu, L. Leone, S. Ghosh, J. Eisert, S. F. Yelin, and
Y. Quek, Phys. Rev. Lett. **[132](https://doi.org/10.1103/PhysRevLett.132.210602)**, 210602 (2024).

[[23] A. Gu, Y. Quek, S. Yelin, J. Eisert, and L. Leone, Simulating](https://arxiv.org/abs/2410.18196)
[quantum chaos without chaos (2024), arXiv:2410.18196](https://arxiv.org/abs/2410.18196)

[[quant-ph].](https://arxiv.org/abs/2410.18196)

[24] In 1D, the requirements in Conditions (ii) and (iii) are optimal due to geometric constraints. In higher dimensions,
e.g., 2D, Condition (iii) can be achieved in constant depth
via measurement-based computation [39], but such states
violate (i). Pseudorandom phase states [17] satisfy Conditions (i) and (iii), but exhibit high entanglement, violating Condition (ii). Finally, Subset states (or subset phase
states) [18, 20] satisfy Conditions (i) and (ii), but not (iii),
as shown later.

[[25] X. Feng and M. Ippoliti, Journal of High Energy Physics](https://doi.org/doi.org/10.1007/JHEP02(2025)128)
**[2025](https://doi.org/doi.org/10.1007/JHEP02(2025)128)**, 1 (2025).

[26] See supplemental material at [url], for detailed derivations of the results which includes refs. [39 - 43].

[27] We use standard complexity-theoretic notation: _f_ ( _n_ ) =
_O_ ( _g_ ( _n_ )) if _f_ ( _n_ ) _≤_ _c · g_ ( _n_ ) for all _n ≥_ _n_ 0, and _f_ ( _n_ ) =
Ω( _g_ ( _n_ )) if _f_ ( _n_ ) _≥_ _c · g_ ( _n_ ) for all _n ≥_ _n_ 0, for constants
_c_, _n_ 0 _>_ 0. A function _f_ ( _n_ ) is negligible, denoted _f_ ( _n_ ) =
negl( _n_ ), if it decays with _n_ ( e.g. _f_ ( _n_ ) = 1/poly( _n_ )) for all
sufficiently large _n_ .

[[28] T. Schuster, J. Haferkamp, and H.-Y. Huang, Science](https://doi.org/10.1126/science.adv8590) **389**,
[92 (2025).](https://doi.org/10.1126/science.adv8590)

[29] Without loss of generality, we assume _n_ is even and _b_ is a
divisor of _n_ /2.

[30] C. Peikert and B. Waters, in _[Proceedings of the Fortieth An-](https://doi.org/10.1145/1374376.1374406)_
_[nual ACM Symposium on Theory of Computing](https://doi.org/10.1145/1374376.1374406)_, STOC ’08
(Association for Computing Machinery, New York, NY,
USA, 2008) p. 187–196.

[31] C. Peikert and B. Waters, in _[Proceedings of the 40th An-](https://doi.org/10.1145/1374376.1374406)_
_[nual ACM Symposium on Theory of Computing (STOC ’08)](https://doi.org/10.1145/1374376.1374406)_
(ACM, Victoria, British Columbia, Canada, 2008) pp. 187–
196.

[32] W. Kretschmer, in _[16th Conference on the Theory of Quan-](https://doi.org/10.4230/LIPIcs.TQC.2021.2)_
_[tum Computation, Communication and Cryptography (TQC](https://doi.org/10.4230/LIPIcs.TQC.2021.2)_
_[2021)](https://doi.org/10.4230/LIPIcs.TQC.2021.2)_, Leibniz International Proceedings in Informatics (LIPIcs), Vol. 197, edited by M.-H. Hsieh (Schloss
Dagstuhl – Leibniz-Zentrum für Informatik, Dagstuhl,
Germany, 2021) pp. 2:1–2:20.

[33] P. Ananth, A. Gulati, L. Qian, and H. Yuen, in _[Theory of](https://doi.org/10.1007/978-3-031-22318-1_9)_
_[Cryptography](https://doi.org/10.1007/978-3-031-22318-1_9)_, edited by E. Kiltz and V. Vaikuntanathan
(Springer Nature Switzerland, Cham, 2022) pp. 237–265.

[34] S. Aaronson, A. Bouland, J. Fitzsimons, and M. Lee, in

_[Proceedings of the 7th Innovations in Theoretical Computer](https://doi.org/10.1145/2840728.2840739)_


7



_[Science (ITCS 2016)](https://doi.org/10.1145/2840728.2840739)_ (ACM, 2016) pp. 271–280.

[[35] D. Miloschewsky and S. Podder, New lower-bounds](https://arxiv.org/abs/2411.04085)
[for quantum computation with non-collapsing measure-](https://arxiv.org/abs/2411.04085)
[ments (2025), arXiv:2411.04085 [quant-ph].](https://arxiv.org/abs/2411.04085)

[36] F. Ma and H.-Y. Huang, in _[Proceedings of the 57th Annual](https://doi.org/10.1145/3717823.3718254)_
_[ACM Symposium on Theory of Computing](https://doi.org/10.1145/3717823.3718254)_, STOC ’25 (Association for Computing Machinery, New York, NY, USA,
2025) p. 806–809.

[37] D. K. Mark, F. Surace, A. Elben, A. L. Shaw, J. Choi,
[G. Refael, M. Endres, and S. Choi, Phys. Rev. X](https://doi.org/10.1103/PhysRevX.14.041051) **14**, 041051
[(2024).](https://doi.org/10.1103/PhysRevX.14.041051)

[[38] L. Cui, T. Schuster, F. Brandao, and H.-Y. Huang, Unitary](https://arxiv.org/abs/2507.06216)
[designs in nearly optimal depth (2025), arXiv:2507.06216](https://arxiv.org/abs/2507.06216)

[[quant-ph].](https://arxiv.org/abs/2507.06216)

[39] H. J. Briegel, D. E. Browne, W. Dür, R. Raussendorf, and
[M. Van den Nest, Nature Physics](https://doi.org/10.1038/nphys1157) **5**, 19–26 (2009).

[[40] A. W. Harrow, The church of the symmetric subspace](https://arxiv.org/abs/1308.6595)

[(2013), arXiv:1308.6595 [quant-ph].](https://arxiv.org/abs/1308.6595)

[41] Z. Brakerski and O. Shmueli, in _[Theory of Cryptography](https://doi.org/10.1007/978-3-030-36030-6_10)_,
edited by D. Hofheinz and A. Rosen (Springer International Publishing, Cham, 2019) pp. 229–250.

[42] C. Peikert and V. Vaikuntanathan, in _[Advances in Cryptol-](https://doi.org/10.1007/978-3-540-85174-5_30)_
_[ogy – CRYPTO 2008](https://doi.org/10.1007/978-3-540-85174-5_30)_, Lecture Notes in Computer Science,
Vol. 5157 (Springer, 2008) pp. 536–553.

[[43] A. Blum, A. Kalai, and H. Wasserman, Noise-tolerant](https://arxiv.org/abs/cs/0010022)
[learning, the parity problem, and the statistical query](https://arxiv.org/abs/cs/0010022)
[model (2000), arXiv:cs/0010022 [cs.LG].](https://arxiv.org/abs/cs/0010022)


**Supplemental Material for ”Fast computational deep thermalization”**


Shantanav Chakraborty, Soonwon Choi, Soumik Ghosh, and Tudor Giurgic˘a-Tiron


Here, we provide detailed derivations of the results of the main article.


**S1.** **NOTATIONS AND PRELIMINARIES**


Let us first establish some basic notation:


**Definition S3.** _Given a set X, denote by P_ ( _X_ ) _(alternatively, denoted_ 2 _[X]_ _) the power set of X, i.e. the set of all subsets of X._
_For our practical uses, let us denote by P≥_ polylog( _X_ ) _the set of subsets of X of size_ 2 [Ω][(][polylog][ log] _[|][X][|]_ [)] _._


**Definition S4.** _Given a subset S ∈P_ ([ _N_ ]) _, we define the_ ( _S_, _t_ ) _-symmetric subspace_ Sym _[t]_ ( _S_ ) _as the symmetric subspace of_
_t copies of the space spanned by the vectors {|j⟩}j∈S._


**Higher moments of Haar random states:** It is well known (see for instance [40]) that the _t_ -th moment of a Haar
random state on a _d_ -dimensional Hibert space _H_ can be written as a projection ΠSym _t_ ( _H_ ) onto the symmetric subspace

of _H_ _[⊗][t]_ . That is,




              _ρ_ Haar [(] _[t]_ [)] [=] **[ E]** _[ϕ][∼]_ [Haar][(] _[H]_ [)] _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_ [ =]



ΠSymt( _H_ )
(S1)
_ϕ∼_ Haar( _H_ ) _[d][ϕ][ |][ϕ][⟩⟨][ϕ][|][⊗][t]_ [ =] dim Sym _[t]_ ( _H_ ) [,]



where,




     - _d_ + _t −_ 1
dim Sym _[t]_ ( _H_ ) =
_t_




.



**Pseudoentangled states:** An ensemble _E_ of _n_ -qubit pure states is said to be pseudoentangled [18, 21], if every
state _|ψ⟩∈E_ is (i) efficiently preparable, (ii) is computationally pseudorandom, and has (iii) low entanglement. Let
us expand on each of these points. Point (i) implies that _|ψ⟩_ can be prepared by a quantum circuit of depth at most
poly( _n_ ). For any _t_ = poly( _n_ ), the ensemble _E_ is computationally pseudorandom if any polynomial-time quantum
algorithm _C_ with access to _t_ copies of _|ψ⟩∈E_ cannot distinguish it from _t_ -moments of the Haar ensemble. More
concretely,


            -             ��� _C_ **E** _ψ∼E |ψ⟩⟨ψ|_ _[⊗][t]_ [�] _−C_ **E** _ϕ∼_ Haar _|ϕ⟩⟨ϕ|_ _[⊗][t]_ [���]                                                             - _≤_ negl( _n_ ), (S2)


where negl( _n_ ) is any function that decays with _n_ (e.g. 1/poly( _n_ )). For point (iii), the state _|ψ⟩_ should have low
entanglement across spatially local (or geometrically local) bipartitions of qubits, despite being computationally
pseudorandom. Typically, the entanglement across these cuts scales as some function of _n_ (say Θ( _f_ ( _n_ ))), which is
required to be low in comparison to another state having high entanglement (say Θ( _g_ ( _n_ ))). The difference between
the two is what is referred to as the _entanglement gap_ . In the main article, we compare the entanglement content of the
states we construct with Haar random states. For instance, large-brick phase states are pseudoentangled states with
entanglement across geometrically local cuts being as low as Ω(log [2] _n_ ). The entanglement is (sub)-exponentially
lower than Haar random states.


**S2.** **SUBSET PHASE STATES ARE NOT PROJECTED DESIGNS**


Consider the states considered in Ref. [18], which demonstrated an example of a PRS ensemble which also presented undetectably low entanglement across all cuts with high probability. The construction relies on pseudorandom subset-phase states:


9


**Definition S5** (Subset-phase state [18]) **.**


                - 1
��� _ψM_, _R_, _f_ _≡_ ~~_√_~~ ( _−_ 1) _[f]_ [ (] _[x]_ [)] _|x⟩_ _∈_ **C** [2] _[n]_, (S3)
## M x [∑] ∈S


_where S ∈_ ( [[] _[N]_ []]
_M_ [)] _[ is a pseudorandom subset of the computational basis of size M]_ [ =] _[ |][S][|]_ [ =][ 2][polylog][(] _[n]_ [)] _[, and f is a classical one-way]_
_function._


We will also work in the hybrid picture, in which pseudorandom quantities such as _S_ and _f_ are treated as genuinely uniformly random, aiming to show that this leads to states with strong statistical properties.


**Observation.** By design, a state like in Eq. (S3) cannot build projected designs because it is constructed to have low
entanglement across (any) cuts. Birthday statistics tell us that collapsing a subsystem _B_ of size _n −_ _O_ ( _n_ ) will leave us
with a computational basis state in _A_, i.e. a depth-one state, with probability 1 _−_ _O_ (2 [polylog][(] _[n]_ [)] _[−|][B][|]_ ) = 1 _−_ negl( _n_ ). It
is well-known that such states cannot form designs, since there is a Ω( _nt_ ) lower bound on the depth of the elements
of a _t_ -design. The same argument holds for subset states [19].


**S3.** **GENERIC SUBSET DISTRIBUTIONS FOR HAAR-LIKE STATE ENSEMBLES**


In this section, we aim to relax the uniform subset distribution in the standard subset and subset-phase state
constructions. Our goal is to find technical conditions that a distribution _D_ over (large enough) subsets of [ _N_ ]
should satisfy such that the corresponding subset-phase and subset state ensembles remain close to Haar.
First, we study the conditions for subset-phase states, assuming the phase function is globally uniformly random,
but allowing a generic distribution over subsets:


**Lemma S6** (Subset distributions for Haar-like subset-phase states) **.** _For N_ = 2 _[n]_ _, consider a distribution D over the_
_polylog-sized power set P≥_ polylog([ _N_ ]) _. The information-theoretic condition for phase-subset states induced by D to form_
_t-designs, for t_ = poly( _n_ ) _, is:_


�� _⊗t_

����� _ϕ∼Haar_ **E** ( _N_ ) _[|][ϕ][⟩⟨][ϕ][|][⊗][t][ −]_ _S∼D_ **[E]** _f ∼{_ 0,1 **E** _}_ [[] _[N]_ []] ��� _ψ_ _f_, _S_ _ψ_ _f_, _S_ ��� �����1 = _O_ ( _g_ ( _n_ )) = negl( _n_ ) . (S4)


_Then, an equivalent condition in terms of distributions over subsets of size t is:_

## ∑ | P D ( T ) − P 0( T ) | = O ( g ( n )) = negl( n ) . (S5)

_T∈_ ( [[] _[N]_ _t_ []][)]


_The function g_ ( _n_ ) _in_ (S4) _and_ (S5) _is the same. This reduces the trace distance to the classical total variation distance between_

_−_ 1
_the uniform distribution_ **P** 0( _T_ ) = ( _[N]_ _t_ [)] _, and the distribution induced by D (i.e. sample a subset S from D, then sample a_
_random subset of size t uniformly):_


**1** [ _T ⊂_ _S_ ]
**P** _D_ ( _T_ ) = **E** _S∼D_ . (S6)

( _[|][S][|]_
_t_ [)]


_In other words, from the ‘local’ perspective of most small subsets of size t, it looks as if they are included uniformly in the overall_
_distribution. In the above,_ **1** [ _X_ ] _is the indicator variable taking value 1 if event X occurs, and 0 otherwise._


_**Proof.**_ We note that Proposition 1 in [25] proves a similar result. For a subset distribution _D_, define the following
three matrices which will end up being close:


ΠSym _t_ ([ _N_ ])
_ρ_ 0 _≡_ **E** (S7)
_ϕ∼_ Haar([ _N_ ]) _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_ [ =] dim Sym _[t]_ ([ _N_ ])



_ρ_ [Haar] _D_ _≡_ **E** **E**
_S∼D_ _ϕS∼_ Haar( _S_ ) _[|][ϕ][S][⟩⟨][ϕ][S][|][⊗][t]_ [ =] **[ E]** _S∼D_



ΠSym _t_ ( _S_ )
(S8)
dim Sym _[t]_ ( _S_ )



_ρ_ [phase] _D_ _≡_ **E**
_S∼D_ **[E]** _f_



�� _⊗t_
��� _ψ_ _f_, _S_ _ψ_ _f_, _S_ ��� (S9)


10



First, let us show that _ρ_ [Haar] _D_ and _ρ_ [phase] _D_ are close. This follows from a triangle inequality on term-by-term differences,
when we use the fact that:


�� _⊗t_ 1                - _t_ 2                
���� **E** _f_ ��� _ψ_ _f_, _S_ _ψ_ _f_, _S_ ��� _−_ dim Sym _[t]_ ( _S_ ) ΠSym _t_ ( _S_ )���� = _O_ _|S|_ . (S10)



�� _⊗t_ 1
��� _ψ_ _f_, _S_ _ψ_ _f_, _S_ ��� _−_ ΠSym _t_ ( _S_ )
dim Sym _[t]_ ( _S_ )




   - _t_ 2
= _O_
���� _|S|_
1



_|S|_




. (S10)



This is simply the main result of [41] applied to the set _S_ as opposed to [ _N_ ]. Then the triangle inequality gives us
that:
��� _ρ_ Haar _D_ _−_ _ρ_ [phase] _D_ ��� _[≤]_ **[E]** ���� **E** ��� _ψ_ _f_, _S_ �� _ψ_ _f_, _S_ ��� _⊗t_ _−_ 1 _[t]_ ΠSym _t_ ( _S_ )���� (S11)



�� _⊗t_ 1
��� _ψ_ _f_, _S_ _ψ_ _f_, _S_ ��� _−_ ΠSym _t_ ( _S_ )
dim Sym _[t]_ ( _S_ )



(S11)
����
1



���1 _[≤]_ _S∼D_ **[E]**



**E**
���� _f_




    -    _≤_ **E** _t_ [2] / _|S|_ (S12)
_S∼D_ _[O]_







_≤_ _O_




_t_ [2]

min _S∈_ supp( _D_ ) _|S|_



(S13)



= negl( _n_ ) since supp( _D_ ) _⊂P_ ([ _N_ ])eff . (S14)

Now, what remains is to find the conditions under which _ρ_ [Haar] _D_ is close to the full Haar average _ρ_ 0. First, notice
that _ρ_ [Haar] _D_ (and indeed all of the single-subset terms) commute with _ρ_ 0 since they share the type basis of the full
symmetric subspace. In other words, let the orthonormal basis of Sym _[t]_ ( _S_ ) be made of the single-type vectors _|θ⟩_
for _θ ∈_ Types ( _S_, _t_ ) — where a type _θ_ represents the frequencies of each _s ∈_ _S_ . Specifically, if _S_ = _{s_ 1, . . ., _sm}_, then
_θ_ = ( _ks_ 1, _ks_ 2, . . ., _ksm_ ) with _ks_ 1 + _· · ·_ + _ksm_ = _t_ nonnegative integers. For such a _θ_ type, the corresponding basis vector
_|θ⟩_ is proportional to all type permutations, namely:


## |θ⟩ = | ( ks 1, . . ., ksm ) ⟩ ∝ ∑ σ

_σ∈_ S _t_



_s_ 1, . . ., _s_ 1

 - �� ������� _ks_ 1 times



, _s_ 2, . . ., _s_ 2

 - ��  _ks_ 2 times




     
, . . . . . ., _sm_, . . ., _sm_

    - ��     _ksm_ times



. (S15)



With this choice of orthonormal basis, we have that ΠSym _t_ ( _S_ ) = ∑ _θ∈_ Types( _S_, _t_ ) _|θ⟩⟨θ|_ . Our goal is to have near-equality

between _ρ_ [Haar] _D_ and _ρ_ 0, which means:


_ρ_ 0 _≈_ 1-norm _ρ_ [Haar] _D_ (S16)
1 1
( _[N]_ [+] _t_ _[t][−]_ [1] ) ΠSym _t_ ([ _N_ ]) _≈_ 1-norm _S∼D_ **E** ( _[|][S][|]_ [+] _t_ _[t][−]_ [1] ) ΠSym _t_ ( _S_ ) (S17)

1 1
## ∑ |θ⟩⟨θ| ≈ 1-norm E ∑ |φ⟩⟨φ| . (S18)
( _[N]_ [+] _t_ _[t][−]_ [1] ) _θ∈_ Types([ _N_ ], _t_ ) _S∼D_ ( _[|][S][|]_ [+] _t_ _[t][−]_ [1] ) _φ∈_ Types( _S_, _t_ )


Here _A ≈_ 1-norm _B_ implies that operators _A_ and _B_ are within negl( _n_ ) in 1-norm distance. Notice that both sides here
are diagonal in the same basis of [ _N_ ]-types, since Types ( _S_, _t_ ) _⊂_ Types ([ _N_ ], _t_ ) for any _S ⊂_ [ _N_ ], so it is enough to
evaluate the diagonal elements:


**1** [ _θ ∈_ Types ( _S_, _t_ )]
_⟨θ|ρ_ [Haar] _D_ _|θ⟩_ = **E** for _θ ∈_ Types ([ _N_ ], _t_ ) (S19)
_S∼D_ ( _[|][S][|]_ [+] _[t][−]_ [1] )

_t_

**1** [supp( _θ_ ) _⊂_ _S_ ]
= **E**, (S20)
_S∼D_ ( _[|][S][|]_ [+] _[t][−]_ [1] )

_t_


where we naturally denote by supp( _θ_ ) the set of computational basis elements which have nonzero frequency in the
type _θ_ . Therefore, the trace distance between the two matrices is:



(S21)
�����



1
2



Haar
## ��� ρ 0 − ρD ���1 [=] [1] 2 ∑

_θ∈_ Types([ _N_ ], _t_ )



1
_−⟨θ|ρ_ [Haar] _D_ _|θ⟩_
����� ( _[N]_ [+] _t_ _[t][−]_ [1] )



. (S22)
�����


## = [1] ∑

2
_θ∈_ Types([ _N_ ], _t_ )



1 **1** [supp( _θ_ ) _⊂_ _S_ ]

_−_ **E**
����� ( _[N]_ [+] _t_ _[t][−]_ [1] ) _S∼D_ ( _[|][S][|]_ [+] _t_ _[t][−]_ [1] )


11


We know that because of birthday statistics, we have that the types Types ( _S_, _t_ ) are dominated by the unique types

                     -                     - _t_ [2] ��
( _[S]_ _t_ [)][, since the total number of types is][ (] _[|][S][|]_ [+] _t_ _[t][−]_ [1] ) = ( _[|][S]_ _t_ _[|]_ [)] 1 + _O_ _|S|_ . The correction is negligible because, in our

case, _|S|_ = 2 [polylog][(] _[n]_ [)] while _t_ = poly( _n_ ). Let us show that restricting the above distance to the set of unique types
( [[] _[N]_ []]
_t_ [)][ is enough to have overall small trace distance. Assume then that we have:]


## ∑

_θ∈_ ( [[] _[N]_ _t_ []][)]



1 **1** [ _θ ⊂_ _S_ ]

_−_ **E**
����� ( _[N]_ _t_ [)] _S∼D_ ( _[|][S]_ _t_ _[|]_ [)]



= negl( _n_ ), (S23)
�����



and let us see why this implies that the full sum (S22) is also negligible. This is straightforward: the probability mass
in _ρ_ 0 outside of the unique types adds up to:



( _[N]_
_t_ [)]
## ∑ ⟨θ|ρ 0 |θ⟩ = 1 −

( _[N]_ [+] _[t]_

_θ∈_ Types([ _N_ ], _t_ ) _\_ ( [[] _[N]_ _t_ []][)] _t_


## ∑



( _t_ [)]  - _t_ 2

= _O_
( _[N]_ [+] _[t][−]_ [1] ) _N_
_t_



_N_




= negl( _n_ ) . (S24)



Similarly, the probability mass in _ρ_ [Haar] _D_ on this space of non-unique types adds up to:


## ∑ ⟨θ|ρ [Haar] D |θ⟩ = 1 − ∑

_θ∈_ Types([ _N_ ], _t_ ) _\_ ( [[] _[N]_ _t_ []][)] _θ∈_ ( [[] _t_


## ∑


## ∑ ⟨θ|ρ [Haar] D |θ⟩ (S25)

_θ∈_ ( [[] _[N]_ _t_ []][)]


## = 1 − ∑ ⟨θ|ρ 0 |θ⟩ + negl( n ) by triangle inequality using (S23) (S26)

_θ∈_ ( [[] _[N]_ _t_ []][)]



= negl( _n_ ) because of (S24). (S27)


Therefore, both matrices have negligible support outside of the unique types and the contribution to the TV distance
can be at most negligible. This concludes the proof.


Let us now study the case of subset states. While in the simpler case of the subset-phase states above, one can
safely argue that the condition in Lemma S6 is both necessary and sufficient, for the more combinatorially involved
case of subset states we restrict ourselves to a sufficient condition:


**Lemma S7** (Subset distributions for Haar-like subset state ensembles) **.** _Consider a distribution D over the large-sized_
_subsets P≥_ polylog([ _N_ ]) _. Assume two conditions are satisfied:_


_(a) For any T ∈_ ( [[] _[N]_ _t_ []][)] _[ where t]_ [ =][ poly][(] _[n]_ [)] _[, we have that:]_



**1** [ _T ⊂_ _S_ ]
**E**
_S∼D_ _[|][S][|]_



. (S28)
( _[N]_
_t_ [)]



_⊂_ _S_ ]

= [1][ +] _[ O]_ [ (] _[g]_ [(] _[n]_ [))]
( _[|][S]_ _t_ _[|]_ [)] ( _[N]_ _t_ [)]



_(b) For any two T_, _T_ _[′]_ _∈_ ( [[] _[N]_ _t_ []][)] _[ where t]_ [ =][ poly][(] _[n]_ [)] _[, there is a][ γ]_ [(] _[n]_ [)] _[ >]_ [ 0] _[ such that:]_



**1** [ _T ∪_ _T_ _[′]_ _⊂_ _S_ ]
**E**
_S∼D_ _[|][S][|]_



_γ_ ( _n_ ) _[d]_ [(] _[T]_ [,] _[T][′]_ [)], (S29)
( _[N]_
_t_ [)]



_T_ _⊂_ _S_ ]

_≤_ [1][ +] _[ O]_ [ (] _[g]_ [(] _[n]_ [))]
( _[|][S]_ _t_ _[|]_ [)] ( _[N]_ _t_ [)]



_where d_ ( _T_, _T_ _[′]_ ) = _|T \ T_ _[′]_ _|_ = _|T ∪_ _T_ _[′]_ _| −_ _t_ = _t −|T ∩_ _T_ _[′]_ _| is the set distance between T and T_ _[′]_ _._


Then we have that the resulting subset state distribution is close to Haar in trace distance:

**E** **E** _≤_ _O_ ( _g_ ( _n_ )) + _O_ ( _tγ_ ( _n_ )), for _t_ = poly( _n_ ). (S30)
���� _S∼D_ _[|][S][⟩⟨][S][|][⊗][t][ −]_ _ϕ∼_ Haar([ _N_ ]) _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_ ����
1


_**Proof.**_ The proof follows by a simple modification of the calculation in [19] which addresses the case of a uniform
distribution over _m_ -subsets. Notice that in that case the parameter _γ_ is _m_ / _N_ = negl( _n_ ).


12


**S4.** **SCHMIDT-PATCHED STATES**


We begin by stating the general definition of a Schmidt patch subset phase state and a Schmidt patch subset state.


**Construction S4.1** (Schmidt patch subset phase state) **.** Consider two Hilbert spaces _HA_, _B_ of dimension _NA_, _B_ . For a
rank _R_ and two sequences of disjoint _MA_ -subsets _A_ 1, . . ., _AR ∈_ ( [[] _M_ _[N][A]_ _A_ []][)][ and disjoint] _[ M][B]_ [-subsets] _[ B]_ [1][, . . .,] _[ B][R][ ∈]_ [(][[] _M_ _[N][B]_ _B_ []][)][,]
construct the **patched phase-subset state** state on _HA ⊗HB_ :




    - 1
���Ψ _A_ 1: _R_, _B_ 1: _R_, _f_ _≡_ ~~_√_~~
_MA_ _MBR_



_R_
## ∑ j =1 x [∑] ∈Aj

_y∈Bj_



( _−_ 1) _[f]_ [ (] _[x]_ [,] _[y]_ [)] _|x⟩A ⊗|y⟩B_ . (S31)



In the main article, the state defined in Eq. (2) is a particular case with _MA_ = _MB_ = _M_ . When taking _f_ to be the
all-zero function (i.e., all phases are one), this becomes simply a Schmidt patch subset state, which Schmidt-patches
together _R_ pairs of subset states:



��Ψ _A_ 1: _R_, _B_ 1: _R_ - _≡_ ~~_√_~~ _MA_ 1 _MBR_



_R_
## ∑

_j_ =1



_R_
## ∑ j =1 x [∑] ∈Aj

_y∈Bj_



�� _Aj_ 


_A_ _[⊗]_ �� _Bj_ - _B_ [=] ~~_√_~~ 1

_MA_ _MBR_



_|x⟩A ⊗|y⟩B_ . (S32)



In this construction, we allow for rank _R_ across a known, fixed cut and is defined by the subsets _{_ ( _Aj_, _Bj_ ) _}_ _[R]_ _j_ =1 [.]
Next, we show that these states can be prepared efficiently.


**A.** **Preparing Schmidt-patch states**


Let _R_ = 2 _[r]_, _MA_ = 2 _[k][A]_, _MB_ = 2 _[k][B]_, _NA_ = 2 _[n][A]_ and _NB_ = 2 _[n][B]_, where _nA_ + _nB_ = _n_ . Then, there is an efficient
circuit (See Fig. S1) that prepares pseudorandom samples from the uniform distribution over subset phase states
from classical one-way functions. The construction is simple and uses known efficient circuits for pseudorandom
permutations (PRP) on each subsystem: _A_ (qubits 1 through _nA_ /2) and _B_ (qubits _nA_ /2 + 1 through _n_ ). The steps
are outlined below


1. From the _|_ 0 _[n][A]_ _⟩A |_ 0 _[n][B]_ _⟩B_ initial state, prepare _r_ Bell states on the qubits pairs (1, _nA_ + 1), (2, _nA_ + 2), . . . ( _r_, _nA_ + _r_ ),
thus entangling subsystems _A_ and _B_ with _r_ bits of entanglement. Also apply Hadamards to the next _kA_ qubits
of subsystem _A_ and _kB_ qubits of subsystem _B_ .


2. Apply independent pseudorandom _SNA_ -permutations _σA_ = PRP _SNA_ ( _kA_ ) and _SNB_ permutations _σB_ =
PRP _SNB_ ( _kB_ ) to subsystem _A_ and _B_ respectively. This results in a Schmidt patch subset state.






|k|Col2|Col3|Col4|Col5|
|---|---|---|---|---|
|_kA_<br>_nA_/2_−kA−r_<br>_r_<br>_nB_/2_−kB−r_<br>_kB_<br>_H⊗kA_<br>_H⊗kB_|_H⊗kA_||PRP_NA_||
|_kA_<br>_nA_/2_−kA−r_<br>_r_<br>_nB_/2_−kB−r_<br>_kB_<br>_H⊗kA_<br>_H⊗kB_|_H⊗kA_||PRP_NA_||
|_kA_<br>_nA_/2_−kA−r_<br>_r_<br>_nB_/2_−kB−r_<br>_kB_<br>_H⊗kA_<br>_H⊗kB_|_H⊗kA_||PRP_NB_|PRP_NB_|
|_kA_<br>_nA_/2_−kA−r_<br>_r_<br>_nB_/2_−kB−r_<br>_kB_<br>_H⊗kA_<br>_H⊗kB_|_H⊗kA_||PRP_NB_||
|_kA_<br>_nA_/2_−kA−r_<br>_r_<br>_nB_/2_−kB−r_<br>_kB_<br>_H⊗kA_<br>_H⊗kB_|_H⊗kB_|_H⊗kB_|_H⊗kB_|_H⊗kB_|
|_kA_<br>_nA_/2_−kA−r_<br>_r_<br>_nB_/2_−kB−r_<br>_kB_<br>_H⊗kA_<br>_H⊗kB_|_H⊗kB_||||



Figure S1. Quantum circuit for preparing a Schmidt patch subset state


In order to obtain a Schmidt patch subset phase state, apply a pseudorandom function _f_ = PRF _k f_ : [ _N_ ] _�→{_ 0, 1 _}_
via a phase oracle, as usual.


13


In the main article, the state in Eq. (2) is a Schmidt patch subset phase state with _nA_ = _nB_ = _n_ /2 and _kA_ = _kB_ = _k_ .
It is easy to see that in this case, the output of the circuit in Fig. S1 leads to the final state (define _n_ _[′]_ _≡_ _n −_ _k −_ _r_ ):



_A_



(S33)
_B_


## |ψM, R⟩ = 2 [−][r] [/2] [−][k] ∑

_x∈{_ 0,1 _}_ _[r]_

_a_, _b∈{_ 0,1 _}_ _[k]_




  ��� _σA_ _x_ . _a_ .0 _[n][′]_ [��]




  ��� _σB_ _x_ . _b_ .0 _[n][′]_ [��]



1
= ~~_√_~~

_M_



_R_



_R_
## ∑ ∑ |x⟩A |y⟩B . (S34)

_j_ =1 _x∈Aj_, _y∈Bj_




                           By adding the pseudorandom phase function we obtain the state ��� _ψM_, _R_, _f_ in Eq. (2). Upon inspection, it is easy to
notice that if _σA_, _σB_ were genuine random samples from _S_ 2 _n_ /2, the above results in a uniform random sample from
the corresponding set of patched subset phase states.


**B.** **Schmidt-patch states are close to Haar random states**


In this section, we prove that both the Schmidt-patch subset state and the Schmidt-patch subset-phase states are
statistically close to Haar random states. For simplicity, we consider _MA_ = _MB_ = _M_


**Lemma S8** (Proximity to Haar) **.** _Consider the construction_ (S32) _of_ ( _M_, _R_, _NA_, _NB_ ) _-Schmidt-patch subset states across an_
_A −_ _B cut, such that subsystem A is of ℓ_ _qubits while subsystem B is of n −_ _ℓ_ _qubits. In other words, NA_ = 2 _[ℓ]_ _and NB_ = 2 _[n][−][ℓ]_ _,_
_with N_ = _NA · NB_ = 2 _[n]_ _. Also, define D_ = min _{NA_, _NB}. Furthermore, let the rank across the cut be R_ = 2 [polylog][(] _[n]_ [)] _, and_
_the patched disjoint subsets be of size_ �� _Aj_ �� = �� _Bj_ �� = _M. Assume furthermore that_ _M_ 2 _NR_ 3/2 _<_ 1 _. Then, random subset states of_

_this form are close to Haar under t_ = poly( _n_ ) _number of copies:_



**E**
���� _A_ 1: _R_, _B_ 1: _R_



��Ψ _A_ 1: _R_, _B_ 1: _R_ ��Ψ _A_ 1: _R_, _B_ 1: _R_ �� _⊗t −_ _ϕ∼_ Haar( **E** _HA⊗HB_ ) _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_ ����1 _≤_ _O_ - _Mt_ 3




- - _t_ 2
+ _O_

_D_




- - _t_ 2
+ _O_




- - _t_
+ _O_ ~~_√_~~

_R_




- - _t_
+ _O_ ~~_√_~~




. (S35)



_As a corollary, introducing random global phases makes the associated subset-phase ensemble close to Haar irrespective of the_
_value of R:_




. (S36)



**E**
���� _A_ 1: _R_, _B_ 1: _R_, _f_



�� _⊗t_     - _t_ 3
���Ψ _A_ 1: _R_, _B_ 1: _R_, _f_ Ψ _A_ 1: _R_, _B_ 1: _R_, _f_ ��� _−_ _ϕ∼_ Haar( **E** _HA⊗HB_ ) _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_ ����1 _≤_ _O_ _M_




- - _t_ 2
+ _O_

_D_




- - _t_ 2
+ _O_



We prove Lemma S8 using a series of non-trivial steps. Note that this reduces to a counting problem, as outlined
in Lemma S6 (for Schmidt-patch subset phase states) and Lemma S7 (for Schmidt-patch subset states), respectively.
Let us first introduce some definitions which capture the distribution of the subsets:


**Definition S9** (Doubly-unique _t_ -subsets) **.** _Assume n is even. The_ _**doubly-unique**_ _t_ _**-subsets**_ _of {_ 0, 1 _}_ _[n]_ _, denoted by_ Σ2, _t ⊂_
( _[{]_ [0,1] _t_ _[}][n]_ ) _, are defined as the t-subsets for which both the first halves of the strings are unique, as well as the second halves of the_
_strings:_




  -   - _{_ 0, 1 _}n_ /2 _× {_ 0, 1 _}n_ /2
Σ2, _t ≡_ _{xi_ . _yi}i_ _[t]_ =1 _[∈]_ _t_




: _∀i ̸_ = _j_, _xi ̸_ = _xj_, _yi ̸_ = _yj_




(S37)



**Remark.** _A standard birthday asymptotic tells us that almost all t-subsets are doubly-unique:_




   - _N_
_|_ Σ2, _t|_ =
_t_



�� - _t_ 2
1 _−_ _O_ ~~_√_~~



~~_√_~~



_N_



��
. (S38)



**Definition S10** (Bipartite components of subset) **.** _Consider an arbitrary p-subset of the Boolean cube P_ =
_{x_ 1. _y_ 1, . . ., _xp_ . _yp} ∈_ ( _[{]_ [0,1] _[}][n]_ [/2] _[×{]_ _p_ [0,1] _[}][n]_ [/2] ) _. We can interpret the elements xj_ . _yj as edges in a bipartite graph on {_ 0, 1 _}_ _[n]_ [/2] _×_

_{_ 0, 1 _}_ _[n]_ [/2] _. Consider the non-trivial (i.e. ignoring components which include a single vertex) connected components of this_
_graph. If subset P has ℓ_ _such connected components, then each component is supported on a specific subset of the form_


14



**7**

_X_ 2



**1**


**1**



_Y_ 1


**2**

_X_ 1



**3**



**4**


**4**



**5**


**5**



_Y_ 2


**6**



_√_
Figure S2. Example of the notions introduced in Definition S10. A subset of [



_√_
_N_ ] _×_ [



Figure S2. Example of the notions introduced in Definition S10. A subset of [ _N_ ] _×_ [ _N_ ] can be naturally viewed as a bipartite

graph; in the above example, the subset is _T_ = _{_ (1, 1), (1, 2), (2, 2), (2, 3), (7, 5), (7, 6) _}_ . According to Definition S10, the bipartite
components are _X_ 1 = _{_ 1, 2 _}_, _Y_ 1 = _{_ 1, 2, 3 _}_, and _X_ 2 = _{_ 7 _}_, _Y_ 2 = _{_ 5, 6 _}_ . The number of unique half-strings would be _uT_ = 8.



_Xj × Yj ⊂{_ 0, 1 _}_ _[n]_ [/2] _× {_ 0, 1 _}_ _[n]_ [/2] _. Let us denote the collection_ ( _X_ 1, _Y_ 1), . . ., ( _Xℓ_, _Yℓ_ ) _the_ _**bipartite components**_ _of subset_
_P, which is uniquely defined for a specific P. Let us also denote:_


_uP ≡|X_ 1 _|_ + _· · ·_ + _|Xℓ|_ + _|Y_ 1 _|_ + _· · ·_ + _|Yℓ|_ (S39)


_as the number of_ _**total unique half-strings**_ _in subset P._


_Formally:_ ( _X_ 1, _Y_ 1), . . ., ( _Xℓ_, _Yℓ_ ) _are bipartite components of subset P if X_ 1, . . ., _Xℓ_ _are disjoint (not necessarily equal-sized)_
_subset of {_ 0, 1 _}_ _[n]_ [/2] _(and the same goes for Y_ 1, . . ., _Yℓ), and furthermore:_


_∀_ _j ∈_ [ _ℓ_ ] :



_∀_ _x ∈_ _Xj_, _∃_ _y ∈_ _Yj such that x_ . _y ∈_ _P_, ∄ _y ∈{_ 0, 1 _}_ _[n]_ [/2] _\ Yj such that x_ . _y ∈_ _P_,

_∀_ _y ∈_ _Yj_, _∃_ _x ∈_ _Xj such that x_ . _y ∈_ _P_, ∄ _x ∈{_ 0, 1 _}_ _[n]_ [/2] _\ Xj such that x_ . _y ∈_ _P_ .


_See Figure S2 for an illustration._



(S40)



**Definition S11** (Family of Schmidt-patch subset states) **.** _Let FM_, _R_, _N ∈_ ( _[{]_ [0,1] _[}][n]_ [/2] _M_ _[×{]_ [2] _R_ [0,1] _[}][n]_ [/2] ) _be the family of M_ [2] _R-subsets of_

[ _N_ ] _which patch R pairs of disjoint M-subsets on the two half-cubes, as in construction_ (S32) _._

**Fact 1.** Consider an arbitrary _p_ -subset of the Boolean cube _P_ = ( _[{]_ [0,1] _[}][n]_ [/2] _[×{]_ _p_ [0,1] _[}][n]_ [/2] ) with _t_ bipartite components and
number of total unique half-strings _uP_ . Assuming _p < M_, we have that:



# _{S ∈FM_, _R_, _N_ : _P ⊂_ _S}_



_∈FM_, _R_, _N_ : _P ⊂_ _S}_ - _M_

= ~~_√_~~
# _{S ∈FM_, _R_, _N}_



_N_



_N_




- _uP_ - - _p_ 3
_R_ _[t]_ _×_ 1 + _O_

_M_




- - _p_ 2
+ _O_ ~~_√_~~



~~_√_~~



��
. (S41)



_**Proof.**_ The _S_ subsets in the family are composed as:


_S_ = _A_ 1. _B_ 1 _⊔· · · ⊔_ _AR_ . _BR_, (S42)



where _P_ . _Q_ denotes all concatenations in the cartesian product, i.e. _P_ . _Q_ = _{p_ . _q}p∈P_, _q∈Q_ . Here, _A_ 1: _R_ are disjoint
_√_
_M_ -subsets of [ _N_ ], and the same goes for _B_ 1: _R_ . We first count the number of ways _R_ pairs of boxes of size _M_ can be



_M_ -subsets of [ _N_ ], and the same goes for _B_ 1: _R_ . We first count the number of ways _R_ pairs of boxes of size _M_ can be

filled. The number of ways to fill the _A_ 1: _R_ boxes with _M_ elements in each box is simply

_√_

         - _[√]_ �� _[√]_         -         - _[√]_         


_N −_ _M_
_M_




- - _[√]_

_· · ·_



_N −_ _RM_
_M_



_√_

= ~~_√_~~



~~_√_~~
_M_ ! _[R]_ (



.
_N −_ _MR_ )!



_N_
_M_



�� _[√]_



_N_ !



The ordering of the _Ai_ boxes are not important and so the accounting for this fact we have that the number of
(unordered) ways to fill the _A_ 1: _R_ boxes is
_√_



_R_ ! [.]



~~_√_~~
_M_ ! _[R]_ (



_N_ !

_×_ [1]
_N −_ _MR_ )! _R_ !



_N_ !



By the same argument, we can fill up the _B_ 1: _R_ boxes with _M_ elements. So overall, the _A_ 1: _R_ and _B_ 1: _R_ boxes can be
filled up in

            - _√_ �2



�2



~~_√_~~
_M_ ! _[R]_ (



_N_ !

_×_ [1]
_N −_ _MR_ )! _R_ !



_N_ !



_R_ !


15


ways. Finally, note that in order to count the number of _S_ -subsets, we need to pair up the _A_ and _B_ boxes. This
matching can be done in _R_ ! ways. Thus the total number of _S_ subsets is:



_N_ !



# _{S ∈FM_, _R_, _N}_ = [1]

_R_ !




- _√_



~~_√_~~
_M_ ! _[R]_ (



_N −_ _MR_ )!



�2
. (S43)



Having obtained the denominator of the ratio in the LHS of Eq. (S41), we now focus on the numerator.
Let the bipartite set components making up the set _P_ be ( _X_ 1, _Y_ 1), . . ., ( _Xt_, _Yt_ ). In order to calculate the denominator,
i.e. # _{S ∈FM_, _R_, _N}_, we need to enumerate the ways in which the elements of _P_ can be allocated into the _Aj_ . _Bj_ blocks
of _S_ . For this, we see that each bipartite component pair must belong to the same _Aj_ . _Bj_ block, i.e., _Xk ∈_ _Aj_ iff
_Yk ∈_ _Bj_ . Therefore, we can restrict the problem to enumerating the number of ways in which the _t_ component pairs
are allocated across the blocks. Let _µ_ = 1 _[µ]_ [1] 2 _[µ]_ [2] . . . _t_ _[µ][t]_ be an integer partition of _t_ . Denote by _|µ|_ = _µ_ 1 + _· · ·_ + _µt_
the number of parts in _µ_ . For a specific integer partition _µ_, consider all set partitions of _{_ ( _X_ 1, _Y_ 1), . . ., ( _Xt_, _Yt_ ) _}_ that
follow the pattern of _µ_, and consider allocations of these parts into the _Aj_ . _Bj_ blocks that make up _S_ . In other words,
we would like to count all subsets _S_ such that _µ_ 1 blocks contain a single ( _Xk_, _Yk_ ) component, _µ_ 2 blocks contain two
components, etc.
In order to enumerate this quantity, let us first look at the number of ways to partition the set of _t_ components
according to the partition type _µ_ . For this, notice the number of ways by which we can choose _µ_ 1 (the number
of boxes holding a single component) out of the _t_ components is ( _µ_ _[t]_ 1 [)][. Then, we can choose] _[ µ]_ [2][ (boxes holding]

two components) out of ( _[t][−]_ _µ_ 2 _[µ]_ [1][)][ ways. Continuing in this way, we obtain that the total number of ways in which] _[ t]_
components can be distributed according to the partition _µ_ is simply the multinomial coefficient




- _t_ - _t_ !

= _≡_

_µ_ 1, _µ_ 2, _· · ·_, _µt_ _µ_ 1! _µ_ 2! . . . _µt_ !



Furthermore, the _j_ components in each of the _µj_ boxes need not be ordered. We need to account for this 1/ _j_ ! _[µ][j]_ ways.
So overall, we can allocated _t_ components according to _µ_ in




- _t_

_µ_




- _t_ !
=
1! _[µ]_ [1] . . . _t_ ! _[µ][t]_ _µ_ 1! . . . _µt_ ! [.]



Here, we define _{µ_ _[t]_ _[}]_ [ is the number of ways of partitioning the set of] _[ t]_ [ components according to partition type] _[ µ]_ [, de-]

fined analogously to the Stirling number of the second kind ( _{k_ _[t][}]_ [ is the Stirling number of the second kind, denoting]
the number of set partitions of [ _t_ ] into _k_ non-empty parts).
Next, for a particular partition _µ_, we count the number of ways the remaining elements of the _A_ 1: _R_ and _B_ 1: _R_ boxes
can be filled so that we make sure each box has exactly _M_ elements. Observe that we have _Ai · Bi_ boxes that are
already _occupied_ by the bipartite components. Given _µ_, there are _|µ|_ such _occupied_ pairs of boxes in all. The rest of the
_R −|µ|_ boxes are _unoccupied_ : they do not contain any of these components. Both these categories of boxes ( _occupied_
and _unoccupied_ ) need to be filled with _M_ elements each. This leads us to two cases.
Let us first consider the _A_ 1: _R_ boxes that have been _occupied_ by the bipartite components. Each of the _Ai_ boxes need
to be filled until they have _M_ elements each. The number of ways the _occupied A_ 1: _R_ boxes can be filled up is given by




     _N −_ ∑ _[t]_ _j_ =1 _[|][X][j][|]_ !



_√_




_N −_ ∑ _[t]_ _j_ =1 _[|][X][j][|]_




- _√_




~~�~~ ~~_√_~~
∏ _[|]_ _j_ _[µ]_ = _[|]_ 1




~~�~~ .
_N −_ ∑ _[t]_ _j_ =1 _[|][X][j][|]_ ! _×_ ( _N −_ _M|µ|_ )!



_M −_ ∑ _Xi∈_ part 1 _|Xi|_, _M −_ ∑ _Xi∈_ part 2 _|Xi|_, _· · ·_, _M −_ ∑ _Xi∈_ part _|µ| |Xi|_




=



Similarly, in the same number of ways, we can fill up the _occupied B_ 1: _R_ boxes. So, the number of ways to fill up the
_occupied A_ 1: _RB_ 1: _R_ boxes is given by




- _√_




     -      - _√_
_N −_ ∑ _[t]_ _j_ =1 _[|][X][j][|]_ ! _×_




     _N −_ ∑ _[t]_ _j_ =1 _[|][Y][j][|]_ !




~~�~~ ~~_√_~~
∏ _[|]_ _j_ _[µ]_ = _[|]_ 1




~~�~~ ~~�~~ ~~_√_~~
_N −_ ∑ _[t]_ _j_ =1 _[|][X][j][|]_ ! _×_ ∏ _[|]_ _j_ _[µ]_ = _[|]_ 1




~~�~~ (S44)
_N −_ ∑ _[t]_ _j_ =1 _[|][Y][j][|]_ ! _×_ ( _N −_ _M|µ|_ )! [2] [.]



Next, we deal with the remaining _R −|µ|_ boxes that did not contain any bipartite components, which we referred
previously to as _unoccupied_ boxes. Since these need to be filled with exactly _M_ elements, the enumeration problem


16


is similar to the arguments that went into the derivation of Eq. (S43). Let us deal with allocating strings to the
_unoccupied A_ boxes first. This can be done in

                   - _√_                   
_N −_ _M|µ|_ !




~~�~~ ~~_√_~~
_M_ ! _[R][−|][µ][|]_ _×_




~~�~~,
_N −_ _MR_ ! _×_ ( _R −|µ|_ )!



ways. The _B_ boxes can also be filled up in the same number of ways. Overall, the number of ways to allocate
elements to these remaining _R −|µ|_ boxes (also taking into account that these boxes can be matched up in ( _R −|µ|_ )!
ways) is given by

                   - _√_                   



    _N −_ _M|µ|_ ! [2]



~~_√_~~
_M_ ! [2][(] _[R][−|][µ][|]_ [)] _×_ (



(S45)
_N −_ _MR_ )! [2] _×_ ( _R −|µ|_ )!



The product of Eq. (S44) and Eq. (S45) gives us the required number of ways _t_ components can be allocated to the
pairs of boxes for a specific partition _µ_ . Then, overall, we have that:



# _{S ∈FM_, _R_, _N_ : _P ⊂_ _S}_




     _N −_ ∑ _i_ _[t]_ =1 _[|][Y][i][|]_ !




~~�~~
_N −_ _MR_ ! [2] _[×]_




     -      - _√_
_N −_ ∑ _i_ _[t]_ =1 _[|][X][i][|]_ ! _×_



1
( _M −_ ∑ _|Xi|_ )! _[×]_
_Xi∈_ part _j_



1
(S46)
( _M −_ ∑ _|Yi|_ )! [.]
_Yi∈_ part _j_




  - _t_

=
# ∑ µ

_µ_




- _√_




_×_




~~�~~ ~~_√_~~
( _R −|µ|_ )! _× M_ ! [2][(] _[R][−|][µ][|]_ [)] _×_



_|µ|_
## ∏

_j_ =1



_|µ|_
## ∏

_j_ =1



The above seems complicated but in the birthday regime it simplifies considerably. In particular, notice that the
number of unique half-strings decouples from the way they are allocated across components inside _P_ . For instance,
while taking the ratio between Eq. (S46) and Eq. (S43), we can use birthday approximations such as



_√_
(



_j_ =1 _[j]_ 1

=
_N_ ! ~~�~~ _√_ ~~�~~ ∑




















- �2
∑ _[t]_ _j_ =1 _[|][X][j][|]_



_N −_ ∑ _[t]_ _j_ =1 _[|][X][j][|]_ [)][!]
~~_√_~~




~~�~~ ∑ _tj_ =1 _[|][X][j][|]_
_N_



_N_






1 + _O_




~~_√_~~



Also,












- �2
∑ _Xi∈_ part _j |Xi|_

_M_














1 + _O_








_|µ|_
## ∏

_j_ =1




_M_ !
( _M −_ ∑ _Xi∈_ part _j |Xi|_ )!







=



_|µ|_
## ∏ M [∑] [Xi] [∈] [part] [ j][ |][X][i][|]

_j_ =1














= _M_ [∑] _[t]_ _j_ =1 _[|][X][j][|]_


When the smoke clears, we have that the desired ratio:



1 + _O_




 - �2

∑ _[|]_ _j_ _[µ]_ = _[|]_ 1 ∑ _Xi∈_ part _j |Xi|_





_M_



# _{S ∈FM_, _R_, _N_ : _P ⊂_ _S}_



_∈FM_, _R_, _N_ : _P ⊂_ _S}_ - _M_

= ~~_√_~~
# _{S ∈FM_, _R_, _N}_




- _R_ !
(S47)
( _R −_ _k_ )!



_N_



_N_




- _|X_ 1 _|_ + _···_ + _|Xt|_ + _|Y_ 1 _|_ + _···_ + _|Yt|_ - - _p_ 3
1 + _O_

_M_




- - _p_ 2
+ _O_ ~~_√_~~



~~_√_~~



�� _t_
## ∑

_k_ =0




- _t_
_k_



��
. (S48)




 - _M_
= ~~_√_~~

_N_




- _uP_ - - _p_ 3
_R_ _[t]_ 1 + _O_

_M_




- - _p_ 2
+ _O_ ~~_√_~~



~~_√_~~



_N_



where we used the standard combinatorial identity: ∑ _[n]_ _k_ =0 _[{][n]_ _k_ _[}][x]_ [(] _[x][ −]_ [1][)][ . . .][ (] _[x][ −]_ _[k]_ [ +][ 1][) =] _[ x][n]_ [.]


This proof can be easily generalized to the asymmetric case where _A_ 1: _R_ are disjoint _M_ -subsets of [2 _[ℓ]_ ], while _B_ 1: _R_ are
disjoint _M_ -subsets of [2 _[n][−][ℓ]_ ]. This allows us to incorporate asymmetric Schmidt-patch states where subsystem _A_ is



of _ℓ_ qubits while _B_ is of _n −_ _ℓ_ qubits. So, _NA_ = 2 _[ℓ]_ and _NB_ = 2 _[n][−][ℓ]_ . In this case consider (i) _FM_, _R_, _N_, _ℓ_ _∈_ ( _[{]_ [0,1] _[}][ℓ][×{]_ [2][0,1] _[}][n][−][ℓ]_



and (ii) for _p < M_, _p_ -subset of the Boolean cube _P_ = ( _[{]_ [0,1] _[}][ℓ][×{]_ _p_ [0,1] _[}][n][−][ℓ]_ ). Then, it is easy to see that



),
_M_ [2] _R_







# _{S ∈FM_, _R_, _N_, _ℓ}_ = _R_ [1] !




(2 _[ℓ]_ )!
_M_ ! _[R]_ (2 _[ℓ]_ _−_ _MR_ )!




_·_




- (2 _[n][−][ℓ]_ )!
_M_ ! _[R]_ (2 _[n][−][ℓ]_ _−_ _MR_ )!



. (S49)


On the other hand,


# _{S ∈FM_, _R_, _N_ : _P ⊂_ _S}_



1
( _M −_ ∑ _|Xi|_ )! _[×]_
_Xi∈_ part _j_



17


1
( _M −_ ∑ _|Yi|_ )! [.]
_Yi∈_ part _j_

(S50)



_|µ|_
## ∏

_j_ =1



=
# ∑

_µ_




    - _NA_ _−_ ∑ _i_ _[t]_ =1 _[|][X][i][|]_ �! _×_     - _NB_ _−_ ∑ _i_ _[t]_ =1 _[|][Y][i][|]_ �!
( _R −|µ|_ )! _× M_ ! [2][(] _[R][−|][µ][|]_ [)] _×_ ( _NA −_ _MR_ )! _×_ ( _NB −_ _MR_ )! _[×]_




- _t_

_µ_




_×_



_|µ|_
## ∏

_j_ =1



Proceeding as before, the ratio of these two expressions simplify owing to birthday approximations. In the end, we
have the following:








 -  - _p_ 3
_R_ _[t]_ 1 + _O_

_M_



��
(S51)




- - _p_ [2]
+ _O_

2 [min] _[{][ℓ]_ [,] _[n][−][ℓ][}]_



# _{S ∈FM_, _R_, _N_, _ℓ_ : _P ⊂_ _S}_

=
# _{S ∈FM_, _R_, _N_, _ℓ}_




_M_ _[u][p]_

_NA_ [∑] _[i][ |][X][i][|]_ _× NB_ [∑] _[i][ |][Y][i][|]_




- - _p_ 2
+ _O_

_D_




 - _M_
_≤_

_D_




- _up_ - - _p_ 3
_R_ _[t]_ 1 + _O_

_M_



��
, (S52)



where _D_ = min _{NA_, _NB}_ .
**Fact 2.** Consider two arbitrary _t_ -subsets _T_, _T_ _[′]_ _∈_ Σ2, _t_ at distance _d_ ( _T_, _T_ _[′]_ ) = _d ≥_ 1, where _d_ ( _T_, _T_ _[′]_ ) _≡|T ∪_ _T_ _[′]_ _| −_ _t_
denotes the Hamming distance between two _t_ -subsets. Denote by _uT∪T′_ the number of total unique half-strings in
_T ∪_ _T_ _[′]_ . Let the number of bipartite components in _T ∪_ _T_ _[′]_ be _ℓ_ = _t −_ _d_ + _k_ . Then we have that:


(a) 1 _≤_ _k ≤_ 2 _d_ .

(b) 2 _t_ + _⌈_ [4] _[k][−]_ 3 [2] _[d]_ _⌉≤_ _uT∪T′ ≤_ 2 _t_ + _k_ .

_**Proof.**_ Let _T_, _T_ _[′]_ _∈_ Σ2, _t_ be two doubly unique _t_ -subsets, such that _T_ = _{x_ 1. _y_ 1, . . ., _xt_ . _yt}_ and _T_ _[′]_ = _{x_ 1 _[′]_ [.] _[y]_ 1 _[′]_ [, . . .,] _[ x]_ _t_ _[′]_ [.] _[y][′]_ _t_ _[}]_ [.]
Denote disjoint sets _X_ 1, . . ., _Xℓ_ _⊂{_ 0, 1 _}_ _[n]_ [/2] and _Y_ 1, . . ., _Yℓ_ _⊂{_ 0, 1 _}_ _[n]_ [/2] such that ( _X_ 1, _Y_ 1), . . ., ( _Xℓ_, _Yℓ_ ) form the
bipartite components (cf. Definition S10) of _T ∪_ _T_ _[′]_, i.e. the connected components of the corresponding bipartite
graph with the elements of _T_ and _T_ _[′]_ as the edges. Imagine coloring the _T_ and _T_ _[′]_ vertices in two different colors:



“I” pattern


“V” pattern



“N” pattern



“ _▷◁_ ” pattern



“W” pattern



_t −_ _d_ components _k_ components, _d_ + _d_ edges


The fact that _T_, _T_ _[′]_ are doubly-unique _t_ -subsets imposes some constraints. First, if the Hamming distance between
the two _t_ -subsets is _d_ ( _T_, _T_ _[′]_ ) = _d_, then there are _t −_ _d_ elements in common, i.e. there are _t −_ _d_ pairs _xj_ . _yj ∈_ _T_
which are also pairs _xi_ _[′]_ [.] _[y]_ _i_ _[′]_ _[∈]_ _[T][′]_ [. In terms of our graph picture, this means there are] _[ t][ −]_ _[d]_ [ components] _[ X][j]_ [.] _[Y][j]_ [ of size]
�� _Xj_ �� = �� _Yj_ �� = 1, represented by double-edged two-vertices sub-graphs. The other _k_ components must be made of
non-doubled edges, since they belong to pairs _xj_ . _yj ∈_ _T_ which do not exist also in _T_ _[′]_ . However, we must account
for the combinatorics of the possible ways in which these mismatched elements can still share half-strings. The fact
that _T_, _T_ _[′]_ are doubly-unique subsets means that we cannot have two edges of the same color (i.e. belonging to the
same subset) sharing a vertex.


Notice that the remaining _k_ bipartite components are made of a number of edges equal to _d_ edges coming from _T_
(depicted in blue), plus another _d_ edges belonging to _T_ _[′]_ (denoted in red). This immediately implies the first claim:
1 _≤_ _k ≤_ 2 _d_ . The lower bound is achieved if all edges form one component, and the upper bound is achieved when
all of the edges are in a component of their own.


Next, because of the double-uniqueness of _T_ and _T_ _[′]_, these _k_ components can be of the following types:


(a) Components containing only one edge (an “I” pattern), two edges sharing a vertex (a “V” pattern), or three
edges in an “N” pattern. This means the number of vertices in a components is equal to the number of edges
plus one.


18


(b) If made of four or more edges, the edges can either form a closed loop (an “bowtie” _▷◁_ pattern), or an open line
(a “W” pattern). This means that the number of vertices in a component is either equal to the number of edges,
or is equal to the number of edges plus one.


                                      -                                       When allocating _d T_ -edges and _d T_ _[′]_ -edges across _k_ components, we must make use of at least max 0, _⌈_ [4] _[k][−]_ 3 [2] _[d]_ _⌉_

components of size 1, 2, or 3. For such components, we know that the number of vertices is forced to be equal to the
number of edges. As noted above, for components with four or more edges, the number of vertices can be equal to
the number of edges, or equal to the number of edges plus one. Therefore, to count the number of unique half-strings
_uT∪T′_ we must add 2( _t −_ _d_ ) (coming from the components which correspond to _T ∩_ _T_ _[′]_ ) and the number of vertices
coming from the above counting argument. This leads to the stated bound.


**Fact 3.** Consider two arbitrary _t_ -subsets _T_, _T_ _[′]_ _∈_ Σ2, _t_, and assume 2 _t ≤_ _M_ and also _[M]_ [2] _N_ _[R]_ [3/2] _<_ 1. Then we have that:




- _t_



if _d_ ( _T_, _T_ _[′]_ ) = _d ≥_ 1.




- _M_ 2 _R_



_N_




 -  - _t_ 3
_×_ 1 + _O_



_N_



_M_




- - _t_ 2
+ _O_ ~~_√_~~



~~_√_~~



(S53)



# _{ S ∈FM_, _R_, _N_ : _T ∪_ _T_ _[′]_ _⊂_ _S }_

=
# _{ S ∈FM_, _R_, _N }_











 - _M_ 2 _R_
_≤_

_N_




 - _M_ 2 _R_
_≤_



if _d_ ( _T_, _T_ _[′]_ ) = 0,


- _t_




- _d_ /2




 - 1
_×_



_R_




 -  - _t_ 3
_×_ 1 + _O_



_N_



_M_




- - _t_ 2
+ _O_ ~~_√_~~



~~_√_~~



��
,


��
,



_**Proof.**_ Letting ( _X_ 1, _Y_ 1), . . ., ( _Xℓ_, _Yℓ_ ) be the bipartite components of _T ∪_ _T_ _[′]_, Fact 1 gives us that:



# _{ S ∈FM_, _R_, _N_ : _T ∪_ _T_ _[′]_ _⊂_ _S }_



_M_, _R_, _N_ : _T ∪_ _T_ _⊂_ _S }_  - _M_

= ~~_√_~~
# _{ S ∈FM_, _R_, _N }_



_N_



_N_




- _uT∪T′_ - - _t_ 3
_R_ _[ℓ]_ 1 + _O_

_M_




- - _t_ 2
+ _O_ ~~_√_~~



~~_√_~~



��
. (S54)



The case _d_ ( _T_, _T_ _[′]_ ) = 0 is trivial since it implies _T_ = _T_ _[′]_, meaning the number of unique half-strings is _uT∪T′_ = 2 _t_ and
the number of bipartite components is _ℓ_ = _t_ .


For the more generic case _d_ ( _T_, _T_ _[′]_ ) _≡_ _d ≥_ 1, let _k_ = _ℓ_ + _d −_ _t_ where _ℓ_ once again denotes the number of bipartite
components. Note that 1 _≤_ _k ≤_ 2 _d_ . Using Fact 2 we have that:

1 _≤_ _k ≤_ _[d]_ 2 _⇒_ _uT∪T′ ≥_ 2 _t_ (S55)

_d_
_⇒_ _uT∪T′ ≥_ 2 _t_ + [4] _[k][ −]_ [2] _[d]_ . (S56)
2 _[≤]_ _[k][ ≤]_ [2] _[d]_ 3


This implies that:




[2] _R_  - _t_  - _M_ [2/3] _R_ [1/2]

_N_ _N_ [1/3]




[2/3] _R_ [1/2] �2 _k_ - _M_ [2/3] _R_

_N_ [1/3] _N_ [1/3]



_N_ [2] _R_ - _t_ _R_ _[−][d]_ [/2] if 1 _≤_ _k ≤_ _[d]_ 2












- _M_ [2] _R_



_N_ _N_ 2

- _M_ [2] _R_ - _t_ - _M_ [2/3] _R_ [1/2] �2 _k_ - _M_ [2/3] _R_ - _−d_ - _M_ [2] _R_ - _t_ _[−][d]_ [/2] _[d]_ _M_ [2] _R_ [3/2]



_N_ [2] _R_ - _t_ _R_ _[−][d]_ [+] _[k]_ _≤_ - _MN_ [2] _R_




- _M_
~~_√_~~

_N_




- _uT∪T′_
_R_ _[ℓ]_ _≤_




[2/3] _R_  - _−d_ _≤_  - _M_ [2] _R_

_N_ [1/3] _N_



_N_ [2] _R_ - _t_ _R_ _[−][d]_ [/2] if _[d]_ 2




_[d]_ _M_ [2] _R_ [3/2]

2 _[≤]_ _[k][ ≤]_ [2] _[d]_ [ and] _N_



_N_ _<_ 1.



(S57)



Therefore, as long as _[M]_ [2] _N_ _[R]_ [3/2] _<_ 1, we have that in all cases we have the upper bound - ~~_√_~~ _MN_ - _uT∪T′ Rℓ_ _≤_ - _MN_ [2] _R_ - _t_ _R_ _[−][d]_ [/2],

which leads to the conclusion.



_N_ _[R]_ [3/2] _<_ 1, we have that in all cases we have the upper bound - ~~_√_~~ _M_



Therefore, as long as _[M]_ [2] _[R]_ [3/2]



_N_




- _uT∪T′ Rℓ_ _≤_ - _M_ [2] _R_



So, from Lemma S7, we obtain the following fact:


**Fact 4.** Assume _[M]_ [2] _[R]_ [3/2]



_N_ _<_ 1. Then:

              - _t_ 3
**E** _|S⟩⟨S|_ _[⊗][t]_ _−_ **E** _|ϕ⟩⟨ϕ|_ _[⊗][t]_ _≤_ _O_
����� _S∼FM_, _R_, _N_ _ϕ∼_ Haar( **C** _[N]_ ) ����� _M_
1




- - _t_ 2
+ _O_ ~~_√_~~




- - _t_
+ _O_ ~~_√_~~

_R_




- - _t_
+ _O_ ~~_√_~~



19


. (S58)



_N_



_M_



~~_√_~~



Similarly, from Lemma S6, we obtain the following.



**Fact 5.** Assume _[M]_ [2] _N_ _[R]_ [3/2] _<_ 1. Then:


**E**
����� _S∼FM_, _R_, _N_, _f ∼{_ 0,1 _}_ _[N]_



�� _⊗t_   - _t_ 3
��� _ψ_ _f_, _S_ _ψ_ _f_, _S_ ��� _−_ _ϕ∼_ Haar **E** ( **C** _[N]_ ) _|ϕ⟩⟨ϕ|_ _[⊗][t]_ ����� _≤_ _O_ _M_
1




- - _t_ 2
+ _O_ ~~_√_~~



~~_√_~~



_N_




. (S59)



Finally, we arrive at Eq. (S35) and Eq. (S36) from Fact 4 and Fact 5, respectively. This completes the proof of Lemma
S8.


**S5.** **LARGE-BRICK PHASE STATES**


In this section, we formally prove our main results with respect to the properties of large-brick phase states. We
begin with the proof of Theorem 2, which claims that these states are close to Haar random states.


**A.** **Proof of Theorem 2**


Define the “birthday-subspace” (i.e. the collision-free subspace) in the symmetric subspace Sym _[t]_ [ �] **C** _[N]_ [�] as:




   _j∈_ [2 _m_ ] _∈_ _{_ 0, 1 _}_ _[b]_ [�][2] _[mt]_ all distinct
_k∈_ [ _t_ ]



, (S60)







Σbday =




~~_√_~~ 1 _Rσ_ ��� _x_ 1(1) _· · · x_ 2 [(][1] _m_ [)] _· · · x_ 1 [(] _[t]_ [)] _[· · ·][ x]_ 2 [(] _[t]_ _m_ [)] - : - _x_ [(] _j_ _[k]_ [)] ## t ! σ [∑] ∈ S t




1
~~_√_~~



where the symmetric group acts by permuting the _t_ sites, as usual:


(1)              - ( _σ−_ 1(1))              _Rσ_ ��� _x_ 1 _· · · x_ 2 [(][1] _m_ [)] _· · · x_ 1 [(] _[t]_ [)] _[· · ·][ x]_ 2 [(] _[t]_ _m_ [)] = ��� _x_ 1 _· · · x_ 2 [(] _[σ]_ _m_ _[−]_ [1][(][1][))] _· · · x_ 1 [(] _[σ][−]_ [1][(] _[t]_ [))] _· · · x_ 2 [(] _[σ]_ _m_ _[−]_ [1][(] _[t]_ [))] . (S61)


Note that the birthday subspace has dimension:

dim Σbday = [2] _[b]_ [(][2] _[b][ −]_ [1][)] _[ · · ·]_ [ (] _t_ ! [2] _[b][ −]_ [2] _[mt]_ [ +][ 1][)]



= [2] _[nt]_

_t_ !




- - _m_ 2 _t_ 2
1 _−_ _O_

2 _[b]_



��




        - _n_ 2 _t_ 2
= dim Sym _[t]_ [ �] **C** _[N]_ [��] 1 _−_ _O_

2 _[b]_



��
,



since 2 _bm_ = _n_ and _m < n_, and using the fact that dim Sym _[t]_ [ �] **C** _[N]_ [�] = ( [2] _[n]_ [+] _t_ _[t][−]_ [1] ) = [2] _t_ _[nt]_ ! �1 + _O_ - 2 _t_ [2] ~~_[n]_~~ ��.

Let Πbday be the projector on the above birthday subspace Σbday. Let the two density matrices of interest be:


_ρ_ Haar [(] _[t]_ [)] [=] **E** (S62)
_|ϕ⟩∼_ Haar( **C** _[N]_ ) _[|][ϕ][⟩⟨][ϕ][|][⊗][t]_



_⊗t_
. (S63)
���



_ρ_ LBPS [(] _[t]_ [)] [=] **E**
_f_ 1: _m_, _g_ 1: _m_



��
��� _ψ_ _f_ 1: _m_, _g_ 1: _m_ _ψ_ _f_ 1: _m_, _g_ 1: _m_



By their manifest symmetry, both density matrices belong to the symmetric subspace Sym _[t]_ [ �] **C** _[N]_ [�] . Moreover,


ΠSym _t_ ( **C** _N_ )
_ρ_ Haar [(] _[t]_ [)] [=] dim Sym _[t]_ ( **C** _[N]_ ) . (S64)


20


We will show that the two density matrices are close on the birthday subspace. Begin by evaluating the large-block
phase-state ensemble explicitly:



_ρ_ LBPS [(] _[t]_ [)] [=] [1]


## ∑

_N_ _[t]_ - _x_ [(] _j_ _[k]_ [)]



��
_f_ 1: _m_ **E**, _g_ 1: _m_ ( _−_ 1) _[φ]_ [(] _[x]_ [,] _[y]_ [)][ ��] - _x_ 1 [(][1][)] _· · · x_ 2 [(][1] _m_ [)] _· · · x_ 1 [(] _[t]_ [)] _[· · ·][ x]_ 2 [(] _[t]_ _m_ [)] _y_ 1 [(][1][)] _· · · y_ 2 [(][1] _m_ [)] _· · · y_ 1 [(] _[t]_ [)] _[· · ·][ y]_ 2 [(] _[t]_ _m_ [)] ���,


(S65)




- _y_ [(] _j_ _[k]_ [)]



2 _mt_
_j∈_ [2 _m_ ], _k∈_ [ _t_ ] _[∈]_ [(] _[{]_ [0,1] _[}][b]_ [)]

2 _mt_
_j∈_ [2 _m_ ], _k∈_ [ _t_ ] _[∈]_ [(] _[{]_ [0,1] _[}][b]_ [)]



where the phase function is:


_φ_ ( _x_, _y_ ) = ∑
_j∈_ [ _m_ ]
_k∈_ [ _t_ ]



_fj_ ( _x_ 2 [(] _[k]_ _j−_ [)] 1 [.] _[x]_ 2 [(] _[k]_ _j_ [)][) +] _[ g][j]_ [(] _[x]_ 2 [(] _[k]_ _j−_ [)] 2 [.] _[x]_ 2 [(] _[k]_ _j−_ [)] 1 [) +] _[ f][j]_ [(] _[y]_ 2 [(] _[k]_ _j−_ [)] 1 [.] _[y]_ 2 [(] _[k]_ _j_ [)][) +] _[ g][j]_ [(] _[y]_ 2 [(] _[k]_ _j−_ [)] 2 [.] _[y]_ 2 [(] _[k]_ _j−_ [)] 1 [)][ .] (S66)



Restricting from _ρ_ LBPS [(] _[t]_ [)] [to the birthday subspace][ Π][bday] _[ρ]_ LBPS [(] _[t]_ [)] [Π][bday][ makes it easier to evaluate the phase averages]
under random functions _fj_ and _gj_ . Notice that the average over _fj_ is zero unless the same argument of _fj_ appears

an even number of times in the sum _φ_ ( _x_, _y_ ). Since on the birthday subspace any sub-string _x_ [(] _j_ _[k]_ [)] of length _b_ can

only occur once, so the above average over _f_ 1, . . ., _fm_ is one if and only if for every pair _x_ 2 [(] _[a]_ _j−_ [)] 1 [.] _[x]_ 2 [(] _[a]_ _j_ [)] [there is a single]

equal pair _y_ 2 [(] _[b]_ _j−_ [)] 1 [.] _[y]_ 2 [(] _[b]_ _j_ [)] [(matchings with more than two equivalent terms are also forbidden by the unique sub-string]

condition on Σbday). Similarly, averaging over the functions _g_ 1, . . ., _gm_ is one if and only if for any pair _x_ 2 [(] _[a]_ _j−_ [)] 2 [.] _[x]_ 2 [(] _[a]_ _j−_ [)] 1
there exists a single equal pair _y_ 2 [(] _[b]_ _j−_ [)] 2 [.] _[y]_ 2 [(] _[b]_ _j−_ [)] 1 [.]

Combining the two constraints only leaves configurations such that for each _n_ -bit site _x_ 1 [(] _[a]_ [)] _· · · x_ 2 [(] _[a]_ _m_ [)] [there exists a]

single identical _n_ -bit site _y_ 1 [(] _[b]_ [)] _· · · y_ 2 [(] _[b]_ _m_ [)][. In other words, only] _[ t]_ [-permutations survive:]


## Πbday ρ LBPS [(] [t] [)] [Π][bday][ =] [1] ∑

_N_ _[t]_
( _x_ [(][1][)],..., _x_ [(] _[t]_ [)] ) _∈_ Σbday
_σ∈_ **S** _t_



_x_ (1), . . ., _x_ ( _t_ )�� _y_ [(] _[σ]_ [(][1][))], . . ., _y_ [(] _[σ]_ [(] _[t]_ [))][��] (S67)
��� 

## = [t] [!] ∑ | x ⟩⟨ x | (S68)

_N_ _[t]_ **x** _∈_ Σbday


                  - _t_ [2]                   1 + _O_ 2 ~~_[n]_~~
= Πbday . (S69)

( [2] _[n]_ [+] _[t][−]_ [1] )
_t_


Using (S64) and (S62), we have that the two density matrices are close on the birthday subspace:



���Πbday _ρ_ LBPS( _t_ ) [Π][bday] _[ −]_ [Π][bday] _[ρ]_ Haar [(] _[t]_ [)] [Π][bday] ���1 [=] _[ O]_ - _t_ 22 _n_ _[b]_ 2




. (S70)



Using Lemma 1 from [19], we can lift this to the full symmetric subspace to get the desired result:



( _t_ )   - _t_ 2 _n_ 2
��� _ρ_ LBPS _[−]_ _[ρ]_ Haar [(] _[t]_ [)] ���1 [=] _[ O]_ 2 _[b]_




. (S71)



Pseudorandomness follows from replacing the random functions with quantum-secure pseudorandom functions
(which admit efficient circuits). The circuit architecture immediately implies a bound of _O_ ( _b_ ) for the entanglement
entropy across geometric cuts, implying that this ensemble is pseudoentangled along a 1D geometry.


**B.** **Large-brick phase states form projected designs across almost all cuts**


Here we prove that for the large-brick phase state, by measuring a random biparition of qubits results in a projected ensemble that is pseudoentangled. That is, these states lead to a pseudoentangled projected design when a
measurement is made across almost all cuts.


21


Given a _n_ -bit string _x ∈{_ 0, 1 _}_ _[n]_, partition it into substrings corresponding to the bricks of the two-layer brickwork
circuit preparing the phase states: _x_ = _x_ 1. _x_ 2. _· · ·_ . _x_ 2 _m_, where _x_ 1, _· · ·_, _x_ 2 _m ∈{_ 0, 1 _}_ _[b]_ . Then, any cut further partitions
these bricks into segments which belong to one side or the other of the cut: _xj_ = _aj_ . _bj_ where _aj ∈{_ 0, 1 _}_ _[k][j]_ and
_bj ∈{_ 0, 1 _}_ _[b][−][k][j]_, for _j ∈_ [2 _m_ ] and some _k_ 1, . . ., _k_ 2 _m ∈{_ 0, . . ., _b}_ .
We can treat a random cut (i.e. bipartition) of _n_ qubits as _n_ i.i.d. draws from a Ber(1/2) distribution, with the _j_ ’th
draw determining whether qubit _j_ is on one side or the other of the cut. Then each _kj_ follows the standard binomial
statistics, in particular with a tail bound:




       **P** [ _kj ≤_ _k_ ] _≤_ exp _−_ [(] _[b][ −]_ [2] _[k]_ [)][2]

4 _b_




. (S72)



A similar tail applies for the upper tail of this quantity. Then, by a union bound over these 2 _m_ events, we know that
the typical cut segmentation cannot be too uneven on even a single brick:




 -  - _b_
**P** _∃j ∈_ [2 _m_ ] : _kj_ / _∈_



4



_b_ [3] _[b]_

4 [,] 4



��
_≤_ 4 _ne_ _[−][b]_ [/16] . (S73)



This is negligible in _n_ if _b ≥_ Ω(log [2] _n_ ), as assumed in our construction.
To study the projected ensemble properties across a random cut of this kind, assume we are measuring in the
computational basis on the “b” side of the cut with measurement outcome _b_ = ( _b_ 1, . . ., _b_ 2 _m_ ) _∈{_ 0, 1 _}_ _[n][−]_ [∑] _[j][∈]_ [[][2] _[m]_ []] _[ k][j]_ . All
outcomes occur with equal probability 2 _[−][n]_ [+][∑] _[j][∈]_ [[][2] _[m]_ []] _[ k][j]_ . The corresponding post-measurement state on the “a” side of
the cut is:

_a|b_       - 1
## ��� ψ f 1: m, g 1: m = [∑] [j][∈] [[] [m] []] [ k][j] [/2] ∑ ( − 1) [∑] [j][∈] [[] [m] []] [ f][j] [(] [a] [2] [j][−] [1][.] [b] [2] [j][−] [1][.] [a] [2] [j] [.] [b] [2] [j] [)+] [g][j] [(] [a] [2] [j][−] [2][.] [b] [2] [j][−] [2][.] [a] [2] [j][−] [1][.] [b] [2] [j][−] [1][)] |a 1, · · ·, a 2 m⟩ . (S74)




- 1
=


## ∑

2 [∑] _[j][∈]_ [[][2] _[m]_ []] _[ k][j]_ [/2] _a_ 1 _∈{_ 0,1 _}_ _[k]_ [1]
...
_a_ 2 _m∈{_ 0,1 _}_ _[k]_ [2] _[m]_



( _−_ 1) [∑] _[j][∈]_ [[] _[m]_ []] _[ f][j]_ [(] _[a]_ [2] _[j][−]_ [1][.] _[b]_ [2] _[j][−]_ [1][.] _[a]_ [2] _[j]_ [.] _[b]_ [2] _[j]_ [)+] _[g][j]_ [(] _[a]_ [2] _[j][−]_ [2][.] _[b]_ [2] _[j][−]_ [2][.] _[a]_ [2] _[j][−]_ [1][.] _[b]_ [2] _[j][−]_ [1][)] _|a_ 1, _· · ·_, _a_ 2 _m⟩_ . (S74)



Notice that we can write this state as a two-layer brickwork phase-state on the “a” subsystem:


       ## ���� ψaf �1: [(] [b] m [)] [,] [g] [�] 1: [(] [b] m [)] = 2 [∑] [j][∈] [[][2] 1 [m] []] [ k][j] [/2] ∑ [k] ( − 1) [∑] [j][∈] [[] [m] []][ �] [f] [ (] j [b] [)] ( a 2 j− 1. a 2 j )+ g � [(] j [b] [)] ( a 2 j− 2. a 2 j− 1) |a 1, · · ·




- 1
=


## ∑

2 [∑] _[j][∈]_ [[][2] _[m]_ []] _[ k][j]_ [/2] _a_ 1 _∈{_ 0,1 _}_ _[k]_ [1]
...
_a_ 2 _m∈{_ 0,1 _}_ _[k]_ [2] _[m]_



( _−_ 1) [∑] _[j][∈]_ [[] _[m]_ []][ �] _[f]_ [ (] _j_ _[b]_ [)] ( _a_ 2 _j−_ 1. _a_ 2 _j_ )+ _g_ - [(] _j_ _[b]_ [)] ( _a_ 2 _j−_ 2. _a_ 2 _j−_ 1) _|a_ 1, _· · ·_, _a_ 2 _m⟩_, (S75)



where we defined the _b_ -outcome-conditioned “post-measurement functions” _f_ [�] _j_ [(] _[b]_ [)] ( _a_ 2 _j−_ 1. _a_ 2 _j_ ) _≡_ _fj_ ( _a_ 2 _j−_ 1. _b_ 2 _j−_ 1. _a_ 2 _j_ . _b_ 2 _j_ )

and similarly for � _g_ [(] _j_ _[b]_ [)] . This resulting state is a “large-brick” phase-state if the bricks are large enough, e.g.,

_k_ 1, . . ., _k_ 2 _m ≥_ Ω(log [2] _n_ ), which holds with high probability by the concentration result of (S73).


**S6.** **TOWARDS PSEUDORANDOMNESS BEYOND BQP**


In this section, we want to motivate pseudorandomness for distinguishers beyond BQP. We will consider two
different ensembles of states _B_ 1 and _B_ 2. The first ensemble _B_ 1 is an ensemble of pseudorandom phase states, given
by


1
## √ ∑ ( − 1) [f] [ (] [x] [)] |x⟩,

2 _[n]_ _x∈{_ 0,1 _}_ _[n]_


where _f_ is a pseudorandom function. The second ensemble _B_ 2 is an ensemble of large brick phase states, as in Figure
1, where the phases are picked pseudorandomly. The details of these pseudorandom functions will be explained
later.
Now, let _D_ be a polynomial time quantum distinguisher, given _t_ copies of a state _|ψ⟩_ —which is promised to be
either from _B_ 1 (or _B_ 2) or a Haar random state—with the goal of _D_ being to distinguish which is the case. _D_ has
access to a oracle _QP_, which it can query only once. _D_ interfaces with the oracle as follows.


22


  - The input is the state _|ψ⟩_ and a classical string describing


_C_ =               - _U_ 1, _M_ 1, . . ., _UP_, _MP_ �,


where _Ui_ is a unitary operator on _n_ qubits, and _Mi_ is a _collapsing_ measurement operator on _s_ qubits with
0 _≤_ _s ≤_ _n_ .
Define the intermediate states

_|ϕ_ 0 _⟩_ = _|ψ⟩_, _|ϕi⟩_ = _∥MMiiUUii | |ϕϕii−−_ 11 _⟩∥⟩_ [.]

  - The oracle _QP_, on input _C_, outputs the sequence  - _|ϕi⟩_  - _iP_ =0 [.]

The setting just described is, more or less, captured by the class PDQP, which is one of the classes ”just above“ BQP,
see for e.g. [34, 35].
To instantiate the states in _B_ 1 and _B_ 2 efficiently, we conjecture the existence of PDQP-secure pseudorandom functions. We leave open whether such functions exist. Note that PDQP contains SZK where a variety of lattice problems,
otherwise hard for BQP, become easy [42]. Hence, certain constructions based on the hardness of lattice problems,
like Learning With Errors (LWE), may not be good candidates. However, other hardness conjectures, like Learning
Parity with Noise (LPN) [43] can still potentially work, although a rigorous security proof is open and we leave it for
future work.
Now, let us restrict the power of the distinguisher _D_ and that of the oracle _QP_ . Firstly, let us take each _Ui_ to be
identity and let us take each _Mi_ to be a (randomly sampled) standard basis projector on any cut.

**Lemma S12** (Pseudorandomness beyond BQP) **.** _Consider an ensemble B_ 1 _of pseudorandom phase states, given by_


1
## √ ∑ ( − 1) [f] [ (] [x] [)] |x⟩,

2 _[n]_ _x∈{_ 0,1 _}_ _[n]_


_where f is a PDQP-secure pseudorandom function. Then, for every distinguisher D, which can query an oracle QP of the form_
_just described, we have that with high probability over the choice of the input state,_

Pr [ _D_ ( _|ψ⟩_ _[⊗][t]_ ) = 1] _−_ Pr = negl( _n_ ), (S76)
���� _ψ∼B_ 1 _ψ∼_ Haar [[] _[D]_ [(] _[|][ψ][⟩][⊗][t]_ [) =][ 1][]] ����


_for all t_ = poly( _n_ ) _._


_**Proof.**_ Random phase states are statistically pseudorandom, with exponentially close trace distance to a Haar random state; see for e.g. [18, 33]. By a similar calculation to Section S5 B, it is easy to see that across any cut, the
projected ensemble corresponding to a pseudorandom phase state is _also_ a pseudorandom phase state of smaller
size. Hence, in the output sequence produced by the oracle _QP_,

                    - _|ϕi⟩_                     - _iP_ =0 [,]

every _|ϕi⟩_ is a pseudorandom state with high probability. The proof now follows from a series of hybrid arguments.


Now, let us take each _Ui_ to be identity, _M_ 1 to be a (randomly sampled) standard basis projector on a _randomly_
_chosen_ cut, and all other collapsing measurements to be empty.


**Lemma S13** (Pseudoentanglement beyond BQP) **.** _Consider an ensemble B of large-brick phase states as described in Figure_
_1, which have entanglement scaling as ∼_ log [2] _n across geometric cuts. Then, for every distinguisher D, which can query an_
_oracle QP of the form just described, we have that with high probability over the choice of the input state,_

Pr [ _D_ ( _|ψ⟩_ _[⊗][t]_ ) = 1] _−_ Pr = negl( _n_ ), (S77)
���� _ψ∼B_ 2 _ψ∼_ Haar [[] _[D]_ [(] _[|][ψ][⟩][⊗][t]_ [) =][ 1][]] ����


_for all t_ = poly( _n_ ) _._

_**Proof.**_ Since all but the first collapsing measurement is empty, the output sequence of _QP_ is now polynomially many
copies of a state from a projected ensemble which is pseudorandom with high probability, according to Theorem 2
and the argument in Section S5 B. The proof then follows from standard hybrid arguments.


